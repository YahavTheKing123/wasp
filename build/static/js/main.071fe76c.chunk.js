(this.webpackJsonpwasp=this.webpackJsonpwasp||[]).push([[0],[,,,function(e,t,a){"use strict";t.a={PAUSE_VIDEO:"PAUSE_VIDEO",RESUME_VIDEO:"RESUME_VIDEO",TOGGLE_RECORDING_STATE:"TOGGLE_RECORDING_STATE",LOACTE_START:"LOACTE_START",LOACTE_SUCCESS:"LOACTE_SUCCESS",LOACTE_FAILED:"LOACTE_FAILED",RESET_START:"RESET_START",RESET_SUCCESS:"RESET_SUCCESS",RESET_FAILED:"RESET_FAILED",TAKE_OFF_START:"TAKE_OFF_START",TAKE_OFF_SUCCESS:"TAKE_OFF_SUCCESS",TAKE_OFF_FAILED:"TAKE_OFF_FAILED",LAND_START:"LAND_START",LAND_SUCCESS:"LAND_SUCCESS",LAND_FAILED:"LAND_FAILED",SET_EXPOSURE_START:"SET_EXPOSURE_START",SET_EXPOSURE_SUCCESS:"SET_EXPOSURE_SUCCESS",SET_EXPOSURE_FAILED:"SET_EXPOSURE_FAILED",TOGGLE_ARM_STATE:"TOGGLE_ARM_STATE",START_INDOOR_EXPLORATION:"START_INDOOR_EXPLORATION",SET_INDOOR_EXPLORATION_FLAG:"SET_INDOOR_EXPLORATION_FLAG",REMOVE_INDOOR_EXPLORATION_FLAG:"REMOVE_INDOOR_EXPLORATION_FLAG",SET_MISSION_STATE:"SET_MISSION_STATE",GO_TO_LOCATION_START:"GO_TO_LOCATION_START",GO_TO_LOCATION_SUCCESS:"GO_TO_LOCATION_SUCCESS",GO_TO_LOCATION_FAILED:"GO_TO_LOCATION_FAILED",POINT_ON_VIDEO_IMAGE_START:"POINT_ON_VIDEO_IMAGE_START",POINT_ON_VIDEO_IMAGE_SUCCESS:"POINT_ON_VIDEO_IMAGE_SUCCESS",POINT_ON_VIDEO_IMAGE_FAILED:"POINT_ON_VIDEO_IMAGE_FAILED",ROSS_WEBSOCKET_CONNECTION_SUCCESS:"ROSS_WEBSOCKET_CONNECTION_SUCCESS",ROSS_WEBSOCKET_CONNECTION_FAILED:"ROSS_WEBSOCKET_CONNECTION_FAILED",ROSS_WEBSOCKET_CONNECTION_CLOSED:"ROSS_WEBSOCKET_CONNECTION_CLOSED",ROSS_WEBSOCKET_CONNECTION_START:"ROSS_WEBSOCKET_CONNECTION_START",SHOW_GLOBAL_MESSAGE:"SHOW_GLOBAL_MESSAGE",REMOVE_GLOBAL_MESSAGE:"REMOVE_GLOBAL_MESSAGE",SHOW_CONTEXT_MENU:"SHOW_CONTEXT_MENU",CLOSE_CONTEXT_MENU:"CLOSE_CONTEXT_MENU",SHOW_POPUP:"SHOW_POPUP",HIDE_POPUP:"HIDE_POPUP",IMAGE_SENT_TO_DRONE:"IMAGE_SENT_TO_DRONE",TOGGLE_MISSION_PLANNER_SCREEN:"TOGGLE_MISSION_PLANNER_SCREEN",SELECT_DRONE:"SELECT_DRONE",TOGGLE_MAP_AND_OUTPUT_TABS:"TOGGLE_MAP_AND_OUTPUT_TABS",SET_BATTERY_LEVEL:"SET_BATTERY_LEVEL",SET_AIR_SPEED:"SET_AIR_SPEED",SET_MAPCORE_SDK_LOADED_FLAG:"SET_MAPCORE_SDK_LOADED_FLAG",SET_MAP_TO_SHOW:"SET_MAP_TO_SHOW",GET_DRONE_POSITION_OFFSET:"GET_DRONE_POSITION_OFFSET",GET_ENEMY_POSITION:"GET_ENEMY_POSITION",SAVE_ORIGIN_COORDINATE:"SAVE_ORIGIN_COORDINATE",DELETE_DRONE_POSITION:"DELETE_DRONE_POSITION",TOGGLE_POINT_SELECTION_MODE:"TOGGLE_POINT_SELECTION_MODE",SELECT_POINT_FROM_MAP:"SELECT_POINT_FROM_MAP",UPDATE_SKELETON_RANGE:"UPDATE_SKELETON_RANGE",SET_WEAPON_DETECTION:"SET_WEAPON_DETECTION",ADD_NEW_MISSION_PLAN_STAGE:"ADD_NEW_MISSION_PLAN_STAGE",DELETE_MISSION_PLAN_STAGE:"DELETE_MISSION_PLAN_STAGE",EDIT_MISSION_PLAN_STAGE:"EDIT_MISSION_PLAN_STAGE",MOVE_UP_MISSION_PLAN_STAGE:"MOVE_UP_MISSION_PLAN_STAGE",MOVE_DOWN_MISSION_PLAN_STAGE:"MOVE_DOWN_MISSION_PLAN_STAGE",SAVE_MISSION_PLAN:"SAVE_MISSION_PLAN",REMOVE_DRAFT_MISSION_PLAN:"REMOVE_DRAFT_MISSION_PLAN",REMOVE_SAVED_MISSION_PLAN:"REMOVE_SAVED_MISSION_PLAN",TOGGLE_MISSION_PLAN_VIEWER_STATE:"TOGGLE_MISSION_PLAN_VIEWER_STATE",LOAD_DEFAULT_PLAN:"LOAD_DEFAULT_PLAN"}},,,,function(e,t,a){e.exports={App:"App_App__2MYUV",AppHeader:"App_AppHeader__1xvWo",LogoWrapper:"App_LogoWrapper__3g5zo",ActionsBar:"App_ActionsBar__1-3sb",ActionButtons:"App_ActionButtons__2XLp0",HeaderElementWrapper:"App_HeaderElementWrapper__3Ln3v",ExportBtn:"App_ExportBtn__1_50o",Disabled:"App_Disabled__167iO",FileInput:"App_FileInput__yXj1g",RightHeader:"App_RightHeader__lBHCr",HeaderLeftWrapper:"App_HeaderLeftWrapper__2DRfD",HeaderItem:"App_HeaderItem__2k6ih",DroneSelectItem:"App_DroneSelectItem__2Km_9",Icon:"App_Icon__1ISa_",GpsIcon:"App_GpsIcon__344rr",PositionIcon:"App_PositionIcon__3uphK",CompassIcon:"App_CompassIcon__3YSr0",WifiIcon:"App_WifiIcon__1vv25",BatteryIconHalf:"App_BatteryIconHalf__7Gb_B",BatteryIconEmpty:"App_BatteryIconEmpty__bq-Hv",BatteryIconFull:"App_BatteryIconFull__3sguY",EmptyBatteryColor:"App_EmptyBatteryColor__3cGb3",DroneIcon:"App_DroneIcon__jWTwM",BatteryValue:"App_BatteryValue__OgmLs",LongLatWrapper:"App_LongLatWrapper__DPdKR",lonLatLabel:"App_lonLatLabel__3OOut",lonLatValue:"App_lonLatValue__1QMuS",MissionWrapper:"App_MissionWrapper__29IN0",MissionValue:"App_MissionValue__2NPLd",MissionValueWrapper:"App_MissionValueWrapper__3y4v5",MenuBtn:"App_MenuBtn__3atbM",MenuIcon:"App_MenuIcon__20KMP",MissionPlannerIcon:"App_MissionPlannerIcon__1g82w",MissionPlannerOverlay:"App_MissionPlannerOverlay__5IQxP",MissionPlannerHidden:"App_MissionPlannerHidden__1ZjHN",VersionText:"App_VersionText__9gdAB",DroneSelectionWrapper:"App_DroneSelectionWrapper__2JRdL"}},,,function(e,t,a){"use strict";a.d(t,"b",(function(){return n}));var n={success:"success",info:"info",warn:"warn",error:"error"};t.a={urls:{getCapabilities:"/map/opr?service=wmts&request=GetCapabilities",configuration:"configuration.json",loadMission:"defaultMission.json",videoStream:"/stream?topic=/d415/color/image_raw",videoSnapshot:"/snapshot?topic=/d415/color/image_raw",skeletonStream:"/stream?topic=/SkeletonDetector/Image",skeletonSnapshot:"/snapshot?topic=/SkeletonDetector/Image",mapImageStream:"/stream?topic=/OccupancyGridManager/Image",mapImageSnapshot:"/snapshot?topic=/OccupancyGridManager/Image",windowDetectionStream:"/stream?topic=/seeker/detectionImage",windowDetectionSnapshot:"/snapshot?topic=/seeker/detectionImage"},MIN_DRONE_DISTANCE_MOVE:.25,MIN_ENEMY_RADIUS:1,EXPOSURE_MAX_LEVEL:100,COORDINATE_DECIMALS_PRECISION:2,DEFAULT_MISSION_POINT_HEIGHT:0}},,,function(e,t,a){e.exports={Wrapper:"ActionButtons_Wrapper__1mPEv",Hidden:"ActionButtons_Hidden__1l-WC",Button:"ActionButtons_Button__2CLMN",ButtonLabel:"ActionButtons_ButtonLabel__Q5BU4",Clicked:"ActionButtons_Clicked__3G1AH",Icon:"ActionButtons_Icon__1I2FB",IconWithArrow:"ActionButtons_IconWithArrow__k0GSx",LocateIcon:"ActionButtons_LocateIcon__3VFcz",PauseIcon:"ActionButtons_PauseIcon__f4FlW",ResetIcon:"ActionButtons_ResetIcon__pS4kF",TakeoffIcon:"ActionButtons_TakeoffIcon__3l9wl",SetLocationIcon:"ActionButtons_SetLocationIcon__2DguE",PlayIcon:"ActionButtons_PlayIcon__1HkND",IndoorExploration:"ActionButtons_IndoorExploration__1lRVM",RunPlanIcon:"ActionButtons_RunPlanIcon__3X5Eh",ArrowDownIcon:"ActionButtons_ArrowDownIcon__2d74Y",ArrowUpIcon:"ActionButtons_ArrowUpIcon__2yzuN"}},,function(e,t,a){e.exports={Wrapper:"MissionPlanner_Wrapper__2_M8J",Center:"MissionPlanner_Center__3m1mW",StartNewBtn:"MissionPlanner_StartNewBtn__2O_gJ",SideBar:"MissionPlanner_SideBar__1l1jJ",SidebarLabel:"MissionPlanner_SidebarLabel__1Ya5v",SideBarButtons:"MissionPlanner_SideBarButtons__3xUIL",Header:"MissionPlanner_Header__3ljFj",HeaderBtnWrapper:"MissionPlanner_HeaderBtnWrapper__1SQ0a",HeaderBtn:"MissionPlanner_HeaderBtn__2Bz_k",HeaderIcon:"MissionPlanner_HeaderIcon__B8CMX",HeaderTextWrapper:"MissionPlanner_HeaderTextWrapper__2G1zu",HeaderTextState:"MissionPlanner_HeaderTextState__2d6zQ",DraftIcon:"MissionPlanner_DraftIcon__3JxwX",SavedPlanIcon:"MissionPlanner_SavedPlanIcon__mh3jB",SideBarBtn:"MissionPlanner_SideBarBtn__2Mp1E",EmptyPlanStagesMessage:"MissionPlanner_EmptyPlanStagesMessage__2jUL9",ClosePlanner:"MissionPlanner_ClosePlanner__2LANr",Import:"MissionPlanner_Import__3Ar6k",Export:"MissionPlanner_Export__2wj3r",Save:"MissionPlanner_Save__3CtRk",Remove:"MissionPlanner_Remove__dZ6UF",ClearStages:"MissionPlanner_ClearStages__2T2yN"}},function(e,t,a){e.exports={Wrapper:"OutputTabs_Wrapper__3h3zv",Enlarge:"OutputTabs_Enlarge__38kvj",NoOutput:"OutputTabs_NoOutput__18v6J",ErrorIcon:"OutputTabs_ErrorIcon__1TffL",ErrorMessage:"OutputTabs_ErrorMessage__2FCCV",Tabs:"OutputTabs_Tabs__1CsMR",OutputImage:"OutputTabs_OutputImage__bD7e6",Point:"OutputTabs_Point__1oY6q",tabslidernav:"OutputTabs_tabslidernav__2xxeu",tabslidertabs:"OutputTabs_tabslidertabs__2cIxv",TabSelected:"OutputTabs_TabSelected__1GoOC",tabslidertrigger:"OutputTabs_tabslidertrigger__2-HnL",SkeletonTab:"OutputTabs_SkeletonTab__VTB97",WeaponDetected:"OutputTabs_WeaponDetected__aw1m9",borderAnimation:"OutputTabs_borderAnimation__11epw",WindowTab:"OutputTabs_WindowTab__yrlih",VideoImage:"OutputTabs_VideoImage__2Czru",Occupancy:"OutputTabs_Occupancy__2V6Wt",AlertIcon:"OutputTabs_AlertIcon__18WFj",SkeletonRange:"OutputTabs_SkeletonRange__1OcDe",alertAnimation:"OutputTabs_alertAnimation__26y3A"}},,function(e,t,a){"use strict";var n={};a.r(n),a.d(n,"subscribeToDroneData",(function(){return m}));var o={};a.r(o),a.d(o,"showGlobalMessage",(function(){return f})),a.d(o,"toggleIsArmed",(function(){return E})),a.d(o,"subscribeToBatteryLevel",(function(){return C})),a.d(o,"subscribeToAirSpeed",(function(){return v}));var r={};a.r(r),a.d(r,"locate",(function(){return w})),a.d(r,"pointVideoImage",(function(){return T})),a.d(r,"reset",(function(){return D})),a.d(r,"takeoff",(function(){return y})),a.d(r,"land",(function(){return I})),a.d(r,"startIndoorExploration",(function(){return P})),a.d(r,"goToLocation",(function(){return j})),a.d(r,"setExposure",(function(){return x})),a.d(r,"subscribeToSkeletonRange",(function(){return L})),a.d(r,"subscribeToWeaponDetection",(function(){return A})),a.d(r,"toggleIsRecording",(function(){return N}));var i={};a.r(i),a.d(i,"runSavedMissionPlan",(function(){return V})),a.d(i,"importMissionFromDroneFile",(function(){return F})),a.d(i,"importMissionFromPcFile",(function(){return G})),a.d(i,"exportPlanToFile",(function(){return U}));var s=a(2),c=a(14),l=a.n(c),p=a(24),u=a(3),_=a(20),d=a(32);function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.store.getState().map.selectedDrone,a={pointingFingerEncode:new window.ROSLIB.Service({ros:_.a.getRosWebsocketObject(t),name:"EncodeCompressed",serviceType:"pointingfinger/EncodeCompressed"}),pointingFingerLocate:new window.ROSLIB.Service({ros:_.a.getRosWebsocketObject(t),name:"LocateCompressed",serviceType:"pointingfinger/LocateCompressed"}),pointingFingerReset:new window.ROSLIB.Service({ros:_.a.getRosWebsocketObject(t),name:"Reset",serviceType:"pointingfinger/Reset"}),sendIsArmedFlag:new window.ROSLIB.Topic({ros:_.a.getRosWebsocketObject(t),name:"/seeker/IsMissionArmed",messageType:"std_msgs/Bool"}),sendIsRecodringFlag:new window.ROSLIB.Topic({ros:_.a.getRosWebsocketObject(t),name:"/seeker/RosRecording",messageType:"std_msgs/Bool"}),seekerReset:new window.ROSLIB.Service({ros:_.a.getRosWebsocketObject(t),name:"seeker/Reset",serviceType:"seeker/Reset"}),seekerTakeoff:new window.ROSLIB.Service({ros:_.a.getRosWebsocketObject(t),name:"seeker/Takeoff",serviceType:"seeker/Takeoff"}),seekerLand:new window.ROSLIB.Service({ros:_.a.getRosWebsocketObject(t),name:"seeker/Land",serviceType:"seeker/Land"}),startIndoorExploration:new window.ROSLIB.Service({ros:_.a.getRosWebsocketObject(t),name:"seeker/SetIndoorState",serviceType:"seeker/SetIndoorState"}),flyToTopic:new window.ROSLIB.Topic({ros:_.a.getRosWebsocketObject(t),name:"/seeker/TranslatePosition",messageType:"geometry_msgs/Vector3"}),setExposure:new window.ROSLIB.Service({ros:_.a.getRosWebsocketObject(t),name:"/d415/rgb_camera/set_parameters",serviceType:"dynamic_reconfigure/Reconfigure"}),getDronePosition:new window.ROSLIB.TFClient({ros:_.a.getRosWebsocketObject(t),fixedFrame:"map",angularThres:.1,transThres:.1}),getDroneExploreState:new window.ROSLIB.Topic({ros:_.a.getRosWebsocketObject(t),name:"/seeker/state",messageType:"std_msgs/String"}),getSkeletonRange:new window.ROSLIB.Topic({ros:_.a.getRosWebsocketObject(t),name:"/seeker/SkeletonWorldPos",messageType:"geometry_msgs/PointStamped"}),getBatteryLevel:new window.ROSLIB.Topic({ros:_.a.getRosWebsocketObject(t),name:"/seeker/BatteryLevel",messageType:"std_msgs/Float32"}),getAirSpeed:new window.ROSLIB.Topic({ros:_.a.getRosWebsocketObject(t),name:"/seeker/AirSpeed",messageType:"std_msgs/Float32"}),doMissionReset:new window.ROSLIB.Service({ros:_.a.getRosWebsocketObject(t),name:"/seeker/DoMissionReset",serviceType:"/seeker/DoMissionReset"}),doMissionExecute:new window.ROSLIB.Service({ros:_.a.getRosWebsocketObject(t),name:"/seeker/DoMissionExecute",serviceType:"/seeker/DoMissionExecute"}),addMissionTakeoff:new window.ROSLIB.Service({ros:_.a.getRosWebsocketObject(t),name:"/seeker/AddMissionTakeoff",serviceType:"/seeker/AddMissionTakeoff"}),addMissionLand:new window.ROSLIB.Service({ros:_.a.getRosWebsocketObject(t),name:"/seeker/AddMissionLand",serviceType:"/seeker/AddMissionLand"}),addMissionWP:new window.ROSLIB.Service({ros:_.a.getRosWebsocketObject(t),name:"/seeker/AddMissionWP",serviceType:"/seeker/AddMissionWP"})};return a[e]}var m=function(e){return function(){var t=Object(p.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("subscribe: getDronePosition"),O("getDronePosition",e).subscribe("base_link",(function(t){console.log(t),a({type:u.a.GET_DRONE_POSITION_OFFSET,payload:{droneNumber:e,dronePositionOffset:t.translation,droneRotationQuaternion:t.rotation}})}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},h=a(97),M=a(40);function b(e){var t=null;if(e.naturalWidth&&e.naturalHeight){var a=document.createElement("canvas");a.width=e.naturalWidth,a.height=e.naturalHeight,a.getContext("2d").drawImage(e,0,0),t=a.toDataURL("image/jpeg")}else alert("error: captured image height or width size is 0");return t}var S=a(10),g=a(22),f=function(e){var t=e.text,a=e.type,n=e.isRemoved;return function(e){var o={text:t,type:a};e({type:u.a.SHOW_GLOBAL_MESSAGE,payload:o}),n&&setTimeout((function(){return e({type:u.a.REMOVE_GLOBAL_MESSAGE})}),3e3)}},E=function(){return function(e,t){var a=t().output.isArmed,n=new window.ROSLIB.Message({data:!a});O("sendIsArmedFlag").publish(n),e({type:u.a.TOGGLE_ARM_STATE})}},C=function(e){return function(t){O("getBatteryLevel",e).subscribe((function(a){console.log("subscribe: getBatteryLevel",a,"drone:",e),a&&a.data&&t({type:u.a.SET_BATTERY_LEVEL,payload:{batteryLevel:a.data,droneNumber:e}})}))}},v=function(e){return function(t){O("getAirSpeed",e).subscribe((function(a){console.log("subscribe: getAirSpeed",a,"drone:",e),a&&a.data&&t({type:u.a.SET_AIR_SPEED,payload:{airSpeed:a.data,droneNumber:e}})}))}},w=function(){return function(){var e=Object(p.a)(l.a.mark((function e(t){var a,n,o,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t({type:u.a.LOACTE_START}),!(a=document.getElementById("droneImage"))){e.next=14;break}if(n=b(a),t({type:u.a.IMAGE_SENT_TO_DRONE,payload:{image:n}}),o=n&&n.replace("data:image/jpeg;base64,","")){e.next=9;break}return t({type:u.a.LOACTE_FAILED}),e.abrupt("return");case 9:r=new window.ROSLIB.Message({data:o,format:"jpeg"}),i=new window.ROSLIB.ServiceRequest({image:r}),O("pointingFingerLocate").callService(i,(function(e){e.isSuccess?t({type:u.a.LOACTE_SUCCESS}):t({type:u.a.LOACTE_FAILED}),console.log(O("pointingFingerLocate").name,e)})),e.next=15;break;case 14:t({type:u.a.LOACTE_FAILED});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},T=function(e){return function(){var t=Object(p.a)(l.a.mark((function t(a){var n,o,r,i,s,c,p,_,d,m,h;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a({type:u.a.POINT_ON_VIDEO_IMAGE_START}),n=document.getElementById("droneImage"),o=(e.pageX-n.getBoundingClientRect().x)/n.width*n.naturalWidth,r=(e.pageY-n.getBoundingClientRect().y)/n.height*n.naturalHeight,console.log(o,r),i=Math.round(o),s=Math.round(r),a(f({text:"selected pixel: (".concat(i,", ").concat(s,")"),type:S.b.info,isRemoved:!0})),!n){t.next=23;break}if(c=b(n),a({type:u.a.IMAGE_SENT_TO_DRONE,payload:{image:c,point:{roundedX:i,roundedY:s}}}),p=c&&c.replace("data:image/jpeg;base64,","")){t.next=15;break}return a({type:u.a.POINT_ON_VIDEO_IMAGE_FAILED}),t.abrupt("return");case 15:_=new window.ROSLIB.Message({data:p,format:"jpeg"}),d=new window.ROSLIB.Message({x:i,y:s,z:0}),m=new window.ROSLIB.ServiceRequest({image:_,point:d}),O("pointingFingerEncode").callService(m,(function(e){console.log(O("pointingFingerEncode").name,e)})),h=new window.ROSLIB.ServiceRequest({image:_}),O("pointingFingerLocate").callService(h,(function(e){e.isSuccess&&a({type:u.a.POINT_ON_VIDEO_IMAGE_SUCCESS}),console.log(O("pointingFingerLocate").name,e)})),t.next=24;break;case 23:a({type:u.a.POINT_ON_VIDEO_IMAGE_FAILED});case 24:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},D=function(){return function(){var e=Object(p.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:u.a.RESET_START}),a=new window.ROSLIB.ServiceRequest({}),O("pointingFingerReset").callService(a,(function(e){e.isSuccess?t({type:u.a.RESET_SUCCESS}):t({type:u.a.RESET_FAILED}),console.log(O("pointingFingerReset").name,e)})),O("seekerReset").callService(a,(function(e){console.log("Result for service call on "+O("seekerReset").name+": "+e.isSuccess),console.log(O("seekerReset").name,e)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},y=function(){return function(){var e=Object(p.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:u.a.TAKE_OFF_START}),t(f({text:"Taking off...",type:S.b.info,isRemoved:!0})),a=new window.ROSLIB.ServiceRequest({}),O("seekerTakeoff").callService(a,(function(e){t({type:u.a.TAKE_OFF_SUCCESS}),console.log(e)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},I=function(){return function(){var e=Object(p.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:u.a.LAND_START}),t(f({text:"Landing...",type:S.b.info,isRemoved:!0})),a=new window.ROSLIB.ServiceRequest({}),O("seekerLand").callService(a,(function(e){t({type:u.a.LAND_SUCCESS})}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},P=function(){return function(){var e=Object(p.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:u.a.START_INDOOR_EXPLORATION}),a=new window.ROSLIB.ServiceRequest({}),O("startIndoorExploration").callService(a,(function(e){console.log(e)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},j=function(e){return function(){var t=Object(p.a)(l.a.mark((function t(a){var n,o,r,i,s,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:u.a.GO_TO_LOCATION_START}),a(f({text:"Go To Location ".concat(e),type:S.b.info,isRemoved:!0})),n=e.split(","),o=Object(M.a)(n,3),r=o[0],i=o[1],s=o[2],c=new window.ROSLIB.Message({x:parseFloat(r),y:parseFloat(i),z:parseFloat(s)}),O("flyToTopic").publish(c);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},x=function(e){return function(){var t=Object(p.a)(l.a.mark((function t(a){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:u.a.SET_EXPOSURE_START}),a(f({text:"Setting Exposure...",type:S.b.info,isRemoved:!0})),n=new window.ROSLIB.ServiceRequest({config:{bools:[],strs:[],doubles:[],groups:[],ints:[{name:"exposure",value:e}]}}),O("setExposure").callService(n,(function(e){e.isSuccess&&a({type:u.a.SET_EXPOSURE_SUCCESS}),console.log(e)}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},L=function(e){return function(t,a){O("getSkeletonRange",e).subscribe((function(n){console.log("subscribe: getSkeletonRange",n);try{if(a().map.dronesPositions[e]&&a().map.dronesPositions[e].workingOrigin&&n&&n.point&&(t({type:u.a.GET_ENEMY_POSITION,payload:{enemyOffset:n.point,droneNumber:e}}),a().map.selectedDrone==e)){var o=g.a(a().map.dronesPositions[e].offset,n.point,!0);t({type:u.a.UPDATE_SKELETON_RANGE,payload:{skeletonRange:o.toFixed(1)}})}}catch(r){}}))}},A=function(e){return function(t,a){console.log("subscribe: getDroneExploreState"),O("getDroneExploreState",e).subscribe((function(e){e&&e.data&&(t({type:u.a.SET_MISSION_STATE,payload:{missionState:e.data}}),e.data&&e.data.startsWith("INDOOR_EXPLORATION")?t({type:u.a.SET_INDOOR_EXPLORATION_FLAG}):a().output.isArmed&&"INDOOR_EXPLORATION_THREAT"===e.data&&(t({type:u.a.SET_WEAPON_DETECTION,payload:{weaponDetected:!0}}),t(f({text:"Threat Detected",type:S.b.warn,isRemoved:!0}))))}))}},N=function(){return function(e,t){var a=t().video.isRecording,n=new window.ROSLIB.Message({data:!a});O("sendIsRecodringFlag").publish(n),e({type:u.a.TOGGLE_RECORDING_STATE})}},R=a(28),k=a(44),B=a.n(k);function W(e,t){return console.log("starting calling service ",e,"with params:",t),new Promise((function(a,n){O(e).callService(t,(function(t){console.log("finish calling service ",e),a(t)}))}))}var V=function(){return function(){var e=Object(p.a)(l.a.mark((function e(t,a){var n,o,r,i,s,c,p,u,_,d,O,m,h,b,E,C,v,w;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(f({text:"Starting to execute planned mission",type:S.b.info,isRemoved:!0})),n=new window.ROSLIB.ServiceRequest({}),e.next=4,W("doMissionReset",n);case 4:if(o=a().planner.savedMissionPlan,r=a().map.selectedDrone,i=a().map.dronesPositions[r]&&a().map.dronesPositions[r].workingOrigin){e.next=10;break}return alert("select working origin first"),e.abrupt("return");case 10:c=Object(R.a)(o),e.prev=11,c.s();case 13:if((p=c.n()).done){e.next=34;break}if(u=p.value,!(_=u.selectedStageType.rossService)){e.next=32;break}e.t0=_,e.next="addMissionWP"===e.t0?20:"addMissionTakeoff"===e.t0||"addMissionLand"===e.t0?26:28;break;case 20:return d=u.stageParamsInput.split(","),O=Object(M.a)(d,3),m=O[0],h=O[1],b=O[2],E=g.d(i.coordinate,{x:m,y:h,z:b}),C=g.b(E,-i.angle),v=g.c(C),s=new window.ROSLIB.ServiceRequest({coordinate:v}),e.abrupt("break",30);case 26:return s=new window.ROSLIB.ServiceRequest({}),e.abrupt("break",30);case 28:return s=null,e.abrupt("break",30);case 30:return e.next=32,W(_,s);case 32:e.next=13;break;case 34:e.next=39;break;case 36:e.prev=36,e.t1=e.catch(11),c.e(e.t1);case 39:return e.prev=39,c.f(),e.finish(39);case 42:return w=new window.ROSLIB.ServiceRequest({}),e.next=46,W("doMissionExecute",w);case 46:case"end":return e.stop()}}),e,null,[[11,36,39,42]])})));return function(t,a){return e.apply(this,arguments)}}()},F=function(){return function(){var e=Object(p.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B.a.get(S.a.urls.loadMission);case 3:a=e.sent,t({type:u.a.LOAD_DEFAULT_PLAN,payload:a.data}),t(f({text:"Default plan loaded successfully",type:S.b.success,isRemoved:!0})),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),t(f({text:"Unable to load default plan",type:S.b.error,isRemoved:!0})),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},G=function(e){return function(){var t=Object(p.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{a({type:u.a.LOAD_DEFAULT_PLAN,payload:e}),a(f({text:"Default plan loaded successfully",type:S.b.success,isRemoved:!0}))}catch(n){a(f({text:"Unable to load default plan",type:S.b.error,isRemoved:!0})),console.log(n)}case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},U=function(e,t){return function(){var a=Object(p.a)(l.a.mark((function a(n){var o,r;return l.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:try{o="data:text/json;charset=utf8,"+encodeURIComponent(JSON.stringify(e,null,2)),(r=document.createElement("a")).setAttribute("href",o),r.setAttribute("download","".concat(t,".json")),document.body.appendChild(r),r.click(),r.remove()}catch(i){n(f({text:"Unable to load default plan",type:S.b.error,isRemoved:!0})),console.log(i)}case 1:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()},H=Object(s.a)(Object(s.a)(Object(s.a)(Object(s.a)(Object(s.a)({},n),h),r),o),i);t.a=H},function(e,t,a){e.exports={Wrapper:"Video_Wrapper__3_xdH",FullHeight:"Video_FullHeight__2AqGh",Fixed:"Video_Fixed__Fenki",VideoImage:"Video_VideoImage___DQkT",ErrorIcon:"Video_ErrorIcon__1NO6w",ErrorMessage:"Video_ErrorMessage__27FPM",VideoHeader:"Video_VideoHeader__2tu2v",Description:"Video_Description__1KJN3",ToggleTarget:"Video_ToggleTarget__2WMbz",HideTarget:"Video_HideTarget__3urqT",Exposure:"Video_Exposure__JbvqD",VideoFooter:"Video_VideoFooter__orMJZ",ControlBtn:"Video_ControlBtn__3Zwp3",Play:"Video_Play__DQHdm",Pause:"Video_Pause__4ESNC",RecordButton:"Video_RecordButton__Zmbp2",RecordIcon:"Video_RecordIcon__sCcz3",RecordindIcon:"Video_RecordindIcon__34ok9",recordAnimation:"Video_recordAnimation__20TNn",FullScreen:"Video_FullScreen__1xHB8",ExitFullScreen:"Video_ExitFullScreen__SfbP2",StreamingIconWrapper:"Video_StreamingIconWrapper__3cVbX",StreamingIcon:"Video_StreamingIcon__1HmJq",Footer:"Video_Footer__K-0xF",TargetIcon:"Video_TargetIcon__1tkze",TargetLarge:"Video_TargetLarge__3R4SP"}},function(e,t,a){"use strict";var n=a(28),o=a(6),r=a(8),i=a(10),s=a(3),c=a(18),l=a(21),p=a(32),u=function(){function e(){var t=this;Object(o.a)(this,e),this.rosWebSocket=null,this.rosWebSockets={},this.RECONNECT_TIMEOUT=2e3,this.registerAll=function(){var e,a=l.a.getConfiguration().DRONES_DATA,o=Object(n.a)(a.dronesList);try{for(o.s();!(e=o.n()).done;){var r=e.value;t.register(r)}}catch(i){o.e(i)}finally{o.f()}},this.reRegister=function(e){setTimeout((function(){return t.register(e)}),t.RECONNECT_TIMEOUT)}}return Object(r.a)(e,[{key:"showMessage",value:function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=p.store.dispatch,r=p.store.getState,i=r().map.selectedDrone;e===i&&o(c.a.showGlobalMessage({text:t,type:a,isRemoved:n}))}},{key:"register",value:function(e){var t=this;try{var a=l.a.getConfiguration(),n=a.ROS_BE_PORT,o=a.ROS_BE_PROTOCOL,r=a.DRONES_DATA,u="".concat(o,"://").concat(r.segment,".").concat(e,":").concat(n);this.showMessage(e,"Trying to connect ros websocket on: ".concat(u),i.b.info,!0),this.rosWebSockets[e]=new window.ROSLIB.Ros({url:u}),this.rosWebSockets[e].on("connection",(function(){t.showMessage(e,"Connected successfuly to ros websocket",i.b.success,!0),p.store.dispatch({type:s.a.ROSS_WEBSOCKET_CONNECTION_SUCCESS}),p.store.dispatch(c.a.subscribeToDroneData(e)),p.store.dispatch(c.a.subscribeToSkeletonRange(e)),p.store.dispatch(c.a.subscribeToWeaponDetection(e)),p.store.dispatch(c.a.subscribeToBatteryLevel(e)),p.store.dispatch(c.a.subscribeToAirSpeed(e))})),this.rosWebSockets[e].on("error",(function(a){t.showMessage(e,"Failed to connect ros websocket on: ".concat(u),i.b.error),p.store.dispatch({type:s.a.ROSS_WEBSOCKET_CONNECTION_FAILED}),console.log(a)})),this.rosWebSockets[e].on("close",(function(){t.showMessage(e,"Connection to ros websocket on: ".concat(u," closed"),i.b.error),p.store.dispatch({type:s.a.ROSS_WEBSOCKET_CONNECTION_CLOSED}),t.reRegister(e)}))}catch(_){console.log("RosWebSocket.register() Exception:"+_)}}},{key:"getRosWebsocketObject",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.a.getConfiguration().selectedDrone;return null==this.rosWebSockets[e]&&this.register(e),this.rosWebSockets[e]}}]),e}();t.a=new u},function(e,t,a){"use strict";var n=a(6),o=a(8),r=function(){function e(){Object(n.a)(this,e),this.externalConfigurationHandler=null}return Object(o.a)(e,[{key:"setConfiguration",value:function(e){this.externalConfigurationHandler=e}},{key:"getConfiguration",value:function(){return this.externalConfigurationHandler}}]),e}();t.a=new r},function(e,t,a){"use strict";function n(e,t,a){var n=t.x-e.x,o=t.y-e.y,r=a?0:t.z-e.z;return Math.sqrt(n*n+o*o+r*r)}function o(e,t){if(e){var a,n,o=function(e){return{x:-e.y,y:e.x,z:e.z}}(r(t,e.angle));return a=e.coordinate,n=o,{x:a.x+n.x,y:a.y+n.y,z:a.z+n.z}}}function r(e,t){var a=t*Math.PI/180,n=e.x,o=e.y,r=e.z;return{x:n*Math.cos(a)-o*Math.sin(a),y:n*Math.sin(a)+o*Math.cos(a),z:parseInt(r)}}function i(e){return{x:e.y,y:-e.x,z:e.z}}function s(e,t){return{x:t.x-e.x,y:t.y-e.y,z:t.z}}function c(e,t){var a=Math.pow(10,t||0);return{x:Math.round(e.x*a)/a,y:Math.round(e.y*a)/a,z:Math.round(e.z*a)/a}}function l(e){return null===e||void 0===e?0:180*Math.atan2(2*e.x*e.y-2*e.w*e.z,2*e.w*e.w+2*e.x*e.x-1)/Math.PI}a.d(t,"a",(function(){return n})),a.d(t,"e",(function(){return o})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return s})),a.d(t,"g",(function(){return c})),a.d(t,"f",(function(){return l}))},,,function(e,t,a){e.exports={h2:"Popup_h2__sBm9G",Overlay:"Popup_Overlay__Lz1tD",Popup:"Popup_Popup__1O31A",PopupHeaderWrapper:"Popup_PopupHeaderWrapper__2-ikc",PopupBody:"Popup_PopupBody__1kaHU",NoBodyOverFlow:"Popup_NoBodyOverFlow__stG_q",PopupFooter:"Popup_PopupFooter__2ofpz",closeBtn:"Popup_closeBtn__30DBN",FormButton:"Popup_FormButton__32S7X",Apply:"Popup_Apply__1uDlX",small:"Popup_small__3mJFK",medium:"Popup_medium__3X6Sz",Disabled:"Popup_Disabled__3KI0U"}},function(e,t,a){"use strict";a.d(t,"b",(function(){return i}));var n=a(46),o=a(2),r=a(3),i={draft:"draft",savedMission:"savedMission"},s={draftMissionStages:[],savedMissionPlan:[],viewerState:i.draft};function c(e,t,a){return e.map((function(n,o){return o===t?e[a]:o===a?e[t]:n}))}t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.a.ADD_NEW_MISSION_PLAN_STAGE:return Object(o.a)(Object(o.a)({},e),{},{draftMissionStages:[].concat(Object(n.a)(e.draftMissionStages),[t.payload])});case r.a.DELETE_MISSION_PLAN_STAGE:return Object(o.a)(Object(o.a)({},e),{},{draftMissionStages:e.draftMissionStages.filter((function(e){return e.stageId!==t.payload.id}))});case r.a.EDIT_MISSION_PLAN_STAGE:return Object(o.a)(Object(o.a)({},e),{},{draftMissionStages:[].concat(Object(n.a)(e.draftMissionStages.slice(0,t.payload.stageIndex)),[t.payload.stage],Object(n.a)(e.draftMissionStages.slice(t.payload.stageIndex+1)))});case r.a.MOVE_DOWN_MISSION_PLAN_STAGE:var a=t.payload;return 0===a?e:Object(o.a)(Object(o.a)({},e),{},{draftMissionStages:c(e.draftMissionStages,a,a-1)});case r.a.MOVE_UP_MISSION_PLAN_STAGE:var l=t.payload;return 0===e.draftMissionStages.length||l===e.draftMissionStages.length-1?e:Object(o.a)(Object(o.a)({},e),{},{draftMissionStages:c(e.draftMissionStages,l,l+1)});case r.a.SAVE_MISSION_PLAN:var p=JSON.parse(JSON.stringify(e.draftMissionStages));return Object(o.a)(Object(o.a)({},e),{},{savedMissionPlan:p});case r.a.REMOVE_DRAFT_MISSION_PLAN:return Object(o.a)(Object(o.a)({},e),{},{draftMissionStages:[]});case r.a.REMOVE_SAVED_MISSION_PLAN:return Object(o.a)(Object(o.a)({},e),{},{savedMissionPlan:[]});case r.a.TOGGLE_MISSION_PLAN_VIEWER_STATE:return Object(o.a)(Object(o.a)({},e),{},{viewerState:e.viewerState===i.draft?i.savedMission:i.draft});case r.a.LOAD_DEFAULT_PLAN:return e.viewerState===i.savedMission?Object(o.a)(Object(o.a)({},e),{},{savedMissionPlan:t.payload}):Object(o.a)(Object(o.a)({},e),{},{draftMissionStages:t.payload});default:return e}}},,,,function(e,t,a){e.exports={Row:"Input_Row__1NNGu",Label:"Input_Label__1KIpZ",Mandatory:"Input_Mandatory__Csafp",InputWrapper:"Input_InputWrapper__3rekC",InnerInputWrapper:"Input_InnerInputWrapper__2jecR",Input:"Input_Input__1fSUH",ShowError:"Input_ShowError__2VsCB",ValidationMessage:"Input_ValidationMessage__1uZKf",ValidationImg:"Input_ValidationImg__39nK6",readOnly:"Input_readOnly__AIrNX",InfoImage:"Input_InfoImage__3foYR",Disabled:"Input_Disabled__11O5s"}},function(e,t,a){e.exports={Wrapper:"MapContainer_Wrapper__27nRY",SmallMap:"MapContainer_SmallMap__2Pf_S",LoadingMessage:"MapContainer_LoadingMessage__1xCqh",CanvasContainer:"MapContainer_CanvasContainer__20Pvi",MapWrapper:"MapContainer_MapWrapper__3N3n0",MapToolbox:"MapContainer_MapToolbox__3Rx7F",Active:"MapContainer_Active__2ss1F",DescRow:"MapContainer_DescRow__27Z_D",DescValue:"MapContainer_DescValue__3qrq3",DescLabel:"MapContainer_DescLabel__1TYDX",Description:"MapContainer_Description__1R00O",MoreActionsBtn:"MapContainer_MoreActionsBtn__1Cfu0",SwithViewBtn:"MapContainer_SwithViewBtn__Vz-lM",SwitchMapForm:"MapContainer_SwitchMapForm__n0MuY",Open:"MapContainer_Open__3Z8xb"}},function(e,t,a){"use strict";a.r(t),a.d(t,"store",(function(){return bt}));var n=a(1),o=a.n(n),r=a(51),i=a.n(r),s=(a(104),a(6)),c=a(8),l=a(12),p=a(11),u=a(2),_=a.p+"static/media/newLogo.990b2210.svg",d=a(7),O=a.n(d),m=a(47),h=a.n(m),M=a(0),b=function(e){Object(l.a)(a,e);var t=Object(p.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"renderOverlay",value:function(){return this.props.withOverlay?Object(M.jsx)("div",{className:h.a.Overlay}):null}},{key:"render",value:function(){return Object(M.jsxs)(M.Fragment,{children:[this.renderOverlay(),Object(M.jsxs)("div",{className:h.a.loader,"data-message":this.props.loadingMessage,children:[Object(M.jsx)("div",{className:h.a.bg}),Object(M.jsx)("div",{className:h.a.circle}),Object(M.jsx)("div",{className:h.a.circle}),Object(M.jsx)("div",{className:h.a.circle}),Object(M.jsx)("div",{className:h.a.circle}),Object(M.jsx)("div",{className:h.a.circle})]})]})}}]),a}(n.PureComponent),S=a(81),g=a.n(S),f=function(e){Object(l.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={date:new Date},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;setInterval((function(){return e.setState({date:new Date})}),1e3)}},{key:"getFormatedData",value:function(){var e=this.state.date,t=e.getFullYear(),a=e.toLocaleString("en",{month:"short"}),n=e.getDate();return n=n<10?"0".concat(n):n,"".concat(a,". ").concat(n," ").concat(t,",")}},{key:"render",value:function(){return Object(M.jsx)("span",{className:g.a.DateTime,children:Object(M.jsx)("span",{className:g.a.Hour,children:this.state.date.toLocaleTimeString(navigator.language,{hour12:!1})})})}}]),a}(n.PureComponent),E=a(65),C=a.n(E),v=a(9),w=function(e){return Object(M.jsx)(v.l.DropdownIndicator,Object(u.a)(Object(u.a)({},e),{},{children:Object(M.jsx)("span",{className:C.a.DropDownArrow})}))},T={container:function(e,t){return Object(u.a)(Object(u.a)({},e),{},{cursor:t.isDisabled?"not-allowed":"pointer",width:"100%",fontSize:"14px",fontWeight:"400",lineHeight:"1.5",color:"var(--input-text-text-color)",background:"var(--input-text-bg-color)",border:"1px solid var(--input-border-color)",borderRadius:"4px",textTransform:"capitalize"})},option:function(e,t){return Object(u.a)(Object(u.a)({},e),{},{"&:hover":{backgroundColor:"#b4b4b425"},color:"var(--app-font-color)",fontSize:"var(--app-font-size)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textTransform:"capitalize",backgroundColor:t.isSelected||t.isFocused?"#b4b4b425":"trasparent",border:t.isSelected?"1px solid var(--app-select-selected-border-color)":"none",cursor:t.isDisabled?"not-allowed":"pointer"})},control:function(e,t){return Object(u.a)(Object(u.a)({},e),{},{borderRadius:"2px",backgroundColor:"transparent",minHeight:"unset",borderColor:"transparent",color:"var(--app-font-color)",boxShadow:(t.isFocused,0),"&:hover":{},cursor:t.isDisabled?"not-allowed":"pointer"})},menu:function(e){return Object(u.a)(Object(u.a)({},e),{},{backgroundColor:"#191919",paddingTop:0,marginTop:2,border:"1px solid var(--input-border-color)",maxHeight:"150px",overflow:"auto"})},valueContainer:function(e){return Object(u.a)(Object(u.a)({},e),{},{fontSize:"var(--app-font-size)"})},indicatorSeparator:function(e){return Object(u.a)(Object(u.a)({},e),{},{display:"none"})},dropdownIndicator:function(e){return Object(u.a)(Object(u.a)({},e),{},{color:"black"})},singleValue:function(e){return Object(u.a)(Object(u.a)({},e),{},{fontSize:"var(--app-font-size)",fontWeight:400,color:"var(--container-list-header-item-color)"})},placeholder:function(e){return Object(u.a)(Object(u.a)({},e),{},{color:"var(--app-font-color)"})},noOptionsMessage:function(e){return Object(u.a)(Object(u.a)({},e),{},{fontWeight:400,color:"var(--app-font-color)",fontSize:"var(--app-font-size)"})}},D=a(80),y=function(e){Object(l.a)(a,e);var t=Object(p.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){var e=Object(u.a)(Object(u.a)({},this.props),{},{styles:this.props.styles||T,components:{DropdownIndicator:w}});return Object(M.jsxs)("div",{className:C.a.DropDownWrapper,children:[Object(M.jsx)("label",{className:C.a.ComboLabel,children:this.props.label}),Object(M.jsx)(D.a,Object(u.a)({},e))]})}}]),a}(n.Component),I=a(25),P=a.n(I),j=a.p+"static/media/close.cafa525b.svg",x=a(94),L=a.n(x),A=a(17),N=a(30),R=a.n(N),k=function(e){Object(l.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={isShowInfoTooltip:!1},e.showInfoTooltip=function(t){e.setState({isShowInfoTooltip:!0,clientX:t.target.getBoundingClientRect().left,clientY:t.target.getBoundingClientRect().top})},e.hideTooltip=function(){return e.setState({isShowInfoTooltip:!1,clientX:null,clientY:null})},e.getInputByType=function(){var t=e.props.value;switch(e.props.type){case"Coordinate":return Object(M.jsxs)("div",{className:R.a.InnerInputWrapper,children:[e.props.button&&Object(M.jsx)("span",{className:"".concat(R.a.Icon," ").concat(R.a.PositionIcon),title:"Select On Map",onClick:function(){return e.props.button.action()}}),e.getInputField(t&&t.x||"","X"),e.getInputField(t&&t.y||"","Y"),e.getInputField(t&&t.z||"","Z")]});default:return e.getInputField(t,e.props.placeHolder)}},e}return Object(c.a)(a,[{key:"renderInfo",value:function(){if(this.props.info)return Object(M.jsx)("span",{className:R.a.InfoImage,onMouseEnter:this.showInfoTooltip,onMouseLeave:this.hideTooltip})}},{key:"render",value:function(){var e=this.props.mandatory?" ".concat(R.a.Mandatory):"",t=this.props.disabled?" ".concat(R.a.Disabled):"",a=this.props.error?" ".concat(R.a.ShowError):"",n=this.props.readOnly?" ".concat(R.a.readOnly):"";return Object(M.jsxs)("div",{className:"".concat(R.a.Row).concat(t),children:[Object(M.jsxs)("span",{className:"".concat(R.a.Label).concat(e),children:[this.props.label,this.renderInfo()]}),Object(M.jsxs)("div",{className:R.a.InputWrapper,children:[Object(M.jsx)("div",{className:R.a.InnerInputWrapper,children:Object(M.jsx)("input",{ref:this.props.parentRef||null,placeholder:this.props.placeHolder,value:this.props.value,name:this.props.name,className:"".concat(R.a.Input).concat(a).concat(n),maxLength:this.props.maxLength||null,type:this.props.type||"text",onFocus:this.props.onFocus,onChange:this.props.onChange,readOnly:this.props.readOnly||this.props.disabled})}),Object(M.jsx)("div",{className:"".concat(R.a.ValidationMessage).concat(a),children:this.props.error||""})]})]})}}]),a}(n.Component),B=function(e){Object(l.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).inputRef=o.a.createRef(),e.state={value:""},e.onValueChange=function(t){var a=t.target.value;e.setState({value:a},(function(){return e.props.onValueChange(a)}))},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.inputRef&&this.inputRef.current&&this.inputRef.current.focus()}},{key:"render",value:function(){return Object(M.jsx)("div",{className:L.a.Wrapper,children:Object(M.jsx)(k,{parentRef:this.inputRef,value:this.state.value||this.props.defaultValue,onChange:this.onValueChange,placeHolder:this.props.placeHolder||"",label:this.props.label})})}}]),a}(n.Component),W=Object(A.b)((function(e,t){return{}}),(function(e){return{}}))(B),V=a(40),F=a(37),G=a.n(F),U={SingleInputForm:W,AddMissionPlanStageForm:function(e){Object(l.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).parseMultiParams=function(){if(n.props.stage&&n.props.stage.stageParamsInput&&""!=n.props.stage.stageParamsInput){var e=n.props.stage.stageParamsInput.split(","),t=Object(V.a)(e,3);return{x:t[0],y:t[1],z:t[2]}}return null},n.getMissionPlanState=function(){return n.state},n.getInputField=function(e,t){var a=n.state.selectedStageType;return Object(M.jsx)("div",{className:G.a.InnerInputWrapper,children:Object(M.jsx)(k,{parentRef:n.inputRef,value:null!==e&&void 0!==e?e:"",onChange:function(e){return n.onInputChange(e,t)},disabled:!1,type:a.params.type||"",placeHolder:t||a.params.placeHolder||"",button:a.params.button||null})})},n.state={selectedStageType:e.stage&&e.stage.selectedStageType||null,stageParamsInput:e.stage&&e.stage.stageParamsInput||"",multiParamsInput:n.parseMultiParams()||{},stageId:e.stage&&e.stage.stageId||Math.round(1e5*Math.random())},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.onPopupInitalLoad&&this.props.onPopupInitalLoad(this.getMissionPlanState)}},{key:"componentDidUpdate",value:function(e){if(e.pointFromMap!=this.props.pointFromMap){var t=this.props.pointFromMap,a=t.x+","+t.y+","+t.z;this.setState({multiParamsInput:t,stageParamsInput:a})}}},{key:"handleTypeChange",value:function(e){this.setState({selectedStageType:e,stageParamsInput:"",multiParamsInput:{}})}},{key:"renderStageType",value:function(){var e=this,t={label:"Select Stage Type:",defaultValue:this.state.selectedStageType||{label:"Select...",value:"Select..."},options:[{label:"Takeoff",params:{label:"Height:",placeHolder:"meters"},rossService:"addMissionTakeoff"},{label:"Go To Waypoint",isMultiInputs:!0,params:{label:"Waypoint Coordinate:"},rossService:"addMissionWP"},{label:"Pause",params:{label:"Pause for:",placeHolder:"seconds"}},{label:"Land",rossService:"addMissionLand"},{label:"Set Speed",params:{label:"Speed Value:",placeHolder:"km/h"}},{label:"Set Waypoint Radius",params:{label:"Radius Value:",placeHolder:"meters"}}],onChange:function(t){return e.handleTypeChange(t)}};return Object(M.jsx)("div",{className:G.a.Row,children:Object(M.jsx)(y,Object(u.a)({},t))})}},{key:"onInputChange",value:function(e,t){var a=this.state,n=a.stageParamsInput,o=a.multiParamsInput;t?(o[t]=e.target.value,n=o.x+","+o.y+","+o.z):n=e.target.value,this.setState({stageParamsInput:n,multiParamsInput:o})}},{key:"renderStageInput",value:function(){if(this.state.selectedStageType&&this.state.selectedStageType.params){var e=this.state,t=e.selectedStageType,a=e.stageParamsInput,n=e.multiParamsInput;return Object(M.jsxs)("div",{className:G.a.Row,children:[Object(M.jsx)("span",{className:"".concat(G.a.Label),children:this.state.selectedStageType.params.label}),Object(M.jsx)("div",{className:G.a.InputWrapper,children:t.isMultiInputs?Object(M.jsxs)(M.Fragment,{children:[this.getInputField(n.x,"x"),this.getInputField(n.y,"y"),this.getInputField(n.z,"z")]}):this.getInputField(a)}),t.isMultiInputs&&Object(M.jsxs)("div",{className:G.a.InputWrapper,children:[Object(M.jsx)("span",{className:"".concat(G.a.Icon," ").concat(G.a.PositionIcon),title:"Select On Map",onClick:this.props.selectPointFromMap}),this.props.getDronePosition&&Object(M.jsx)("span",{className:"".concat(G.a.Icon," ").concat(G.a.DroneIcon),title:"Get Drone Position",onClick:this.props.getDronePosition})]}),this.props.isSelectOrigin&&Object(M.jsx)("span",{className:"".concat(G.a.Label),children:"Origin angle:"}),this.props.isSelectOrigin&&this.getInputField(n.angle||0,"angle")]})}}},{key:"render",value:function(){return Object(M.jsxs)("div",{className:G.a.Wrapper,children:[this.props.isSelectOrigin?"":this.renderStageType(),this.renderStageInput()]})}}]),a}(n.Component)},H=a(3),K=function(e){Object(l.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).EscKey=27,e.EnterKey=13,e.handleKeyDown=function(t){t.keyCode===e.EscKey?e.closePopup():t.keyCode===e.EnterKey&&e.props.popupDetails.primayButton&&e.props.popupDetails.primayButton.callback&&(e.props.popupDetails.primayButton.callback(),e.closePopup())},e.closePopup=function(){e.props.popupDetails&&e.props.popupDetails.onCloseButtonClick&&e.props.popupDetails.onCloseButtonClick(),e.props.hidePopup()},e.onCloseBtnClick=function(t){t.preventDefault(),e.closePopup()},e.onPrimaryBtnClick=function(t){t.preventDefault(),e.props.popupDetails.primayButton&&e.props.popupDetails.primayButton.callback&&e.props.popupDetails.primayButton.callback(),e.closePopup()},e.onSecondaryBtnClick=function(t){t.preventDefault(),e.props.popupDetails.secondaryButton&&e.props.popupDetails.secondaryButton.callback&&e.props.popupDetails.secondaryButton.callback(),e.closePopup()},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"getXBtn",value:function(){return this.props.hideXButton?null:Object(M.jsx)("a",{className:P.a.Close,href:"#",onClick:this.onCloseBtnClick,children:Object(M.jsx)("img",{className:P.a.closeBtn,src:j})})}},{key:"closePopup",value:function(){this.props.popupDetails&&this.props.popupDetails.onCloseButtonClick&&this.props.popupDetails.onCloseButtonClick(),this.props.hidePopup()}},{key:"renderButtons",value:function(){var e=Object(M.jsx)("button",{type:"button",className:"".concat(P.a.Btn," ").concat(P.a.BtnPrimary),onClick:this.onPrimaryBtnClick,children:"Close"}),t=null,a=this.props.popupDetails;if(a.primayButton){var n=a.primayButton.disabled;e=Object(M.jsx)("button",{type:"button",className:"".concat(P.a.FormButton," ").concat(P.a.Apply," ").concat(n?P.a.Disabled:""),onClick:n?void 0:this.onPrimaryBtnClick,children:a.primayButton.title})}if(a.secondaryButton){var o=a.secondaryButton.disabled;t=Object(M.jsx)("button",{type:"button",className:"".concat(P.a.FormButton,"   ").concat(o?P.a.Disabled:""),onClick:o?void 0:this.onSecondaryBtnClick,children:a.secondaryButton.title})}return Object(M.jsxs)(M.Fragment,{children:[t,e]})}},{key:"getFooter",value:function(){return Object(M.jsx)("div",{className:P.a.PopupFooter,children:Object(M.jsx)("div",{children:this.renderButtons()})})}},{key:"getHeader",value:function(){return Object(M.jsx)("div",{className:P.a.PopupHeader,children:Object(M.jsxs)("div",{className:P.a.PopupHeaderWrapper,children:[Object(M.jsx)("h2",{className:P.a.h2,children:this.props.popupDetails.title}),this.getXBtn()]})})}},{key:"renderChild",value:function(){var e=U[this.props.popupDetails.modalChild];return Object(M.jsx)(e,Object(u.a)({},this.props.popupDetails.modalChildProps))}},{key:"getBody",value:function(){var e=this.props.noBodyOverflow?P.a.NoBodyOverFlow:"";return Object(M.jsx)("div",{className:"".concat(P.a.PopupBody," ").concat(e),children:this.props.popupDetails.modalChild?this.renderChild():null})}},{key:"render",value:function(){if(!this.props.popupDetails)return null;var e=this.props.isPointSelectionMode?{visibility:"hidden"}:{},t=this.props.popupDetails.size?P.a[this.props.popupDetails.size]:"";return Object(M.jsx)("div",{className:P.a.Overlay,children:Object(M.jsxs)("div",{className:"".concat(P.a.Popup," ").concat(t),style:e,children:[this.getHeader(),this.getBody(),this.getFooter()]})})}}]),a}(n.PureComponent),z=Object(A.b)((function(e){return{isPointSelectionMode:e.layout.isPointSelectionMode}}),(function(e){return{hidePopup:function(){return e({type:H.a.HIDE_POPUP})}}}))(K);a(95);var X=a(67),Y=a.n(X),q=a.p+"static/media/infoFull.51dc3050.svg",J=a.p+"static/media/success.617ddc92.svg",Z=a.p+"static/media/errorIcon.8ac257c2.svg",Q=a.p+"static/media/warnIcon.a363b201.svg",$=a(10),ee=function(e){Object(l.a)(a,e);var t=Object(p.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"renderIcon",value:function(){var e;switch(this.props.appGlobalMessage.type){case $.b.info:e=q;break;case $.b.success:e=J;break;case $.b.warn:e=Q;break;case $.b.error:e=Z;break;default:e=q}return Object(M.jsx)("img",{className:Y.a.Icon,src:e})}},{key:"renderText",value:function(e){return Object(M.jsx)("div",{className:Y.a.Text,children:e})}},{key:"renderNotification",value:function(e){var t=this.props.isMissionPlanScreenHidden?"":" ".concat(Y.a.MissionPlannerOpen);return Object(M.jsxs)("div",{className:"".concat(Y.a.Wrapper).concat(t),children:[this.renderIcon(),this.renderText(e.text)]})}},{key:"render",value:function(){var e=this.props.appGlobalMessage;return e&&e.text?this.renderNotification(e):null}}]),a}(n.PureComponent),te=Object(A.b)((function(e){return{appGlobalMessage:e.layout.appGlobalMessage,isMissionPlanScreenHidden:e.layout.isMissionPlanScreenHidden}}),(function(e){return{}}))(ee),ae=a(48),ne=a.n(ae),oe=function(e){Object(l.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).CONTEXT_MENU_WIDTH=150,e.contextRef=o.a.createRef(),e.state={top:0,left:0,menuItems:[]},e.closeContextMenu=function(t){e.contextRef&&e.contextRef.current&&!e.contextRef.current.contains(t.target)&&e.props.closeContextMenu()},e.onItemClick=function(t){t.func&&t.func(t.task),e.props.closeContextMenu()},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.closeContextMenu),this.updatePosition(this.props.contextMenu.x,this.props.contextMenu.y,this.props.contextMenu.items)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.closeContextMenu)}},{key:"getNewTop",value:function(e){var t=35*this.props.contextMenu.items.length;return e+t>document.body.offsetHeight?e-t:e}},{key:"updatePosition",value:function(e,t,a){this.setState({top:this.getNewTop(t),left:e+this.CONTEXT_MENU_WIDTH>document.body.offsetWidth?document.body.offsetWidth-20:e,menuItems:a})}},{key:"render",value:function(){var e=this,t=null!=this.state.menuItems&&this.state.menuItems.length>0?"":ne.a.Close,a=this.props.contextMenu.options&&this.props.contextMenu.options.side?ne.a[this.props.contextMenu.options.side]:"",n="";return this.state.menuItems&&this.state.menuItems.length>0&&(n=this.state.menuItems.map((function(t,a){return Object(M.jsxs)("li",{title:t.title,className:ne.a.menuItem,onClick:function(){return e.onItemClick(t)},style:{cursor:t.func?"pointer":"default"},children:[t.iconCss&&Object(M.jsx)("span",{className:"".concat(ne.a.ContextMenuIcon," ").concat(ne.a[t.iconCss])}),Object(M.jsx)("div",{className:ne.a.menuName,children:t.name})]},a)}))),Object(M.jsx)("div",{style:{top:this.state.top,left:this.state.left},className:"".concat(ne.a.contextMenu," ").concat(t),ref:this.contextRef,children:Object(M.jsx)("ul",{className:"".concat(ne.a.contextMenuUL," ").concat(t," ").concat(a),children:n})})}}]),a}(n.Component),re=Object(A.b)((function(e){return{}}),(function(e){return{closeContextMenu:function(){return e({type:H.a.CLOSE_CONTEXT_MENU})}}}))(oe),ie=a(21),se=a(23),ce=a(49),le=a.n(ce),pe=a(62),ue=a.n(pe),_e=function(e){Object(l.a)(a,e);var t=Object(p.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"getAltitue",value:function(e){return e&&e.z>0?e.z.toFixed(1):0}},{key:"getSpeed",value:function(){var e=parseInt(this.props.airSpeed);return isNaN(e)&&(e=" - ")," - "!==e?"".concat(e):" - "}},{key:"render",value:function(){var e=this.props.dronesPositions&&this.props.dronesPositions[this.props.selectedDrone];return Object(M.jsxs)("div",{className:ue.a.Wrapper,children:[Object(M.jsxs)("span",{className:ue.a.TelemetryWrapper,children:[Object(M.jsx)("span",{children:"Altitude:"}),Object(M.jsxs)("span",{children:[this.getAltitue(e&&e.offset),Object(M.jsx)("span",{className:ue.a.Units,children:"m"})]})]}),Object(M.jsxs)("span",{className:ue.a.TelemetryWrapper,children:[Object(M.jsx)("span",{children:"Speed:"}),Object(M.jsxs)("span",{children:[this.getSpeed(),Object(M.jsx)("span",{className:ue.a.Units,children:"km/h"})]})]})]})}}]),a}(n.Component),de=Object(A.b)((function(e){return{dronesPositions:e.map.dronesPositions,selectedDrone:e.map.selectedDrone,airSpeed:e.layout.airSpeedMap[e.map.selectedDrone]}}),(function(e){return{}}))(_e),Oe=a(96),me=a(19),he=a.n(me),Me=a(18),be=a.p+"static/media/target.66f71b44.svg",Se=a(57),ge=a.n(Se),fe=function(e){Object(l.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).componentDidUpdate=function(e,t){n.state.dragging&&!t.dragging?(document.addEventListener("mousemove",n.onMouseMove),document.addEventListener("mouseup",n.onMouseUp)):!n.state.dragging&&t.dragging&&(document.removeEventListener("mousemove",n.onMouseMove),document.removeEventListener("mouseup",n.onMouseUp))},n.getOffset=function(){var e=n.state.prevOffset+n.state.offset;return e>100?100:e<0?0:e},n.onMouseDown=function(e){n.setState({dragging:!0,startY:e.pageY,prevOffset:n.getOffset(),offset:0}),e.stopPropagation(),e.preventDefault()},n.onMouseUp=function(e){n.setState({dragging:!1}),n.props.updatePosition(n.getOffset()),e.stopPropagation(),e.preventDefault()},n.onMouseMove=function(e){n.state.dragging&&(n.setState({offset:e.pageY-n.state.startY}),e.stopPropagation(),e.preventDefault())},n.onLineClick=function(e){n.setState({offsetY:e.pageY-n.state.prevPos}),e.stopPropagation(),e.preventDefault()},n.sliderLine=o.a.createRef(),n.state={offset:0,prevOffset:n.props.sliderOffset?n.props.sliderOffset:0,dragging:!1,startY:null},n}return Object(c.a)(a,[{key:"render",value:function(){var e=this,t={marginTop:"".concat(this.getOffset(),"px")};return Object(M.jsx)("div",{className:ge.a.sliderWrapper,children:Object(M.jsx)("div",{className:ge.a.mapslider,children:Object(M.jsx)("div",{className:ge.a.buttons,children:Object(M.jsxs)("div",{className:ge.a.dragline,children:[Object(M.jsx)("div",{className:ge.a.line,ref:this.sliderLine,onClick:function(t){return e.onLineClick(t)}}),Object(M.jsx)("div",{className:ge.a.draggablebutton,style:t,onMouseDown:function(t){return e.onMouseDown(t)},onMouseUp:function(t){return e.onMouseUp(t)},onMouseMove:function(t){return e.onMouseMove(t)}})]})})})})}}]),a}(n.Component),Ee=a(53),Ce=function(e){Object(l.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={isImageLoadingError:!1,isImageLoading:!0,isFullScreen:!1,targetPosition:null,showTarget:!0,showExposure:!1,isRecording:!1,randomKey:Math.random()},e.onVideoError=function(t){console.log("error when trying to load camera video",t),e.setState({isImageLoadingError:!0})},e.setTargetPosition=function(){var t=document.getElementById("droneImage");if(t){var a=t.getBoundingClientRect();a&&e.setState({targetPosition:{top:a.top+a.height/2,left:a.left+a.width/2}})}},e.onVideoLoaded=function(t){e.setState({isImageLoading:!1})},e.onPauseOrPlayClick=function(t){t.stopPropagation(),e.props.isPaused?e.props.resume():e.props.pause()},e.onFullScreenClick=function(){var t=document.querySelector("#videoWrapper");t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),e.setState({isFullScreen:!0})},e.onExitFullScreenClick=function(){null===document.fullscreenElement?e.onFullScreenClick():(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),e.setState({isFullScreen:!1}))},e.getRecordButton=function(){return e.props.isRecording?he.a.RecordindIcon:he.a.RecordIcon},e.getRecordTitle=function(){return e.props.isRecording?"Recording":"Start Recording"},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){}},{key:"getVideoSrc",value:function(){console.log("render video",this.props.selectedDrone);var e=ie.a.getConfiguration().DRONES_DATA,t="//".concat(e.segment,".").concat(this.props.selectedDrone,":").concat(e.port),a="".concat(t).concat($.a.urls.videoSnapshot),n="".concat(t).concat($.a.urls.videoStream);return this.props.isPaused?a:n}},{key:"getPlayOrPauseButton",value:function(){return this.props.isPaused?he.a.Play:he.a.Pause}},{key:"getPlayOrPauseTitle",value:function(){return this.props.isPaused?"Play":"Pause"}},{key:"renderVideoHeader",value:function(){var e=this,t=this.state.showTarget?"":he.a.HideTarget;return Object(M.jsxs)("div",{className:"".concat(he.a.VideoHeader),children:[Object(M.jsx)("div",{className:he.a.Description,children:this.props.isPaused?"Video paused":Object(M.jsxs)("span",{className:he.a.StreamingIconWrapper,children:["Video Feed",Object(M.jsx)("span",{className:he.a.StreamingIcon})]})}),Object(M.jsx)("span",{className:"".concat(he.a.Exposure),onClick:function(){return e.setState({showExposure:!e.state.showExposure})}}),this.props.weaponDetected&&Object(M.jsx)("span",{className:"".concat(he.a.ToggleTarget," ").concat(t),onClick:function(){return e.setState({showTarget:!e.state.showTarget})}})]})}},{key:"renderVideoFooter",value:function(){return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)("button",{onClick:this.onPauseOrPlayClick,title:this.getPlayOrPauseTitle(),className:"".concat(he.a.ControlBtn," ").concat(this.getPlayOrPauseButton())}),Object(M.jsx)("button",{onClick:this.props.toggleIsRecording,title:this.getRecordTitle(),className:"".concat(he.a.ControlBtn," ").concat(he.a.RecordButton),children:Object(M.jsx)("span",{className:"".concat(this.getRecordButton())})}),Object(M.jsx)("button",{onClick:this.state.isFullScreen?this.onExitFullScreenClick:this.onFullScreenClick,title:this.state.isFullScreen?"Exit Full Screen":"Full Screen",className:"".concat(he.a.ControlBtn," ").concat(this.state.isFullScreen?he.a.ExitFullScreen:he.a.FullScreen)})]})}},{key:"updateExposure",value:function(e){var t=$.a.EXPOSURE_MAX_LEVEL*(100-e)/100;console.log("new exposureValue is ",t),this.setState({sliderOffset:e}),this.props.setExposure(t)}},{key:"renderImgElement",value:function(){var e=this;if(this.state.isImageLoadingError)return Object(M.jsxs)("div",{className:he.a.ErrorMessage,children:[Object(M.jsx)("span",{className:he.a.ErrorIcon})," Error loading video stream"]});var t=this.state.isFullScreen?" ".concat(he.a.TargetLarge):"";return Object(M.jsxs)(M.Fragment,{children:[this.renderVideoHeader(),this.state.showTarget&&this.props.weaponDetected&&Object(M.jsx)("img",{className:"".concat(he.a.TargetIcon).concat(t),style:this.state.targetPosition,src:be}),this.state.showExposure&&Object(M.jsx)(fe,{sliderOffset:this.state.sliderOffset,updatePosition:function(t){return e.updateExposure(t)}}),Object(M.jsx)("img",{crossOrigin:"anonymous",onLoad:this.onVideoLoaded,className:he.a.VideoImage,src:this.getVideoSrc(),onError:function(){return setTimeout((function(){e.setState({randomKey:Math.random()})}),3e3)},id:"droneImage",onClick:this.props.pointVideoImage},this.props.selectedDrone+this.state.randomKey),this.renderVideoFooter()]})}},{key:"render",value:function(){var e=this.props.appPrimaryUiElement===Ee.a.tabs?he.a.Fixed:"",t=this.state.isImageLoadingError||this.state.isImageLoading?he.a.FullHeight:"";return Object(M.jsx)("div",{className:"".concat(he.a.Wrapper," ").concat(t," ").concat(e),id:"videoWrapper",children:this.renderImgElement()})}}]),a}(n.Component),ve=Object(A.b)((function(e){return{isPaused:e.video.isPaused,weaponDetected:e.output.weaponDetected,selectedDrone:e.map.selectedDrone,appPrimaryUiElement:e.layout.appPrimaryUiElement,isRecording:e.video.isRecording}}),(function(e){return{pointVideoImage:function(t){return e(Me.a.pointVideoImage(t))},setExposure:function(t){return e(Me.a.setExposure(t))},pause:function(){return e({type:H.a.PAUSE_VIDEO})},resume:function(){return e({type:H.a.RESUME_VIDEO})},toggleIsRecording:function(){return e(Me.a.toggleIsRecording())}}}))(Ce),we=a(16),Te=a.n(we),De=(a.p,a.p+"static/media/EnemySpotted.efd0437a.mp3"),ye=a.p+"static/media/armedRed.91c4decb.svg",Ie=a(20),Pe=function(e){Object(l.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onImageLoaded=function(e){if(n.props.imageSentToDroneData&&n.props.imageSentToDroneData.point){var t=document.getElementById("tabs-wrapper"),a=e.target,o=a.naturalWidth/t.getBoundingClientRect().width,r=a.naturalHeight/t.getBoundingClientRect().height,i=n.props.imageSentToDroneData.point,s=i.roundedX,c=i.roundedY;n.setState({pointPosition:{top:c/r,left:s/o}})}else console.log("Error, this.props.imageSentToDroneData.point as it is undefined")},n.onToggleTabClick=function(e){n.setState({selectedTab:e})},n.renderTabsToggle=function(){var e=n.state.selectedTab;return Object(M.jsx)(M.Fragment,{children:Object(M.jsx)("div",{className:Te.a.tabslidernav,children:Object(M.jsxs)("ul",{className:Te.a.tabslidertabs,children:[Object(M.jsx)("li",{className:"".concat(Te.a.tabslidertrigger," ").concat("Capture"==e?Te.a.TabSelected:""),onClick:function(){return n.onToggleTabClick("Capture")},children:"Capture"}),Object(M.jsx)("li",{className:"".concat(Te.a.tabslidertrigger," ").concat("Skeleton"==e?Te.a.TabSelected:""),onClick:function(){return n.onToggleTabClick("Skeleton")},children:"Skeleton"}),Object(M.jsx)("li",{className:"".concat(Te.a.tabslidertrigger," ").concat("WindowDetection"==e?Te.a.TabSelected:""),onClick:function(){return n.onToggleTabClick("WindowDetection")},children:"Window"}),Object(M.jsx)("li",{className:"".concat(Te.a.tabslidertrigger," ").concat("Occupancy"==e?Te.a.TabSelected:""),onClick:function(){return n.onToggleTabClick("Occupancy")},children:"Occupancy"})]})})})},n.state={pointPosition:null,showCapture:!0,selectedTab:"WindowDetection",randomKey:Math.random()},n.EnemySpotted=new Audio(De),n}return Object(c.a)(a,[{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onImageLoaded())}},{key:"componentDidUpdate",value:function(e,t){var a=this;if(e.imageSentToDroneData!==this.props.imageSentToDroneData){var n=document.createElement("img");n.onload=this.onImageLoaded,n.src=this.props.imageSentToDroneData.image,window.addEventListener("resize",(function(){return a.onImageLoaded({target:n})}))}e.weaponDetected!==this.props.weaponDetected&&(this.EnemySpotted.play(),this.onToggleTabClick("Skeleton")),("N/A"===e.skeletonRange&&"N/A"!==this.props.skeletonRange||!e.indoorExplorationFlag&&this.props.indoorExplorationFlag)&&this.onToggleTabClick("Skeleton"),this.state.selectedTab!=t.selectedTab&&this.setState({randomKey:Math.random()}),"Occupancy"===this.props.selectedTab&&(this.props.selectedDrone,e.selectedDrone)}},{key:"renderTabs",value:function(){var e=null,t=null,a=this.props.imageSentToDroneData&&this.props.imageSentToDroneData.image,n=this.props.imageSentToDroneData&&this.props.imageSentToDroneData.point;return a&&n&&(e=Object(M.jsx)("img",{className:Te.a.OutputImage,src:a}),t=Object(M.jsx)("div",{className:Te.a.Point,style:this.state.pointPosition})),Object(M.jsxs)(M.Fragment,{children:[e,t]})}},{key:"renderNoOutputReceived",value:function(){return Object(M.jsxs)("div",{className:Te.a.ErrorMessage,children:[Object(M.jsx)("span",{className:Te.a.ErrorIcon})," No output has been received yet"]})}},{key:"getCaptureTab",value:function(){return this.props.imageSentToDroneData?this.renderTabs():this.renderNoOutputReceived()}},{key:"getSkeletonRange",value:function(){return this.props.skeletonRange&&"N/A"!==this.props.skeletonRange?"".concat(this.props.skeletonRange," m"):this.props.skeletonRange}},{key:"getSkeletonTab",value:function(){var e=this,t=this.props.weaponDetected?Te.a.WeaponDetected:void 0;return Object(M.jsxs)("div",{className:"".concat(Te.a.SkeletonTab," ").concat(t),children:[Object(M.jsx)("img",{crossOrigin:"anonymous",onError:function(){return setTimeout((function(){e.setState({randomKey:Math.random()})}),3e3)},className:Te.a.VideoImage,src:this.getSkeletonVideoSrc(),id:"droneImage"},"skeleton"+this.props.selectedDrone+this.state.randomKey),this.props.weaponDetected&&Object(M.jsx)("img",{className:"".concat(Te.a.AlertIcon),src:ye}),this.props.skeletonRange&&Object(M.jsxs)("span",{className:"".concat(Te.a.SkeletonRange),children:[" ",this.getSkeletonRange()," "]})]})}},{key:"getWindowDetectionTab",value:function(){var e=this;return Object(M.jsxs)("div",{className:"".concat(Te.a.WindowTab),children:[Object(M.jsx)("img",{crossOrigin:"anonymous",onError:function(){return setTimeout((function(){e.setState({randomKey:Math.random()})}),3e3)},className:Te.a.VideoImage,src:this.getWindowDetectionVideoSrc(),id:"droneImage"},"window"+this.props.selectedDrone+this.state.randomKey),Object(M.jsx)("span",{className:"".concat(Te.a.AlertIcon)})]})}},{key:"getOccupancyTab",value:function(){var e=this;return Object(M.jsxs)("div",{className:"".concat(Te.a.WindowTab),children:[Object(M.jsx)("img",{crossOrigin:"anonymous",onError:function(){return setTimeout((function(){e.setState({randomKey:Math.random()})}),3e3)},className:"".concat(Te.a.VideoImage," ").concat(Te.a.Occupancy),src:this.geOccupancyDetectionSrc()},"Occupancy"+this.props.selectedDrone+this.state.randomKey),Object(M.jsx)("span",{className:"".concat(Te.a.AlertIcon)})]})}},{key:"getWindowDetectionVideoSrc",value:function(){var e=ie.a.getConfiguration().DRONES_DATA,t="//".concat(e.segment,".").concat(this.props.selectedDrone,":").concat(e.port),a="".concat(t).concat($.a.urls.windowDetectionSnapshot),n="".concat(t).concat($.a.urls.windowDetectionStream);return this.props.isPaused?a:n}},{key:"geOccupancyDetectionSrc",value:function(){var e=ie.a.getConfiguration().DRONES_DATA,t="//".concat(e.segment,".").concat(this.props.selectedDrone,":").concat(e.port);return"".concat(t).concat($.a.urls.mapImageStream)}},{key:"getSkeletonVideoSrc",value:function(){var e=ie.a.getConfiguration().DRONES_DATA,t="//".concat(e.segment,".").concat(this.props.selectedDrone,":").concat(e.port),a="".concat(t).concat($.a.urls.skeletonSnapshot),n="".concat(t).concat($.a.urls.skeletonStream);return this.props.isPaused?a:n}},{key:"getSelectedTab",value:function(){switch(this.state.selectedTab){case"Capture":return this.getCaptureTab();case"Skeleton":return this.getSkeletonTab();case"Occupancy":return this.getOccupancyTab();case"WindowDetection":return this.getWindowDetectionTab();default:return""}}},{key:"render",value:function(){var e=this.props.appPrimaryUiElement===Ee.a.tabs?Te.a.Enlarge:"";return Object(M.jsxs)("div",{className:"".concat(Te.a.Wrapper," ").concat(e),children:[this.renderTabsToggle(),Object(M.jsx)("div",{className:Te.a.Tabs,id:"tabs-wrapper",children:this.getSelectedTab()})]})}}]),a}(n.Component),je=Object(A.b)((function(e){return{tabs:e.video.tabs,imageSentToDroneData:e.layout.imageSentToDroneData,skeletonRange:e.output.skeletonRange,weaponDetected:e.output.weaponDetected,indoorExplorationFlag:e.output.indoorExplorationFlag,selectedDrone:e.map.selectedDrone,appPrimaryUiElement:e.layout.appPrimaryUiElement}}),(function(e){return{}}))(Pe),xe=a(13),Le=a.n(xe),Ae=a(58),Ne=a(74),Re=a.n(Ne),ke=function(e){Object(l.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onToggleClick=n.onToggleClick.bind(Object(Ae.a)(n)),n}return Object(c.a)(a,[{key:"onToggleClick",value:function(e){e&&e.preventDefault(),this.props.onClick&&this.props.onClick()}},{key:"render",value:function(){return Object(M.jsxs)("label",{htmlFor:this.props.id,className:Re.a.switch,onClick:this.onToggleClick,children:[Object(M.jsx)("input",{type:"checkbox",className:Re.a.Input,checked:this.props.isChecked}),Object(M.jsx)("span",{className:Re.a.sliderRound})]})}}]),a}(n.Component),Be=function(e){Object(l.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).goToLocation=function(){var t={title:"Go To Location",modalChild:"SingleInputForm",modalChildProps:{size:"small",label:"Set Location:",placeHolder:"x,y,z",onValueChange:function(t){return e.tempLocationValue=t}},onCloseButtonClick:function(){e.tempLocationValue=null},primayButton:{title:"Go",callback:e.onGoToLocationPopupOkBtnClick},secondaryButton:{title:"Cancel",callback:function(){e.tempLocationValue=null}}};e.props.showPopup(t)},e.onGoToLocationPopupOkBtnClick=function(){e.tempLocationValue?e.props.goToLocation(e.tempLocationValue):e.tempLocationValue=null},e}return Object(c.a)(a,[{key:"getPauseIcon",value:function(){return this.props.isPaused?Le.a.PlayIcon:Le.a.PauseIcon}},{key:"render",value:function(){var e=this.props.isRosWebsocketConncted?"":Le.a.Hidden;return Object(M.jsxs)("div",{className:"".concat(Le.a.Wrapper," ").concat(e),children:[Object(M.jsxs)("button",{className:Le.a.Button,onClick:this.props.toggleIsArmed,children:[Object(M.jsx)(ke,{isChecked:this.props.isArmed}),Object(M.jsx)("span",{className:Le.a.ButtonLabel,children:"Arm"})]}),Object(M.jsxs)("button",{className:Le.a.Button,onClick:this.props.takeoff,children:[Object(M.jsx)("span",{className:Le.a.IconWithArrow,children:Object(M.jsx)("span",{className:"".concat(Le.a.Icon," ").concat(Le.a.TakeoffIcon)})}),Object(M.jsx)("span",{className:Le.a.ButtonLabel,children:"Takeoff"})]}),Object(M.jsxs)("button",{className:Le.a.Button,onClick:this.props.land,children:[Object(M.jsxs)("span",{className:Le.a.IconWithArrow,children:[Object(M.jsx)("span",{className:"".concat(Le.a.Icon," ").concat(Le.a.TakeoffIcon)}),Object(M.jsx)("span",{className:"".concat(Le.a.Icon," ").concat(Le.a.ArrowDownIcon)})]}),Object(M.jsx)("span",{className:Le.a.ButtonLabel,children:"Land"})]}),Object(M.jsxs)("button",{className:"".concat(Le.a.Button," ").concat(this.props.indoorExplorationFlag?Le.a.Clicked:""),onClick:this.props.startIndoorExploration,children:[Object(M.jsx)("span",{className:"".concat(Le.a.Icon," ").concat(Le.a.IndoorExploration)}),Object(M.jsx)("span",{className:Le.a.ButtonLabel,children:"Indoor \nExploration"})]}),Object(M.jsxs)("button",{className:Le.a.Button,onClick:this.props.locate,children:[Object(M.jsx)("span",{className:"".concat(Le.a.Icon," ").concat(Le.a.LocateIcon)}),Object(M.jsx)("span",{className:Le.a.ButtonLabel,children:"Locate"})]}),Object(M.jsxs)("button",{className:Le.a.Button,onClick:this.goToLocation,children:[Object(M.jsx)("span",{className:"".concat(Le.a.Icon," ").concat(Le.a.SetLocationIcon)}),Object(M.jsx)("span",{className:Le.a.ButtonLabel,children:"Go To"})]}),Object(M.jsxs)("button",{className:Le.a.Button,onClick:this.props.reset,children:[Object(M.jsx)("span",{className:"".concat(Le.a.Icon," ").concat(Le.a.ResetIcon)}),Object(M.jsx)("span",{className:Le.a.ButtonLabel,children:"Reset"})]}),this.props.savedMissionPlan.length?Object(M.jsxs)("button",{className:Le.a.Button,onClick:this.props.runSavedMissionPlan,children:[Object(M.jsx)("span",{className:"".concat(Le.a.Icon," ").concat(Le.a.RunPlanIcon)}),Object(M.jsx)("span",{className:Le.a.ButtonLabel,children:"Run Saved Plan"})]}):null]})}}]),a}(n.Component),We=Object(A.b)((function(e){return{isPaused:e.video.isPaused,isRosWebsocketConncted:e.layout.isRosWebsocketConncted,indoorExplorationFlag:e.output.indoorExplorationFlag,savedMissionPlan:e.planner.savedMissionPlan,isArmed:e.output.isArmed}}),(function(e){return{takeoff:function(){return e(Me.a.takeoff())},land:function(){return e(Me.a.land())},startIndoorExploration:function(){return e(Me.a.startIndoorExploration())},locate:function(){return e(Me.a.locate())},restart:function(){return e(Me.a.restart())},showPopup:function(t){return e({type:H.a.SHOW_POPUP,payload:t})},goToLocation:function(t){return e(Me.a.goToLocation(t))},runSavedMissionPlan:function(){return e(Me.a.runSavedMissionPlan())},toggleIsArmed:function(){return e(Me.a.toggleIsArmed())}}}))(Be),Ve=function(e){Object(l.a)(a,e);var t=Object(p.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"getMainLeftPane",value:function(){return Object(M.jsx)(Oe.a,{})}},{key:"getSecondaryAppUiElement",value:function(){return Object(M.jsx)(je,{})}},{key:"getMainRightPane",value:function(){return Object(M.jsxs)("div",{className:le.a.RightPaneWrapper,children:[Object(M.jsx)("div",{className:le.a.RightPaneWrapperItem,children:Object(M.jsx)(ve,{})}),Object(M.jsx)("div",{className:le.a.RightPaneWrapperItem,children:this.getSecondaryAppUiElement()})]})}},{key:"getActionButtons",value:function(){return Object(M.jsx)(We,{})}},{key:"render",value:function(){return Object(M.jsxs)("div",{className:"".concat(le.a.MainContentWrapper),children:[Object(M.jsx)("div",{className:"".concat(le.a.Split," ").concat(le.a.Left),children:this.getMainLeftPane()}),Object(M.jsx)("div",{className:"".concat(le.a.Split," ").concat(le.a.Right),children:this.getMainRightPane()}),this.getActionButtons(),Object(M.jsx)(de,{})]})}}]),a}(n.Component),Fe=a(46),Ge=a(15),Ue=a.n(Ge),He=a(33),Ke=a.n(He),ze=a(22),Xe=function(e){Object(l.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).addOrEditMissionPlanStageFormPopupOkBtnClick=function(t){var a=e.getAddMissionPlanStageFormState();a.selectedStageType&&(t?e.props.addNewStage(a):e.props.editStage(a,e.props.stageIndex))},e.onAddOrEditStageBtnClicked=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a={title:t?"Add New Stage":"Edit Stage #".concat(e.props.stageIndex+1," "),modalChild:"AddMissionPlanStageForm",modalChildProps:{stage:t?null:e.props.stage,size:"small",onPopupInitalLoad:function(t){return e.getAddMissionPlanStageFormState=t},selectPointFromMap:e.props.togglePointSelectionMode,getDronePosition:e.props.dronesPositions[e.props.selectedDrone]&&e.props.dronesPositions[e.props.selectedDrone].offset?e.getDronePosition:void 0},onCloseButtonClick:function(){},primayButton:{title:"Done",callback:function(){return e.addOrEditMissionPlanStageFormPopupOkBtnClick(t)}},secondaryButton:{title:"Cancel",callback:function(){}}};e.props.showPopup(a)},e.getDronePosition=function(){var t=e.props.dronesPositions[e.props.selectedDrone],a=null;t&&t.offset&&(a=ze.e(t.workingOrigin,t.offset),e.props.setPositionToPopup(a))},e.onMenuBtnClick=function(t){t.preventDefault(),t.stopPropagation();var a=[{name:"Delete",func:function(){return e.props.deleteStage(e.props.stage.stageId)},iconCss:"DeleteIcon"},{name:"Edit",func:e.onAddOrEditStageBtnClicked,iconCss:"EditIcon"},{name:"Move Back",func:function(){return e.props.moveStageDown(e.props.stageIndex)},iconCss:"ArrowDownIcon"},{name:"Move Forward",func:function(){return e.props.moveStageUp(e.props.stageIndex)},iconCss:"ArrowUpIcon"}];e.props.showContextMenu(t.clientX,t.clientY,{side:"left"},a)},e}return Object(c.a)(a,[{key:"renderMenuBtnIcon",value:function(){return Object(M.jsxs)("span",{className:Ke.a.BtnIconWrapper,children:[Object(M.jsx)("span",{className:Ke.a.BtnIconBall}),Object(M.jsx)("span",{className:Ke.a.BtnIconBall}),Object(M.jsx)("span",{className:Ke.a.BtnIconBall})]})}},{key:"renderAddNewStageBtn",value:function(){var e=this;return!!this.props.isShowAddStageBtn&&Object(M.jsx)("button",{className:Ke.a.AddNewStageBtn,onClick:function(){return e.onAddOrEditStageBtnClicked(!0)},children:"+"})}},{key:"renderMenuBtn",value:function(){return this.props.isShowMenu?Object(M.jsx)("button",{className:Ke.a.MenuBtn,onClick:this.onMenuBtnClick,children:this.renderMenuBtnIcon()}):null}},{key:"render",value:function(){var e=this.props.stage,t=e.selectedStageType,a=e.stageParamsInput,n=a;if("Go To Waypoint"==t.label&&a){var o=a.split(","),r=Object(V.a)(o,3),i=r[0],s=r[1],c=r[2];n="x: ".concat(i.split(".")[0],"\ny: ").concat(s.split(".")[0],"\nz: ").concat(c.split(".")[0])}return Object(M.jsxs)("div",{className:Ke.a.StageWrapper,style:this.props.isShowMenu?{opacity:.6}:{},children:[this.renderMenuBtn(),Object(M.jsxs)("div",{className:Ke.a.LabelsWrapper,children:[Object(M.jsx)("div",{className:Ke.a.StageTypeLabel,children:t.label}),Object(M.jsx)("div",{className:Ke.a.StageParamsLabel,children:n})]}),this.renderAddNewStageBtn()]})}}]),a}(n.Component),Ye=Object(A.b)((function(e){return{dronesPositions:e.map.dronesPositions,selectedDrone:e.map.selectedDrone}}),(function(e){return{showPopup:function(t){return e({type:H.a.SHOW_POPUP,payload:t})},togglePointSelectionMode:function(){return e({type:H.a.TOGGLE_POINT_SELECTION_MODE})},showContextMenu:function(t,a,n,o){return e({type:H.a.SHOW_CONTEXT_MENU,payload:{x:t,y:a,options:n,items:o}})},deleteStage:function(t){return e({type:H.a.DELETE_MISSION_PLAN_STAGE,payload:{id:t}})},editStage:function(t,a){return e({type:H.a.EDIT_MISSION_PLAN_STAGE,payload:{stage:t,stageIndex:a}})},moveStageDown:function(t){return e({type:H.a.MOVE_DOWN_MISSION_PLAN_STAGE,payload:t})},moveStageUp:function(t){return e({type:H.a.MOVE_UP_MISSION_PLAN_STAGE,payload:t})},addNewStage:function(t){return e({type:H.a.ADD_NEW_MISSION_PLAN_STAGE,payload:t})},setPositionToPopup:function(t){return e({type:H.a.SELECT_POINT_FROM_MAP,payload:{position:t}})}}}))(Xe),qe=function(e){Object(l.a)(a,e);var t=Object(p.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"renderArrow",value:function(){return Object(M.jsx)("div",{className:Ke.a.Arrow})}},{key:"render",value:function(){var e=this,t=this.props.missionStages,a=this.props.isReadOnly;return Object(M.jsx)("div",{className:Ke.a.MissionStagesWrapper,children:t.map((function(n,r){return Object(M.jsxs)(o.a.Fragment,{children:[Object(M.jsx)(Ye,{stageIndex:r,stage:n,isShowAddStageBtn:!a&&r===t.length-1,isShowMenu:!a}),r!==t.length-1?e.renderArrow():null]},n.stageId)}))})}}]),a}(n.Component),Je=a(26),Ze=function(e){Object(l.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).inputRef=o.a.createRef(),e.addMissionPlanStageFormPopupOkBtnClick=function(){var t=e.getAddMissionPlanStageFormState();t&&t.selectedStageType&&e.props.addNewStage(t)},e.onStartNewMissionClick=function(){var t={title:"Add First Stage",modalChild:"AddMissionPlanStageForm",modalChildProps:{size:"small",onPopupInitalLoad:function(t){return e.getAddMissionPlanStageFormState=t},selectPointFromMap:e.props.togglePointSelectionMode,getDronePosition:e.props.dronesPositions[e.props.selectedDrone]&&e.props.dronesPositions[e.props.selectedDrone].offset?e.getDronePosition:void 0},onCloseButtonClick:function(){},primayButton:{title:"Add",disabled:!1,callback:e.addMissionPlanStageFormPopupOkBtnClick},secondaryButton:{title:"Cancel",callback:function(){}}};e.props.showPopup(t)},e.getDronePosition=function(){var t=e.props.dronesPositions[e.props.selectedDrone],a=null;t&&t.offset&&(a=ze.e(t.workingOrigin,t.offset),e.props.setPositionToPopup(a))},e.onBackBtnClick=function(){e.props.toggleMissionPlannerScreen()},e.onSaveBtnClick=function(){e.props.saveMissionPlan(),e.props.toggleViewerState(),e.props.showGlobalMessage("Draft Successfuly Saved")},e.onClearDraftBtnClick=function(){e.props.removeDraftPlan()},e.onRemoveSavedPlanBtnClick=function(){e.props.removeSavedPlan(),e.props.showGlobalMessage("Mission Plan Successfuly Removed")},e.onLoadMissionFromDroneBtnClick=function(){e.props.importMissionFromDroneFile()},e.onLoadMissionFromPcBtnClick=function(){e.inputRef.current.click()},e.parseConfigurationFile=function(t){var a=new FileReader;t.target.files&&t.target.files[0]&&(console.log("Reading file: "+t.target.files[0]),a.readAsText(t.target.files[0],"UTF-8"),a.onload=function(t){var a=JSON.parse(t.target.result);e.props.importMissionFromPcFile(a)},a.onerror=function(e){console.log("parseConfigurationFile: error reading file")})},e.onExportMissionBtnClick=function(){var t=e.props,a=t.draftMissionStages,n=t.savedMissionPlan,o=t.viewerState,r=o===Je.b.draft?a:n;e.props.exportPlanToFile(r,o)},e.onLoadMissionBtnClick=function(t){t.preventDefault(),t.stopPropagation();var a=[{name:"Load From PC",func:e.onLoadMissionFromPcBtnClick,iconCss:"PcIcon"},{name:"Load From Drone",func:e.onLoadMissionFromDroneBtnClick,iconCss:"DroneIcon"}];e.props.showContextMenu(t.clientX,t.clientY,{side:"left"},a)},e.onSwitchViewStateClick=function(t){t.preventDefault(),e.props.toggleViewerState()},e}return Object(c.a)(a,[{key:"renderStartNewMissionButton",value:function(){return Object(M.jsx)("button",{className:Ue.a.StartNewBtn,onClick:this.onStartNewMissionClick,children:"Start New Mission Plan"})}},{key:"renderMissionPlanStages",value:function(){var e=this.props,t=e.viewerState,a=e.draftMissionStages,n=e.savedMissionPlan;return t===Je.b.draft?a.length?Object(M.jsx)(qe,{missionStages:t===Je.b.draft?a:n,isReadOnly:t===Je.b.savedMission}):this.renderStartNewMissionButton():n.length>0?Object(M.jsx)(qe,{missionStages:t===Je.b.draft?a:n,isReadOnly:t===Je.b.savedMission}):Object(M.jsx)("div",{className:Ue.a.EmptyPlanStagesMessage,children:"No Saved Plan in Memory"})}},{key:"renderDraftButtons",value:function(e){var t=this,a=[];return e.length>0&&(a.push(Object(M.jsx)("button",{title:"Save Plan",className:"".concat(Ue.a.SideBarBtn," ").concat(Ue.a.Save),onClick:this.onSaveBtnClick})),a.push(Object(M.jsx)("button",{title:"Clear Draft Stages",className:"".concat(Ue.a.SideBarBtn," ").concat(Ue.a.ClearStages),onClick:this.onClearDraftBtnClick})),a.push(Object(M.jsx)("button",{title:"Download Draft",className:"".concat(Ue.a.SideBarBtn," ").concat(Ue.a.Export),onClick:this.onExportMissionBtnClick}))),a.push(Object(M.jsx)("button",{title:"Load Mission Plan",className:"".concat(Ue.a.SideBarBtn," ").concat(Ue.a.Import),onClick:function(e){return t.onLoadMissionBtnClick(e)}})),a}},{key:"renderSavedPlanButtons",value:function(e){var t=[];return e.length>0&&(t.push(Object(M.jsx)("button",{title:"Remove Saved Plan",className:"".concat(Ue.a.SideBarBtn," ").concat(Ue.a.Remove),onClick:this.onRemoveSavedPlanBtnClick})),t.push(Object(M.jsx)("button",{title:"Download Saved Plan",className:"".concat(Ue.a.SideBarBtn," ").concat(Ue.a.Export),onClick:this.onExportMissionBtnClick}))),t.push(Object(M.jsx)("button",{title:"Load Mission Plan From File",className:"".concat(Ue.a.SideBarBtn," ").concat(Ue.a.Import),onClick:this.onLoadMissionBtnClick})),t}},{key:"renderSideBar",value:function(){var e=this.props,t=e.draftMissionStages,a=e.savedMissionPlan,n=e.viewerState,o=[Object(M.jsx)("button",{title:"Back to Main",className:"".concat(Ue.a.SideBarBtn," ").concat(Ue.a.ClosePlanner),onClick:this.onBackBtnClick})];return n===Je.b.draft?o.push.apply(o,Object(Fe.a)(this.renderDraftButtons(t))):o.push.apply(o,Object(Fe.a)(this.renderSavedPlanButtons(a))),Object(M.jsxs)("div",{className:Ue.a.SideBar,children:[Object(M.jsx)("div",{className:Ue.a.SideBarButtons,children:o}),Object(M.jsx)("span",{className:Ue.a.SidebarLabel,children:"Mission Planner"})]})}},{key:"getSwithBtnTitle",value:function(e){return"View ".concat(e===Je.b.draft?"Saved Mission":"Draft Mission")}},{key:"renderHeader",value:function(){var e=this.props.viewerState;e===Je.b.draft?" ".concat(Ue.a.DraftIcon):" ".concat(Ue.a.SavedPlanIcon);return Object(M.jsxs)("div",{className:Ue.a.Header,children:[Object(M.jsx)("span",{}),Object(M.jsxs)("span",{className:Ue.a.HeaderTextWrapper,children:[Object(M.jsx)("span",{className:Ue.a.HeaderTextState,children:e===Je.b.draft?"Mission Draft":"Saved Mission"}),Object(M.jsx)("a",{href:"#",className:Ue.a.HeaderBtnWrapper,onClick:this.onSwitchViewStateClick,title:this.getSwithBtnTitle(e),children:Object(M.jsx)("span",{className:Ue.a.HeaderBtn})})]})]})}},{key:"render",value:function(){var e=this,t=this.props.draftMissionStages.length?"":Ue.a.Center;return Object(M.jsxs)(M.Fragment,{children:[this.renderSideBar(),Object(M.jsxs)("div",{className:"".concat(Ue.a.Wrapper," ").concat(t),children:[this.renderHeader(),this.renderMissionPlanStages()]}),Object(M.jsx)("input",{type:"file",style:{display:"none"},accept:"application/json",ref:this.inputRef,onChange:function(t){return e.parseConfigurationFile(t)}})]})}}]),a}(n.Component),Qe=Object(se.d)(Object(A.b)((function(e){return{draftMissionStages:e.planner.draftMissionStages,savedMissionPlan:e.planner.savedMissionPlan,viewerState:e.planner.viewerState,dronesPositions:e.map.dronesPositions,selectedDrone:e.map.selectedDrone}}),(function(e){return{showPopup:function(t){return e({type:H.a.SHOW_POPUP,payload:t})},showGlobalMessage:function(t){return e(Me.a.showGlobalMessage({text:t,type:$.b.success,isRemoved:!0}))},addNewStage:function(t){return e({type:H.a.ADD_NEW_MISSION_PLAN_STAGE,payload:t})},toggleMissionPlannerScreen:function(){return e({type:H.a.TOGGLE_MISSION_PLANNER_SCREEN})},saveMissionPlan:function(){return e({type:H.a.SAVE_MISSION_PLAN})},removeDraftPlan:function(){return e({type:H.a.REMOVE_DRAFT_MISSION_PLAN})},removeSavedPlan:function(){return e({type:H.a.REMOVE_SAVED_MISSION_PLAN})},toggleViewerState:function(){return e({type:H.a.TOGGLE_MISSION_PLAN_VIEWER_STATE})},importMissionFromDroneFile:function(){return e(Me.a.importMissionFromDroneFile())},importMissionFromPcFile:function(t){return e(Me.a.importMissionFromPcFile(t))},exportPlanToFile:function(t,a){return e(Me.a.exportPlanToFile(t,a))},togglePointSelectionMode:function(){return e({type:H.a.TOGGLE_POINT_SELECTION_MODE})},showContextMenu:function(t,a,n,o){return e({type:H.a.SHOW_CONTEXT_MENU,payload:{x:t,y:a,options:n,items:o}})},setPositionToPopup:function(t){return e({type:H.a.SELECT_POINT_FROM_MAP,payload:{position:t}})}}}))(Ze)),$e={container:function(e,t){return Object(u.a)(Object(u.a)({},e),{},{cursor:t.isDisabled?"not-allowed":"pointer",width:"100%"})},option:function(e,t){return Object(u.a)(Object(u.a)({},e),{},{"&:hover":{backgroundColor:"var(--app-select-hover-color)"},color:t.data.color,fontSize:"var(--app-font-size)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",backgroundColor:"transparent",border:t.isSelected?"1px solid var(--app-select-selected-border-color)":"none",cursor:t.isDisabled?"not-allowed":"pointer"})},control:function(e,t){return Object(u.a)(Object(u.a)({},e),{},{borderRadius:"2px",backgroundColor:"transparent",minHeight:"unset",borderColor:"transparent",color:"var(--app-font-color)",boxShadow:(t.isFocused,0),"&:hover":{},cursor:t.isDisabled?"not-allowed":"pointer"})},menu:function(e){return Object(u.a)(Object(u.a)({},e),{},{backgroundColor:"var(--app-bg-color-alt)"})},valueContainer:function(e){return Object(u.a)(Object(u.a)({},e),{},{fontSize:"var(--app-font-size)"})},indicatorSeparator:function(e){return Object(u.a)(Object(u.a)({},e),{},{display:"none"})},dropdownIndicator:function(e){return Object(u.a)(Object(u.a)({},e),{},{color:"black"})},singleValue:function(e,t){var a=t.data;return Object(u.a)(Object(u.a)({},e),{},{fontSize:"18px",fontWeight:500,color:a.color})},placeholder:function(e){return Object(u.a)(Object(u.a)({},e),{},{fontWeight:500,color:"var(--app-font-color)"})},noOptionsMessage:function(e){return Object(u.a)(Object(u.a)({},e),{},{fontWeight:400,color:"var(--app-font-color)",fontSize:"var(--app-font-size)"})},input:function(e){return Object(u.a)(Object(u.a)({},e),{},{color:"var(--app-font-color)"})}},et=["aqua","green","orange"],tt=function(e){Object(l.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).disableZoomInTouchScreen=function(e){e.touches.length>1&&e.preventDefault()},e.handleTypeChange=function(t){e.props.selectDrone(t.label)},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){window.MapCore.SetStartCallbackFunction(this.props.setMapCoreSDKLoadedFlag);var e=ie.a.getConfiguration().streamingLayers[0];this.props.setMapToShow(e),window.addEventListener("touchstart",this.disableZoomInTouchScreen,{passive:!1})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("touchstart",this.disableZoomInTouchScreen)}},{key:"getClock",value:function(){return Object(M.jsx)(f,{})}},{key:"formatPosition",value:function(e){return null===e||void 0===e?null:Math.round(e)}},{key:"renderDroneSelect",value:function(){var e=this,t=ie.a.getConfiguration().DRONES_DATA.dronesList.map((function(e,t){return{label:e,color:et[t]}})),a={styles:$e,defaultValue:t[0],options:t,onChange:function(t){return e.handleTypeChange(t)}};return Object(M.jsx)("div",{className:O.a.Row,children:Object(M.jsx)(y,Object(u.a)({},a))})}},{key:"getBatteyIcon",value:function(e){switch(!0){case"N/A"===e:return"";case e<30:return O.a.BatteryIconEmpty;case e<80:return O.a.BatteryIconHalf;default:return O.a.BatteryIconFull}}},{key:"getBatteryTextColor",value:function(e){if("N/A"!==e&&e<30)return O.a.EmptyBatteryColor}},{key:"getBatteyData",value:function(){var e=parseInt(this.props.batteryLevel);isNaN(e)&&(e="N/A");var t="N/A"!==e?"".concat(e,"%"):"N/A";return Object(M.jsxs)("span",{className:O.a.HeaderItem,children:[Object(M.jsx)("span",{className:"".concat(O.a.Icon," ").concat(this.getBatteyIcon(e))}),Object(M.jsx)("span",{className:"".concat(O.a.BatteryValue," ").concat(this.getBatteryTextColor(e)),children:"".concat(t)})]})}},{key:"getMainHeader",value:function(){var e=this,t=this.props.dronesPositions[this.props.selectedDrone],a=null,n=null;t&&t.offset&&(a=ze.g(t.offset),n=ze.e(t.workingOrigin,t.offset));var o=et[0],r=ie.a.getConfiguration().DRONES_DATA.dronesList;return 1==r.indexOf(this.props.selectedDrone)?o=et[1]:2==r.indexOf(this.props.selectedDrone)&&(o=et[2]),Object(M.jsxs)("header",{className:O.a.AppHeader,style:{borderBottomColor:o},children:[Object(M.jsxs)("div",{className:O.a.LogoWrapper,onClick:function(){return e.props.history.push("/")},children:[Object(M.jsx)("img",{src:_,alt:"logo"}),Object(M.jsx)("span",{className:O.a.VersionText,children:"version: 21.06.09 "})]}),Object(M.jsxs)("div",{className:O.a.HeaderLeftWrapper,children:[Object(M.jsxs)("span",{className:"".concat(O.a.HeaderItem," ").concat(O.a.DroneSelectItem),style:{borderRightColor:o,borderLeftColor:o},children:[Object(M.jsx)("span",{style:{backgroundColor:o},className:"".concat(O.a.Icon," ").concat(O.a.DroneIcon)}),Object(M.jsx)("span",{className:O.a.DroneSelectionWrapper,children:this.renderDroneSelect()})]}),Object(M.jsx)("span",{className:O.a.HeaderItem,children:Object(M.jsxs)("span",{className:O.a.LongLatWrapper,children:[Object(M.jsx)("span",{className:O.a.MissionWrapper,children:Object(M.jsx)("span",{className:O.a.lonLatLabel,children:"Mission:"})}),Object(M.jsx)("span",{className:O.a.MissionValueWrapper,children:Object(M.jsx)("span",{className:O.a.MissionValue,children:this.props.missionState})})]})}),Object(M.jsxs)("span",{className:O.a.HeaderItem,children:[Object(M.jsx)("span",{className:"".concat(O.a.Icon," ").concat(O.a.PositionIcon)}),Object(M.jsxs)("span",{className:O.a.LongLatWrapper,children:[Object(M.jsxs)("span",{children:[Object(M.jsx)("span",{className:O.a.lonLatLabel,children:"X:"}),Object(M.jsx)("span",{className:O.a.lonLatValue,children:n?this.formatPosition(n.x):"N/A"})]}),Object(M.jsxs)("span",{children:[Object(M.jsx)("span",{className:O.a.lonLatLabel,children:"Y:"}),Object(M.jsx)("span",{className:O.a.lonLatValue,children:n?this.formatPosition(n.y):"N/A"})]}),Object(M.jsxs)("span",{children:[Object(M.jsx)("span",{className:O.a.lonLatLabel,children:"Z:"}),Object(M.jsx)("span",{className:O.a.lonLatValue,children:n?this.formatPosition(n.z):"N/A"})]})]})]}),Object(M.jsxs)("span",{className:O.a.HeaderItem,children:[Object(M.jsx)("span",{className:"".concat(O.a.Icon," ").concat(O.a.CompassIcon)}),Object(M.jsxs)("span",{className:O.a.LongLatWrapper,children:[Object(M.jsxs)("span",{children:[Object(M.jsx)("span",{className:O.a.lonLatLabel,children:"X:"}),Object(M.jsx)("span",{className:O.a.lonLatValue,children:a?a.x:"N/A"})]}),Object(M.jsxs)("span",{children:[Object(M.jsx)("span",{className:O.a.lonLatLabel,children:"Y:"}),Object(M.jsx)("span",{className:O.a.lonLatValue,children:a?a.y:"N/A"})]}),Object(M.jsxs)("span",{children:[Object(M.jsx)("span",{className:O.a.lonLatLabel,children:"Z:"}),Object(M.jsx)("span",{className:O.a.lonLatValue,children:a?a.z:"N/A"})]})]})]}),Object(M.jsx)("span",{className:O.a.HeaderItem,children:Object(M.jsx)("span",{className:"".concat(O.a.Icon," ").concat(O.a.WifiIcon)})}),this.getBatteyData(),Object(M.jsx)("div",{className:O.a.HeaderItem,children:this.getClock()}),Object(M.jsx)("button",{className:O.a.MenuBtn,onClick:this.props.dronesPositions[this.props.selectedDrone]&&this.props.dronesPositions[this.props.selectedDrone].workingOrigin?this.props.toggleMissionPlannerScreen:function(){return alert("Need to select working origin first.")},children:Object(M.jsx)("span",{className:"".concat(O.a.Icon," ").concat(O.a.MissionPlannerIcon)})})]})]})}},{key:"render",value:function(){if(this.props.isLoading)return Object(M.jsx)(b,{loadingMessage:"initializing..."});var e=this.props.isMissionPlanScreenHidden?" ".concat(O.a.MissionPlannerHidden):"";return Object(M.jsxs)("div",{className:O.a.App,children:[Object(M.jsx)(te,{}),this.props.popupDetails?Object(M.jsx)(z,{popupDetails:this.props.popupDetails}):null,this.props.contextMenu?Object(M.jsx)(re,{contextMenu:this.props.contextMenu}):null,this.getMainHeader(),Object(M.jsx)(Ve,{isMissionPlanScreenHidden:this.props.isMissionPlanScreenHidden}),Object(M.jsx)("div",{className:"".concat(O.a.MissionPlannerOverlay).concat(e),children:Object(M.jsx)(Qe,{})})]})}}]),a}(n.Component),at=Object(se.d)(Object(A.b)((function(e){return{contextMenu:e.layout.contextMenu,popupDetails:e.layout.popupDetails,missionState:e.output.missionState||"N/A",isMissionPlanScreenHidden:e.layout.isMissionPlanScreenHidden,dronesPositions:e.map.dronesPositions,selectedDrone:e.map.selectedDrone,batteryLevel:e.layout.batteryLevelMap[e.map.selectedDrone]}}),(function(e){return{setMapCoreSDKLoadedFlag:function(){return e({type:H.a.SET_MAPCORE_SDK_LOADED_FLAG})},setMapToShow:function(t){return e({type:H.a.SET_MAP_TO_SHOW,payload:t})},showContextMenu:function(t,a,n){return e({type:H.a.SHOW_CONTEXT_MENU,payload:{x:t,y:a,items:n}})},toggleMissionPlannerScreen:function(){return e({type:H.a.TOGGLE_MISSION_PLANNER_SCREEN})},selectDrone:function(t){return e({type:H.a.SELECT_DRONE,payload:{droneNumber:t}})}}}))(tt)),nt=(a(140),a(61)),ot=a(98),rt=a(55),it={isMapCoreSDKLoaded:!1,mapToShow:null,enemyPositionOffset:null,dronesPositions:{},selectedDrone:null},st=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:it,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case H.a.SET_MAPCORE_SDK_LOADED_FLAG:return Object(u.a)(Object(u.a)({},e),{},{isMapCoreSDKLoaded:!0});case H.a.SET_MAP_TO_SHOW:return Object(u.a)(Object(u.a)({},e),{},{mapToShow:t.payload});case H.a.GET_DRONE_POSITION_OFFSET:var a=Object(u.a)({},e.dronesPositions[t.payload.droneNumber]);return a.angle=ze.f(t.payload.droneRotationQuaternion),a.offset=t.payload.dronePositionOffset,Object(u.a)(Object(u.a)({},e),{},{dronesPositions:Object(u.a)(Object(u.a)({},e.dronesPositions),{},Object(rt.a)({},t.payload.droneNumber,a))});case H.a.GET_ENEMY_POSITION:var n=t.payload.enemyOffset,o=t.payload.droneNumber,r=Object(u.a)({},e.dronesPositions[o]);return r.enemyOffsets&&r.enemyOffsets.some((function(e){return ze.a(e,n,!0)<ie.a.getConfiguration().MIN_ENEMY_RADIUS}))?e:(r.enemyOffsets=r.enemyOffsets?[].concat(Object(Fe.a)(r.enemyOffsets),[n]):[n],Object(u.a)(Object(u.a)({},e),{},{dronesPositions:Object(u.a)(Object(u.a)({},e.dronesPositions),{},Object(rt.a)({},o,r))}));case H.a.SELECT_DRONE:return Object(u.a)(Object(u.a)({},e),{},{selectedDrone:t.payload.droneNumber});case H.a.DELETE_DRONE_POSITION:return Object(u.a)(Object(u.a)({},e),{},{dronesPositions:Object(u.a)(Object(u.a)({},e.dronesPositions),{},Object(rt.a)({},e.selectedDrone,null))});case H.a.SAVE_ORIGIN_COORDINATE:var i=Object(u.a)({},e.dronesPositions[e.selectedDrone]);return i.workingOrigin={coordinate:t.payload.coordinate,angle:t.payload.angle},Object(u.a)(Object(u.a)({},e),{},{dronesPositions:Object(u.a)(Object(u.a)({},e.dronesPositions),{},Object(rt.a)({},e.selectedDrone,i))});default:return e}},ct={isPaused:!1,isRecording:!1},lt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case H.a.PAUSE_VIDEO:return Object(u.a)(Object(u.a)({},e),{},{isPaused:!0});case H.a.RESUME_VIDEO:return Object(u.a)(Object(u.a)({},e),{},{isPaused:!1});case H.a.TOGGLE_RECORDING_STATE:return Object(u.a)(Object(u.a)({},e),{},{isRecording:!e.isRecording});default:return e}},pt={skeletonRange:"N/A",weaponDetected:!1,indoorExplorationFlag:!1,missionState:"",isArmed:!1},ut=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case H.a.TOGGLE_SIDE_BAR:return Object(u.a)(Object(u.a)({},e),{},{toasts:e.toasts.filter((function(e){return!e.alwaysOnTop}))});case H.a.UPDATE_SKELETON_RANGE:return Object(u.a)(Object(u.a)({},e),{},{skeletonRange:t.payload.skeletonRange});case H.a.SET_WEAPON_DETECTION:return Object(u.a)(Object(u.a)({},e),{},{weaponDetected:t.payload.weaponDetected});case H.a.SET_INDOOR_EXPLORATION_FLAG:return Object(u.a)(Object(u.a)({},e),{},{indoorExplorationFlag:!0});case H.a.REMOVE_INDOOR_EXPLORATION_FLAG:return Object(u.a)(Object(u.a)({},e),{},{indoorExplorationFlag:!1});case H.a.SET_MISSION_STATE:return Object(u.a)(Object(u.a)({},e),{},{missionState:t.payload.missionState});case H.a.TOGGLE_ARM_STATE:return Object(u.a)(Object(u.a)({},e),{},{isArmed:!e.isArmed});default:return e}},_t=Object(nt.b)({map:st,output:ut,video:lt,layout:Ee.b,planner:Je.a}),dt=a(44),Ot=a.n(dt),mt=function(e){Ot.a.interceptors.response.use((function(e){return e}),(function(e){if(Ot.a.isCancel(e))return Promise.reject(e);var t=e.response&&e.response.data&&e.response.data.errMsg||"Unknown Error";return console.error(t),Promise.reject(e)}))},ht=a(70),Mt=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||nt.c,bt=Object(nt.d)(_t,Mt(Object(nt.a)(ot.a)));i.a.render(Object(M.jsx)(o.a.StrictMode,{children:Object(M.jsx)(b,{loadingMessage:"initializing..."})}),document.getElementById("root")),Ot.a.get($.a.urls.configuration).then((function(e){ie.a.setConfiguration(e.data),bt.dispatch({type:H.a.SELECT_DRONE,payload:{droneNumber:e.data.DRONES_DATA.dronesList[0]}}),mt(bt),Ie.a.registerAll(bt),i.a.render(Object(M.jsx)(o.a.StrictMode,{children:Object(M.jsx)(A.a,{store:bt,children:Object(M.jsx)(ht.a,{children:Object(M.jsx)(at,{})})})}),document.getElementById("root"))})).catch((function(e){console.error("error when trying to retreive configuration.json",e)}))},function(e,t,a){e.exports={MissionStagesWrapper:"MissionPlanStages_MissionStagesWrapper__2nY6Z",StageWrapper:"MissionPlanStages_StageWrapper__3lQgr",MenuBtn:"MissionPlanStages_MenuBtn__1epnI",BtnIconWrapper:"MissionPlanStages_BtnIconWrapper__2Ht2Z",BtnIconBall:"MissionPlanStages_BtnIconBall__2BNXk",AddNewStageBtn:"MissionPlanStages_AddNewStageBtn__2Slns",Arrow:"MissionPlanStages_Arrow__3CLq2","arrow-grow":"MissionPlanStages_arrow-grow__1g0iy",LabelsWrapper:"MissionPlanStages_LabelsWrapper__-ej_K",StageTypeLabel:"MissionPlanStages_StageTypeLabel__3kqyE",StageParamsLabel:"MissionPlanStages_StageParamsLabel__3ePZW"}},,,,function(e,t,a){e.exports={Wrapper:"AddMissionPlanStageForm_Wrapper__nqqHX",InputWrapper:"AddMissionPlanStageForm_InputWrapper__311dK",Row:"AddMissionPlanStageForm_Row__Eu_dT",InnerInputWrapper:"AddMissionPlanStageForm_InnerInputWrapper__1LPWk",Label:"AddMissionPlanStageForm_Label__3-Krf",Icon:"AddMissionPlanStageForm_Icon__3O9JT",PositionIcon:"AddMissionPlanStageForm_PositionIcon__Ok0Pc",DroneIcon:"AddMissionPlanStageForm_DroneIcon__30EZO"}},,,,,,,,,,function(e,t,a){e.exports={Overlay:"LoaderAlt_Overlay__LWfL-",loader:"LoaderAlt_loader__KVfO9",circle:"LoaderAlt_circle__UO9vV",orbit:"LoaderAlt_orbit__3_lP3"}},function(e,t,a){e.exports={contextMenu:"ContextMenu_contextMenu__MMd4N",contextMenuUL:"ContextMenu_contextMenuUL__3Yh4L",Close:"ContextMenu_Close__1BtwG",right:"ContextMenu_right__2OG1u",menuItem:"ContextMenu_menuItem__3HJ_U",ContextMenuIcon:"ContextMenu_ContextMenuIcon__3-yE-",Map:"ContextMenu_Map__2Avr5",DTM:"ContextMenu_DTM__1xP1w",ThreeD:"ContextMenu_ThreeD__lnfDB",Grid:"ContextMenu_Grid___X4ea",SwitchArrows:"ContextMenu_SwitchArrows__1zrSF",AddMapLocation:"ContextMenu_AddMapLocation__1eZ2x",DeleteIcon:"ContextMenu_DeleteIcon__1OtGk",EditIcon:"ContextMenu_EditIcon__L5fhS",ArrowUpIcon:"ContextMenu_ArrowUpIcon__2YB5G",ArrowDownIcon:"ContextMenu_ArrowDownIcon__2a5HS",MissionPlannerIcon:"ContextMenu_MissionPlannerIcon__1tx89",PcIcon:"ContextMenu_PcIcon__23gaJ",DroneIcon:"ContextMenu_DroneIcon__3ToHa",menuName:"ContextMenu_menuName__2PiHY"}},function(e,t,a){e.exports={MainContentWrapper:"Main_MainContentWrapper__OxgIS",Hidden:"Main_Hidden__2aGtY",RightPaneWrapper:"Main_RightPaneWrapper__3Zh2C",RightPaneWrapperItem:"Main_RightPaneWrapperItem__2-MNz",Split:"Main_Split__3TvJL",Left:"Main_Left__1m3vr",Right:"Main_Right__1g9xI"}},function(e,t,a){e.exports={Wrapper:"SwitchMapForm_Wrapper__3fcmS",Shown:"SwitchMapForm_Shown__2trJI",Header:"SwitchMapForm_Header__1_mVj",Button:"SwitchMapForm_Button__3hFUc",Body:"SwitchMapForm_Body__vXUfe",Apply:"SwitchMapForm_Apply__eGSYf"}},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(2),o=a(3),r={map:"map",tabs:"tabs"},i={appGlobalMessage:null,isRosWebsocketConncted:!1,contextMenu:null,popupDetails:null,imageSentToDroneData:null,isMissionPlanScreenHidden:!0,isPointSelectionMode:!1,appPrimaryUiElement:r.map,batteryLevelMap:{},airSpeedMap:{}};t.b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case o.a.SHOW_GLOBAL_MESSAGE:return Object(n.a)(Object(n.a)({},e),{},{appGlobalMessage:{text:t.payload.text,type:t.payload.type}});case o.a.REMOVE_GLOBAL_MESSAGE:return Object(n.a)(Object(n.a)({},e),{},{appGlobalMessage:null});case o.a.ROSS_WEBSOCKET_CONNECTION_SUCCESS:return Object(n.a)(Object(n.a)({},e),{},{isRosWebsocketConncted:!0});case o.a.ROSS_WEBSOCKET_CONNECTION_FAILED:case o.a.ROSS_WEBSOCKET_CONNECTION_CLOSED:return Object(n.a)(Object(n.a)({},e),{},{isRosWebsocketConncted:!1});case o.a.SHOW_CONTEXT_MENU:var a={x:t.payload.x,y:t.payload.y,options:t.payload.options,items:t.payload.items};return Object(n.a)(Object(n.a)({},e),{},{contextMenu:a});case o.a.CLOSE_CONTEXT_MENU:return Object(n.a)(Object(n.a)({},e),{},{contextMenu:null});case o.a.SHOW_POPUP:return Object(n.a)(Object(n.a)({},e),{},{popupDetails:Object(n.a)({},t.payload)});case o.a.HIDE_POPUP:return Object(n.a)(Object(n.a)({},e),{},{popupDetails:null});case o.a.SELECT_POINT_FROM_MAP:var s=Object(n.a)({},e.popupDetails);return s.modalChildProps.pointFromMap=t.payload.position,Object(n.a)(Object(n.a)({},e),{},{popupDetails:s});case o.a.TOGGLE_POINT_SELECTION_MODE:return Object(n.a)(Object(n.a)({},e),{},{isPointSelectionMode:!e.isPointSelectionMode});case o.a.IMAGE_SENT_TO_DRONE:return Object(n.a)(Object(n.a)({},e),{},{imageSentToDroneData:t.payload});case o.a.TOGGLE_MISSION_PLANNER_SCREEN:return Object(n.a)(Object(n.a)({},e),{},{isMissionPlanScreenHidden:!e.isMissionPlanScreenHidden});case o.a.TOGGLE_MAP_AND_OUTPUT_TABS:return Object(n.a)(Object(n.a)({},e),{},{appPrimaryUiElement:e.appPrimaryUiElement===r.map?r.tabs:r.map});case o.a.SET_BATTERY_LEVEL:var c=t.payload,l=c.batteryLevel,p=c.droneNumber,u=Object(n.a)({},e.batteryLevelMap);return u[p]=l,Object(n.a)(Object(n.a)({},e),{},{batteryLevelMap:u});case o.a.SET_AIR_SPEED:var _=t.payload,d=_.airSpeed,O=_.droneNumber,m=Object(n.a)({},e.airSpeedMap);return m[O]=d,Object(n.a)(Object(n.a)({},e),{},{airSpeedMap:m});default:return e}}},,,,function(e,t,a){e.exports={sliderWrapper:"Slider_sliderWrapper__1FKhr",mapslider:"Slider_mapslider__1NPMe",dragline:"Slider_dragline__3XMSq",line:"Slider_line__iFVU9",draggablebutton:"Slider_draggablebutton__24_4J"}},,,,,function(e,t,a){e.exports={Wrapper:"FlightTelemetry_Wrapper__1YU2B",TelemetryWrapper:"FlightTelemetry_TelemetryWrapper__3YYPy",Units:"FlightTelemetry_Units__1X8hg"}},,,function(e,t,a){e.exports={ComboLabel:"Select_ComboLabel__NMJPs",Mandatory:"Select_Mandatory__hW53g",DropDownWrapper:"Select_DropDownWrapper__3xxx-",DropDownArrow:"Select_DropDownArrow__2Ao26"}},,function(e,t,a){e.exports={Wrapper:"GlobalMessage_Wrapper__3NoLn",Icon:"GlobalMessage_Icon__3y1Zz",Text:"GlobalMessage_Text__idHn3"}},function(e,t,a){e.exports={radio:"Radio_radio__136cS",radio__input:"Radio_radio__input__2tbGY",radio__radio:"Radio_radio__radio__2qGca",Label:"Radio_Label__1vODM"}},,,,,function(e,t,a){e.exports={Wrapper:"RadioGroup_Wrapper__2Pegb",Label:"RadioGroup_Label__2BNfU",RadioGroupValuesWrapper:"RadioGroup_RadioGroupValuesWrapper__f04fD"}},function(e,t,a){e.exports={switch:"Toggle_switch__3fs1T",Input:"Toggle_Input__2G2_c",sliderRound:"Toggle_sliderRound__2f5v1"}},,,,,,,function(e,t,a){e.exports={DateTime:"Clock_DateTime__12uDK",Hour:"Clock_Hour__2Hud3"}},,,,,,,,,,,,,function(e,t,a){},function(e,t,a){e.exports={Wrapper:"Error_Wrapper__3jA9K"}},function(module,__webpack_exports__,__webpack_require__){"use strict";var C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14),C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__),C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(24),C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(40),C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(28),C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(8),C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(12),C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(11),C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(6),react__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_8__),_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(31),_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9__),axios__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(44),axios__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_10__),_config__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(10),react_redux__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(17),_ExternalConfigurationHandler__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(21),_store_actions_actionTypes__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(3),_store_actions__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(18),_SwitchMapForm_SwitchMapForm__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(99),_utils_geoCalculations__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(22),_store_reducers_plannerReducer__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(26),_store_reducers_layoutReducer__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(53),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(0),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20___default=__webpack_require__.n(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__),SLayerGroup=function e(t,a,n,o){Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_7__.a)(this,e),this.aLayerCreateStrings=[],this.coordSystemString=t,this.bShowGeoInMetricProportion=a,this.bSetTerrainBoxByStaticLayerOnly=n,this.InitialScale2D=o},SViewportData=function e(t,a){Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_7__.a)(this,e),this.viewport=t,this.editMode=a,this.canvas=t.GetWindowHandle();var n=t.GetTerrains();this.aLayers=null!=n&&n.length>0?n[0].GetLayers():null,this.terrainBox=null,this.terrainCenter=null,this.rotationCenter=null,this.bCameraPositionSet=!1,this.bSetTerrainBoxByStaticLayerOnly=!1},MapContainer=function(_PureComponent){Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_5__.a)(MapContainer,_PureComponent);var _super=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_6__.a)(MapContainer);function MapContainer(){var e;Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_7__.a)(this,MapContainer);for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return(e=_super.call.apply(_super,[this].concat(a))).state={mapLayerGroups:new Map,lastTerrainConfiguration:null,lastViewportConfiguration:null,bSameCanvas:!0,isDTMClicked:!1,is3DClicked:!1,isSwitchMapFormOpen:!1,isOriginSelectionMode:!1},e.mapTerrains=new Map,e.device=null,e.viewportData=null,e.uCameraUpdateCounter=0,e.aLastTerrainLayers=[],e.lastCoordSys=null,e.overlayManager=null,e.activeViewport=-1,e.aViewports=[],e.lastRenderTime=(new Date).getTime(),e.lastMemUsageLogTime=(new Date).getTime(),e.uMemUsageLoggingFrequency=0,e.nMousePrevX=0,e.nMousePrevY=0,e.mouseDownButtons=0,e.bEdit=!1,e.layerCallback=null,e.requestAnimationFrameId=-1,e.aPositions=[],e.aObjects=[],e.lineScheme=null,e.textScheme=null,e.TempOriginAngle=0,e.MapObjects={},e.EnemyPositions=[],e.SelectedMissionPointObject=null,e.MissionPointsObjects=[],e.RemoveDroneData=function(t){e.MapObjects[t]&&(e.MapObjects[t].WorkingOrigin&&(e.MapObjects[t].WorkingOrigin.Remove(),e.MapObjects[t].WorkingOrigin=null,e.props.deleteDronePosition()),e.MapObjects[t].Drone&&(e.MapObjects[t].Drone.Remove(),e.MapObjects[t].Drone=null),e.MapObjects[t].Route&&(e.MapObjects[t].Route.Remove(),e.MapObjects[t].Route=null))},e.CreateMapcoreObjects=function(){e.LoadMapcoreObject("lineScheme","LineScheme.json"),e.LoadMapcoreObject("ScreenPictureClick","ScreenPictureClick.json"),e.LoadMapcoreObject("ScreenPictureDrone","ScreenPictureDrone.json"),e.LoadMapcoreObject("WorldPictureScheme","WorldPicture3.json"),e.LoadMapcoreObject("textScheme","TextScheme.m")},e.StartEditMode=function(t){if(null!=e.ScreenPictureClick){var a=e.ScreenPictureClick.GetNodeByID(1e3);if(null==a)return alert("There is no item marked for editing (with ID = 1000)"),null;var n=window.MapCore.IMcObject.Create(e.overlay,e.ScreenPictureClick);return e.editMode.StartInitObject(n,a),n}return null},e.DrawMissionWayPoints=function(t){e.MissionPointsObjects.forEach((function(e){return e.Remove()})),e.MissionPointsObjects=[];var a,n=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_3__.a)(t);try{for(n.s();!(a=n.n()).done;){var o=a.value,r=o.selectedStageType.rossService;if(r&&"addMissionWP"==r){var i=o.stageParamsInput.split(","),s=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(i,3),c=s[0],l=s[1],p=s[2],u=window.MapCore.IMcObject.Create(e.overlay,e.ScreenPictureClick,[{x:parseFloat(c),y:parseFloat(l),z:parseFloat(p)}]);u.SetTextureProperty(1,window.MapCore.IMcImageFileTexture.Create(window.MapCore.SMcFileSource("".concat(window.location.protocol,"ObjectWorld/Images/pinPoint.png"),!1),!1)),e.props.viewerState==_store_reducers_plannerReducer__WEBPACK_IMPORTED_MODULE_18__.b.draft&&u.SetBColorProperty(3,new window.MapCore.SMcBColor(255,255,255,100)),e.MissionPointsObjects.push(u)}}}catch(_){n.e(_)}finally{n.f()}},e.selectMissionPointFromMap=function(){e.SelectedMissionPointObject=e.StartEditMode()},e.SetWorkingOrigin=function(){e.RemoveDroneData(e.props.selectedDrone),e.MapObjects[e.props.selectedDrone]||(e.MapObjects[e.props.selectedDrone]={WorkingOrigin:null,Drone:null,Route:null}),e.MapObjects[e.props.selectedDrone].WorkingOrigin=e.StartEditMode(),e.MapObjects[e.props.selectedDrone].WorkingOrigin.SetTextureProperty(1,window.MapCore.IMcImageFileTexture.Create(window.MapCore.SMcFileSource("".concat(window.location.protocol,"ObjectWorld/Images/location4.png"),!1),!1)),e.MapObjects[e.props.selectedDrone].WorkingOrigin.SetDrawPriority(1),e.setState({isOriginSelectionMode:!0})},e.DrawDroneMapImage=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__.a)(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function t(){var a,n,o,r,i,s,c;return C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=_ExternalConfigurationHandler__WEBPACK_IMPORTED_MODULE_13__.a.getConfiguration(),n=a.DRONES_DATA,"//".concat(n.segment,".").concat(e.props.selectedDrone,":").concat(n.port).concat(_config__WEBPACK_IMPORTED_MODULE_11__.a.mapImageStream),o=document.getElementById("droneImage"),(r=document.createElement("canvas")).width=o.naturalWidth,r.height=o.naturalHeight,(i=r.getContext("2d")).drawImage(o,0,0),s=i.getImageData(0,0,o.naturalWidth,o.naturalHeight).data,c=window.MapCore.IMcMemoryBufferTexture.Create(o.naturalWidth,o.naturalHeight,window.MapCore.IMcTexture.EPixelFormat.EPF_A8B8G8R8,window.MapCore.IMcTexture.EUsage.EU_STATIC_WRITE_ONLY,!1,s,0),e.DroneMapImage?e.DroneMapImage.SetTextureProperty(1,c):(e.DroneMapImage=window.MapCore.IMcObject.Create(e.overlay,e.WorldPictureScheme,[e.MapObjects[e.props.selectedDrone].WorkingOrigin.GetLocationPoints()[0]]),e.DroneMapImage.SetTextureProperty(1,c),e.DroneMapImage.SetBColorProperty(4,new window.MapCore.SMcBColor(255,255,255,100)));case 11:case"end":return t.stop()}}),t)}))),e.SetOpacityToDroneObjects=function(t,a){e.MapObjects[t].WorkingOrigin&&e.MapObjects[t].WorkingOrigin.SetBColorProperty(3,new window.MapCore.SMcBColor(255,255,255,a?255:100)),e.MapObjects[t].Drone&&e.MapObjects[t].Drone.SetBColorProperty(3,new window.MapCore.SMcBColor(255,255,255,a?255:150))},e.MoveDrone=function(t){if(e.MapObjects[t]&&e.MapObjects[t].WorkingOrigin)if(e.MapObjects[t].Drone&&e.MapObjects[t].Route){var a=_utils_geoCalculations__WEBPACK_IMPORTED_MODULE_17__.e(e.props.dronesPositions[t].workingOrigin,e.props.dronesPositions[t].offset),n=e.MapObjects[t].Route.GetLocationPoints();if(n.length>0){var o=n[n.length-1];if(_utils_geoCalculations__WEBPACK_IMPORTED_MODULE_17__.a(o,a)<_config__WEBPACK_IMPORTED_MODULE_11__.a.MIN_DRONE_DISTANCE_MOVE)return}e.MapObjects[t].Drone.UpdateLocationPoints([a]),e.MapObjects[t].Drone.SetFloatProperty(4,e.props.dronesPositions[t].workingOrigin.angle+e.props.dronesPositions[t].angle),n.push(a),e.MapObjects[t].Route.SetLocationPoints(n),e.SetOpacityToDroneObjects(t,t==e.props.selectedDrone)}else e.DrawDroneObjects(t);else console.log("No Working Origin Selected!!")},e.OnEditClickMissionPoint=function(){if(e.SelectedMissionPointObject&&e.SelectedMissionPointObject.GetLocationPoints().length>0){e.props.togglePointSelectionMode();var t=e.SelectedMissionPointObject.GetLocationPoints()[0];t.z=_config__WEBPACK_IMPORTED_MODULE_11__.a.DEFAULT_MISSION_POINT_HEIGHT,e.props.setPositionToPopup(_utils_geoCalculations__WEBPACK_IMPORTED_MODULE_17__.g(t,_config__WEBPACK_IMPORTED_MODULE_11__.a.COORDINATE_DECIMALS_PRECISION)),e.SelectedMissionPointObject.Remove()}e.SelectedMissionPointObject=null},e.renderMapContinuously=function(){if(e.requestAnimationFrameId){e.trySetTerainBox();var t=(new Date).getTime();if(e.state.bSameCanvas?null!=e.viewport&&e.viewport.Render():window.MapCore.IMcMapViewport.RenderAll(),e.lastRenderTime=t,0!=e.uMemUsageLoggingFrequency&&t>=e.lastMemUsageLogTime+1e3*e.uMemUsageLoggingFrequency){window.MapCore.IMcMapDevice.GetMaxMemoryUsage();console.log("Max mem = "+window.MapCore.IMcMapDevice.GetMaxMemoryUsage().toLocaleString()+", heap = "+window.MapCore.IMcMapDevice.GetHeapSize().toLocaleString()+" B"),e.lastMemUsageLogTime=t}e.requestAnimationFrameId=requestAnimationFrame(e.renderMapContinuously)}},e.DoCreateGrid=function(){if(e.viewport&&e.viewport.GetMapType()!=window.MapCore.IMcMapCamera.EMapType.EMT_3D){if(e.viewport.GetGridVisibility()&&null!=e.viewport.GetGrid())e.viewport.SetGridVisibility(!1);else{if(null==e.viewport.GetGrid()){var t=new window.MapCore.IMcMapGrid.SGridRegion;t.pGridLine=window.MapCore.IMcLineItem.Create(window.MapCore.IMcObjectSchemeItem.EItemSubTypeFlags.EISTF_SCREEN.value,window.MapCore.IMcLineBasedItem.ELineStyle.ELS_SOLID,window.MapCore.bcBlackOpaque,2),t.pGridText=window.MapCore.IMcTextItem.Create(window.MapCore.IMcObjectSchemeItem.EItemSubTypeFlags.EISTF_SCREEN.value,null,new window.MapCore.SMcFVector2D(12,12)),t.pGridText.SetTextColor(new window.MapCore.SMcBColor(255,0,0,255)),t.pCoordinateSystem=e.viewport.GetCoordinateSystem(),t.GeoLimit.MinVertex=window.MapCore.SMcVector3D(0,0,0),t.GeoLimit.MaxVertex=window.MapCore.SMcVector3D(0,0,0);var a=2e3,n=80;e.props.mapToShow.gridParams&&(a=e.props.mapToShow.gridParams.basicNextLineGap,n=e.props.mapToShow.gridParams.basicfMaxScale);var o=[];o[0]=new window.MapCore.IMcMapGrid.SScaleStep,o[0].fMaxScale=n,o[0].eAngleValuesFormat=window.MapCore.IMcMapGrid.EAngleFormat.EAF_DECIMAL_DEG,o[0].NextLineGap=window.MapCore.SMcVector2D(a,a),o[0].uNumOfLinesBetweenDifferentTextX=2,o[0].uNumOfLinesBetweenDifferentTextY=2,o[0].uNumOfLinesBetweenSameTextX=2,o[0].uNumOfLinesBetweenSameTextY=2,o[0].uNumMetricDigitsToTruncate=3,a*=2,n*=2,o[1]=new window.MapCore.IMcMapGrid.SScaleStep,o[1].fMaxScale=n,o[1].eAngleValuesFormat=window.MapCore.IMcMapGrid.EAngleFormat.EAF_DECIMAL_DEG,o[1].NextLineGap=window.MapCore.SMcVector2D(a,a),o[1].uNumOfLinesBetweenDifferentTextX=2,o[1].uNumOfLinesBetweenDifferentTextY=2,o[1].uNumOfLinesBetweenSameTextX=2,o[1].uNumOfLinesBetweenSameTextY=2,o[1].uNumMetricDigitsToTruncate=3,a*=2,n*=2,o[2]=new window.MapCore.IMcMapGrid.SScaleStep,o[2].fMaxScale=n,o[2].eAngleValuesFormat=window.MapCore.IMcMapGrid.EAngleFormat.EAF_DECIMAL_DEG,o[2].NextLineGap=window.MapCore.SMcVector2D(a,a),o[2].uNumOfLinesBetweenDifferentTextX=2,o[2].uNumOfLinesBetweenDifferentTextY=2,o[2].uNumOfLinesBetweenSameTextX=2,o[2].uNumOfLinesBetweenSameTextY=2,o[2].uNumMetricDigitsToTruncate=3,a*=2,n*=2,o[3]=new window.MapCore.IMcMapGrid.SScaleStep,o[3].fMaxScale=n,o[3].eAngleValuesFormat=window.MapCore.IMcMapGrid.EAngleFormat.EAF_DECIMAL_DEG,o[3].NextLineGap=window.MapCore.SMcVector2D(a,a),o[3].uNumOfLinesBetweenDifferentTextX=2,o[3].uNumOfLinesBetweenDifferentTextY=2,o[3].uNumOfLinesBetweenSameTextX=2,o[3].uNumOfLinesBetweenSameTextY=2,o[3].uNumMetricDigitsToTruncate=3,a*=2,n*=2,o[4]=new window.MapCore.IMcMapGrid.SScaleStep,o[4].fMaxScale=n,o[4].eAngleValuesFormat=window.MapCore.IMcMapGrid.EAngleFormat.EAF_DECIMAL_DEG,o[4].NextLineGap=window.MapCore.SMcVector2D(a,a),o[4].uNumOfLinesBetweenDifferentTextX=2,o[4].uNumOfLinesBetweenDifferentTextY=2,o[4].uNumOfLinesBetweenSameTextX=2,o[4].uNumOfLinesBetweenSameTextY=2,o[4].uNumMetricDigitsToTruncate=3,a*=2,n*=2,o[5]=new window.MapCore.IMcMapGrid.SScaleStep,o[5].fMaxScale=n,o[5].eAngleValuesFormat=window.MapCore.IMcMapGrid.EAngleFormat.EAF_DECIMAL_DEG,o[5].NextLineGap=window.MapCore.SMcVector2D(a,a),o[5].uNumOfLinesBetweenDifferentTextX=2,o[5].uNumOfLinesBetweenDifferentTextY=2,o[5].uNumOfLinesBetweenSameTextX=2,o[5].uNumOfLinesBetweenSameTextY=2,o[5].uNumMetricDigitsToTruncate=3,a*=2,o[6]=new window.MapCore.IMcMapGrid.SScaleStep,o[6].fMaxScale=window.MapCore.FLT_MAX,o[6].eAngleValuesFormat=window.MapCore.IMcMapGrid.EAngleFormat.EAF_DECIMAL_DEG,o[6].NextLineGap=window.MapCore.SMcVector2D(a,a),o[6].uNumOfLinesBetweenDifferentTextX=2,o[6].uNumOfLinesBetweenDifferentTextY=2,o[6].uNumOfLinesBetweenSameTextX=2,o[6].uNumOfLinesBetweenSameTextY=2,o[6].uNumMetricDigitsToTruncate=3;var r=window.MapCore.IMcMapGrid.Create([t],o);e.viewport.SetGrid(r)}e.viewport.SetGridVisibility(!0)}e.setState({gridVisible:!e.state.gridVisible})}},e.trySetTerainBox=function(){for(var t=0;t<e.aViewports.length;t++){if(null==e.aViewports[t].terrainBox){var a=e.aViewports[t].aLayers;if(a&&0!=a.length){e.aViewports[t].terrainBox=new window.MapCore.SMcBox(-window.MapCore.DBL_MAX,-window.MapCore.DBL_MAX,0,window.MapCore.DBL_MAX,window.MapCore.DBL_MAX,0);for(var n=0;n<a.length;++n)if(!e.aViewports[t].bSetTerrainBoxByStaticLayerOnly||a[n].GetLayerType()==window.MapCore.IMcNativeStaticObjectsMapLayer.LAYER_TYPE){if(!a[n].IsInitialized())return void(e.aViewports[t].terrainBox=null);var o=a[n].GetBoundingBox();o.MinVertex.x>e.aViewports[t].terrainBox.MinVertex.x&&(e.aViewports[t].terrainBox.MinVertex.x=o.MinVertex.x),o.MaxVertex.x<e.aViewports[t].terrainBox.MaxVertex.x&&(e.aViewports[t].terrainBox.MaxVertex.x=o.MaxVertex.x),o.MinVertex.y>e.aViewports[t].terrainBox.MinVertex.y&&(e.aViewports[t].terrainBox.MinVertex.y=o.MinVertex.y),o.MaxVertex.y<e.aViewports[t].terrainBox.MaxVertex.y&&(e.aViewports[t].terrainBox.MaxVertex.y=o.MaxVertex.y)}}else e.aViewports[t].terrainBox=new window.MapCore.SMcBox(0,0,0,0,0,0);e.aViewports[t].terrainCenter=window.MapCore.SMcVector3D((e.aViewports[t].terrainBox.MinVertex.x+e.aViewports[t].terrainBox.MaxVertex.x)/2,(e.aViewports[t].terrainBox.MinVertex.y+e.aViewports[t].terrainBox.MaxVertex.y)/2,0),e.aViewports[t].terrainCenter.z=1e4}if(!e.aViewports[t].bCameraPositionSet)if(e.aViewports[t].viewport.GetMapType()==window.MapCore.IMcMapCamera.EMapType.EMT_2D)e.aViewports[t].viewport.SetCameraPosition(e.props.mapToShow.cameraPosition?e.props.mapToShow.cameraPosition:e.aViewports[t].terrainCenter),e.aViewports[t].bCameraPositionSet=!0;else{e.aViewports[t].terrainCenter.z=100,e.aViewports[t].viewport.SetCameraPosition(e.props.mapToShow.cameraPosition?e.props.mapToShow.cameraPosition:e.aViewports[t].terrainCenter);var r=new window.MapCore.IMcSpatialQueries.SQueryParams;r.eTerrainPrecision=window.MapCore.IMcSpatialQueries.EQueryPrecision.EQP_HIGH,e.aViewports[t].bCameraPositionSet=!0,r.pAsyncQueryCallback=new e.CAsyncQueryCallback(e.aViewports[t]),e.aViewports[t].viewport.GetTerrainHeight(e.aViewports[t].terrainCenter,{},null,r)}}},e.resizeCanvases=function(){if(0!=e.aViewports.length){var t;e.state.bSameCanvas?(t=1,1):(t=Math.ceil(Math.sqrt(e.aViewports.length)),Math.ceil(e.aViewports.length/t));for(var a=document.getElementById("canvasesContainer").getBoundingClientRect().width,n=document.getElementById("canvasesContainer").getBoundingClientRect().height,o=0;o<e.aViewports.length;o++)e.aViewports[o].canvas.width=a,e.aViewports[o].canvas.height=n,e.aViewports[o].viewport.ViewportResized()}},e.doDtmVisualization=function(){if(e.viewport.GetDtmVisualization())e.viewport.SetDtmVisualization(!1);else{var t=e.calcMinMaxHeights(),a=new window.MapCore.IMcMapViewport.SDtmVisualizationParams;window.MapCore.IMcMapViewport.SDtmVisualizationParams.SetDefaultHeightColors(a,t.minHeight,t.maxHeight),a.bDtmVisualizationAboveRaster=!0,a.uHeightColorsTransparency=120,a.uShadingTransparency=255,e.viewport.SetDtmVisualization(!0,a)}},e.mouseWheelHandler=function(t){var a={},n=-t.deltaY;if(e.editMode.OnMouseEvent(window.MapCore.IMcEditMode.EMouseEvent.EME_MOUSE_WHEEL,window.MapCore.SMcPoint(0,0),t.ctrlKey,n,a,{}),!a.Value){var o=t.shiftKey?10:1;if(e.viewport.GetMapType()==window.MapCore.IMcMapCamera.EMapType.EMT_3D)e.viewport.MoveCameraRelativeToOrientation(window.MapCore.SMcVector3D(0,0,n/8*o),!0);else{var r=e.viewport.GetCameraScale();n>0?e.viewport.SetCameraScale(r/1.25):e.viewport.SetCameraScale(1.25*r),e.viewport.GetDtmVisualization()&&(e.doDtmVisualization(),e.doDtmVisualization())}t.preventDefault(),t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()}},e.mouseMoveHandler=function(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.viewport.GetWindowHandle()==t.target){var n=null;if(a){var o=t.target.getBoundingClientRect(),r=t.targetTouches[0].pageX-o.left,i=t.targetTouches[0].pageY-o.top;n=window.MapCore.SMcPoint(r,i)}else n=window.MapCore.SMcPoint(t.offsetX,t.offsetY);if(t.buttons<=1){var s={},c={};if(e.editMode.OnMouseEvent(1==t.buttons||a?window.MapCore.IMcEditMode.EMouseEvent.EME_MOUSE_MOVED_BUTTON_DOWN:window.MapCore.IMcEditMode.EMouseEvent.EME_MOUSE_MOVED_BUTTON_UP,n,t.ctrlKey,0,s,c),s.Value)return t.preventDefault(),t.cancelBubble=!0,void(t.stopPropagation&&t.stopPropagation())}if((1==t.buttons||a)&&0!=e.nMousePrevX){var l=t.shiftKey?10:1;e.viewport.GetMapType()==window.MapCore.IMcMapCamera.EMapType.EMT_3D?t.ctrlKey?e.viewport.MoveCameraRelativeToOrientation(window.MapCore.SMcVector3D((e.nMousePrevX-n.x)/2*l,-(e.nMousePrevY-n.y)/2*l,0),!1):e.viewport.RotateCameraRelativeToOrientation((e.nMousePrevX-n.x)/2,-(e.nMousePrevY-n.y)/2,0):t.ctrlKey?e.viewport.SetCameraOrientation((e.nMousePrevX-n.x)/2,window.MapCore.FLT_MAX,window.MapCore.FLT_MAX,!0):e.viewport.ScrollCamera((e.nMousePrevX-n.x)*l,(e.nMousePrevY-n.y)*l),t.preventDefault(),t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()}e.nMousePrevX=n.x,e.nMousePrevY=n.y}},e.mouseDownHandler=function(t){if(e.editMode.IsEditingActive()){if(e.viewport.GetWindowHandle()!=t.target)return}else if(!e.state.bSameCanvas)for(var a=0;a<e.aViewports.length;a++)if(t.target==e.aViewports[a].viewport.GetWindowHandle()){e.activeViewport=a,e.updateActiveViewport();break}var n=t.target.getBoundingClientRect(),o="touchend"==t.type?window.MapCore.SMcPoint(t.changedTouches[0].pageX-n.left,t.changedTouches[0].pageY-n.top):window.MapCore.SMcPoint(t.offsetX,t.offsetY);if(e.mouseDownButtons=t.buttons,"touchend"==t.type||1==t.buttons){var r={};if(e.editMode.OnMouseEvent(window.MapCore.IMcEditMode.EMouseEvent.EME_BUTTON_PRESSED,o,t.ctrlKey,0,r,{}),e.props.isPointSelectionMode&&e.OnEditClickMissionPoint(),r.Value)return t.preventDefault(),t.cancelBubble=!0,void(t.stopPropagation&&t.stopPropagation());e.nMousePrevX=o.x,e.nMousePrevY=o.y}t.preventDefault(),t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()},e.mouseUpHandler=function(t){if(e.props.closeContextMenu(),e.viewport.GetWindowHandle()==t.target){var a=window.MapCore.SMcPoint(t.offsetX,t.offsetY);if(1==(e.mouseDownButtons&~t.buttons)){var n={};if(e.editMode.OnMouseEvent(window.MapCore.IMcEditMode.EMouseEvent.EME_BUTTON_RELEASED,a,t.ctrlKey,0,n,{}),n.Value)return t.preventDefault(),t.cancelBubble=!0,void(t.stopPropagation&&t.stopPropagation())}}},e.mouseDblClickHandler=function(t){if(e.viewport.GetWindowHandle()==t.target){var a=window.MapCore.SMcPoint(t.offsetX,t.offsetY),n=e.mouseDownButtons&~t.buttons,o=e.viewport.ScanInGeometry(new window.MapCore.SMcScanPointGeometry(window.MapCore.EMcPointCoordSystem.EPCS_SCREEN,window.MapCore.SMcVector3D(a.x,a.y,0),20),!1);if(e.bEdit){for(var r=0;r<o.length;++r)if(o[r].eTargetType==window.MapCore.IMcSpatialQueries.EIntersectionTargetType.EITT_OVERLAY_MANAGER_OBJECT){e.bEdit&&e.editMode.StartEditObject(o[r].ObjectItemData.pObject,o[r].ObjectItemData.pItem);break}return e.bEdit=!1,t.preventDefault(),t.cancelBubble=!0,void(t.stopPropagation&&t.stopPropagation())}if(1==n){var i={};if(e.editMode.OnMouseEvent(window.MapCore.IMcEditMode.EMouseEvent.EME_BUTTON_DOUBLE_CLICK,a,t.ctrlKey,0,i,{}),i.Value)return t.preventDefault(),t.cancelBubble=!0,void(t.stopPropagation&&t.stopPropagation())}for(var s=0;s<o.length;++s)if(o[s].eTargetType==window.MapCore.IMcSpatialQueries.EIntersectionTargetType.EITT_OVERLAY_MANAGER_OBJECT){var c=o[s].ObjectItemData.pObject.GetID();null!==c&&void 0!==c&&e.props.showContextMenu(a.x+5,a.y+5,[{name:0==c?"Working Origin":"WayPoint "+c}]);break}}},e.stopEvent=function(e){e.preventDefault(),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()},e.touchStartHandler=function(t){var a=t.target.getBoundingClientRect();e.nMousePrevX=e._onMouseDownX=t.targetTouches[0].pageX-a.left,e.nMousePrevY=e._onMouseDownY=t.targetTouches[0].pageY-a.top},e.screenToWorld=function(t,a,n){var o=new window.MapCore.SMcVector3D(t,a,0),r={};e.viewport.ScreenToWorldOnTerrain(o,r)||e.viewport.ScreenToWorldOnPlane(o,r);var i=r;return!n||n.withoutConvert,i},e.worldToScreen=function(t,a){var n=t;!a||a.native;var o=e.viewport.WorldToScreen(n),r=!0;return(o.x<0||o.x>e._canvas.width||o.y<0||o.y>e._canvas.height)&&(r=!1),{x:o.x,y:o.y,inScreen:r}},e.moveCameraRelativeToOrientation=function(t,a){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=1;if(o){var i=e.viewport.GetCameraPosition(),s={},c=Math.abs(i.z);e.viewport.GetTerrainHeight(i,s)&&(c=i.z-s.Value),"mouse"===o?(r=600,c<10?r=1:c<30?r=3:c<100?r=6:c<200?r=12:c<300?r=20:c<500?r=35:c<1e3?r=100:c<2e3?r=200:c<5e3&&(r=400)):"touch"===o?(r=600,c<10?r=2:c<30?r=6:c<100?r=9:c<200?r=12:c<300?r=20:c<500?r=35:c<1e3?r=100:c<2e3?r=200:c<5e3&&(r=400),r*=2):(r=150,c<10?r=1:c<30?r=4:c<100?r=8:c<200?r=12:c<300?r=30:c<500?r=50:c<1e3&&(r=100))}e.viewport.MoveCameraRelativeToOrientation(window.MapCore.SMcVector3D(t*r,a*r,0),n)},e.getCameraOrientation=function(){var t={azimuth:0,pitch:0},a={},n={};return e.viewport.GetCameraOrientation(a,n,null),a&&(t.azimuth=a.Value),n&&(t.pitch=n.Value),t},e.setCameraOrientation=function(t,a){var n={},o={},r={};e.viewport.GetCameraOrientation(n,o,r);var i=void 0!==t?t:n.Value,s=void 0!==a?a:o.Value;e.viewport.SetCameraOrientation(i,s,0)},e.isGeoCoordValid=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=1e5,n=!0,o=t?a:1;return(e.x<-180*o||e.y<-89.5*o||0===e.y||e.x>180*o||e.y>89.5*o||e.z>Number.MAX_VALUE)&&(n=!1),n},e.rotateCameraAroundWorldPoint=function(t,a,n,o){var r,i={},s={},c={};if(o&&(e.viewport.GetCameraOrientation(i,s,c),r=e.viewport.GetCameraPosition()),e.viewport.RotateCameraAroundWorldPoint(t,a,n),o){var l={};e.viewport.GetCameraOrientation({},{},l),180===Math.abs(l.Value)&&(e.viewport.SetCameraOrientation(i.Value,s.Value,c.Value,!1),e.viewport.SetCameraPosition(r))}},e.rotateCameraRelativeToOrientation=function(t,a,n){e.viewport.RotateCameraRelativeToOrientation(t*n,a*n,0);e.viewport.GetCameraOrientation({},null,null)},e.getCameraScale=function(){var t,a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e.state.is3DClicked?t=e.viewport.GetCameraPosition().z:(t=e.viewport.GetCameraScale(),a&&(t=(10*(t/=e.viewport.GetPixelPhysicalHeight())).toFixed(2),t=parseInt(t))),t},e.setCameraScale=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(e.state.is3DClicked){var n=e.viewport.GetCameraPosition(),o=1;t>n.z&&(o=-1);var r=a*n.z/100;e.viewport.MoveCameraRelativeToOrientation(window.MapCore.SMcVector3D(0,o*r,0),!1)}else{var i=e.mapScaleTopLimit||2e5;e.cameraScaleChanged=!0;var s=e.viewport.GetPixelPhysicalHeight(),c=t/s;c<25?t=25*s:c>i&&(t=s*i),e.viewport.SetCameraScale(t)}},e.updatePositionText=function(t,a,n){var o,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];try{var i={},s=Math.abs(t)>1e5?t:1e5*t,c=Math.abs(a)>1e5?a:1e5*a,l=new window.MapCore.SMcVector3D(s,c,0);e.viewport.GetTerrainHeight(l,i)&&(o=i.Value)}catch(p){}r&&(e.lastUpdatedHeight=o,console.log("mapheightchanged",o))},e.zoomIn=function(t,a){var n=e.getCameraScale();e.setCameraScale(n/(t||1.5)),e.lastClickPos&&e.updatePositionText(e.lastClickPos.x,e.lastClickPos.y,e.lastClickPos.z)},e.zoomOut=function(t,a){var n=e.getCameraScale();e.setCameraScale(n*(t||1.5)),e.lastClickPos&&e.updatePositionText(e.lastClickPos.x,e.lastClickPos.y,e.lastClickPos.z)},e.handleZoomOrRotate=function(t){var a=t.touches[0].screenX-t.touches[1].screenX,n=t.touches[0].screenY-t.touches[1].screenY,o=Math.abs(a*a+n*n);if(e.lastTouchDistance){var r,i,s=o-e.lastTouchDistance>0,c=Math.abs(o-e.lastTouchDistance),l=t.target.getBoundingClientRect(),p=t.targetTouches[0].pageX-l.left,u=t.targetTouches[0].pageY-l.top,_=t.targetTouches[1].pageX-l.left,d=t.targetTouches[1].pageY-l.top,O=(p+_)/2,m=(u+d)/2,h=e.screenToWorld(O,m,{withoutConvert:!0});if(e.pinchStatus?(r=e.pinchStatus.averageX,i=e.pinchStatus.averageY,e.pinchStatus.averageX=O,e.pinchStatus.averageY=m):e.pinchStatus={averageX:O,averageY:m,averageWorldPosition:h},e.state.is3DClicked){if(!e.pinchStatus.coordToRotateAround3D)if(c>1e3){var M=c/5e3;s?e.moveCameraRelativeToOrientation(0,M,!1,!0):e.moveCameraRelativeToOrientation(0,-M,!1,!0),e.lastTouchDistance=o,r=void 0,i=void 0,e.pinchStatus.zooming3D=!0}else e.pinchStatus.zooming3D=!1}else c>1e4&&(s?e.zoomIn(1.05):e.zoomOut(1.05),e.lastTouchDistance=o);if(e.state.is3DClicked){if(r||i){var b=180*Math.atan2(u-d,p-_)/Math.PI,S=0;if(void 0===e.lastTouchRotation)e.lastTouchRotation=b;else{if(S=Math.abs(b-e.lastTouchRotation),!e.pinchStatus.zooming3D&&(S>2.5||e.pinchStatus.coordToRotateAround3D)){e.pinchStatus.coordToRotateAround3D=e.pinchStatus.coordToRotateAround3D||h.Value;var g=e.pinchStatus.coordToRotateAround3D;if(e.isGeoCoordValid(g)){var f=Math.sign(e.lastTouchRotation-b);e.rotateCameraAroundWorldPoint(g,2*f,0,!0)}}else{e.cameraMoved=!0;var E=r-e.pinchStatus.averageX,C=e.pinchStatus.averageY-i;e.rotateCameraRelativeToOrientation(E,C,.1)}e.lastTouchRotation=b}}}else{var v=180*Math.atan2(u-d,p-_)/Math.PI;if(void 0===e.lastTouchRotation)e.lastTouchRotation=v;else if(Math.abs(v-e.lastTouchRotation)>.5){var w=e.getCameraOrientation().azimuth;e.setCameraOrientation(w+e.lastTouchRotation-v),e.lastTouchRotation=v}if(e.pinchStatus){var T=e.worldToScreen(e.pinchStatus.averageWorldPosition.Value,{native:!0}),D=T.x-e.pinchStatus.averageX,y=T.y-e.pinchStatus.averageY;try{e.viewport.ScrollCamera(D,y)}catch(I){}}}}else e.lastTouchDistance=o},e.touchMoveHandler=function(t){1===t.touches.length?e.mouseMoveHandler(t,!0):e.handleZoomOrRotate(t),t.preventDefault()},e.touchEndHandler=function(t){e.isTouch=!1,e.pinchStatus=void 0,t.touches&&t.touches.length&&(e.disableMoveAfterMultiTouches=!0,setTimeout((function(){e.disableMoveAfterMultiTouches=!1}),200)),t.touches.length||(e.isMouseDown=!1,e.lastTouchDistance=0,e.lastTouchRotation=void 0,e.dbclickHandled=!0),t.preventDefault(),t.target.focus()},e.touchCancelHandler=function(e){},e.onSelectOtherMapClicked=function(){e.setState({isSwitchMapFormOpen:!0})},e.showHideDtmActionClicked=function(){e.setState({isDTMClicked:!e.state.isDTMClicked},e.doDtmVisualization)},e.showHide3DActionClicked=function(){e.setState({is3DClicked:!e.state.is3DClicked},(function(){return e.openMap(e.props.mapToShow.groupName,e.state.is3DClicked)}))},e.SetWorkingOrigin=function(){e.RemoveDroneData(e.props.selectedDrone),e.MapObjects[e.props.selectedDrone]||(e.MapObjects[e.props.selectedDrone]={WorkingOrigin:null,Drone:null,Route:null});var t=e.getAddMissionPlanStageFormState(),a=t.multiParamsInput,n={x:parseFloat(a.x),y:parseFloat(a.y),z:parseFloat(a.z)};if(t.multiParamsInput){e.MapObjects[e.props.selectedDrone].WorkingOrigin=window.MapCore.IMcObject.Create(e.overlay,e.ScreenPictureClick,[n]),e.MapObjects[e.props.selectedDrone].WorkingOrigin.SetTextureProperty(1,window.MapCore.IMcImageFileTexture.Create(window.MapCore.SMcFileSource("".concat(window.location.protocol,"ObjectWorld/Images/location4.png"),!1),!1)),e.MapObjects[e.props.selectedDrone].WorkingOrigin.SetDrawPriority(1);var o=_utils_geoCalculations__WEBPACK_IMPORTED_MODULE_17__.g(e.MapObjects[e.props.selectedDrone].WorkingOrigin.GetLocationPoints()[0],_config__WEBPACK_IMPORTED_MODULE_11__.a.COORDINATE_DECIMALS_PRECISION);e.props.saveOriginCoordinate(o,parseFloat(a.angle||0))}},e.onAddOrEditStageBtnClicked=function(){var t={title:"Select Origin ",modalChild:"AddMissionPlanStageForm",modalChildProps:{size:"small",selectPointFromMap:e.props.togglePointSelectionMode,onPopupInitalLoad:function(t){return e.getAddMissionPlanStageFormState=t},isSelectOrigin:!0,stage:{selectedStageType:{label:"Go To Waypoint",isMultiInputs:!0,params:{label:"Origin Coordinate:"}}}},onCloseButtonClick:function(){},primayButton:{title:"Done",callback:e.SetWorkingOrigin},secondaryButton:{title:"Cancel",callback:function(){}}};e.props.showPopup(t)},e.onMoreActionsClick=function(t){t.preventDefault(),t.stopPropagation();var a={name:"Select Other Map",func:e.onSelectOtherMapClicked,iconCss:"Map"},n=[],o=(e.props.mapToShow.layers.find((function(e){return e.type.toLowerCase().includes("dtm")})),{name:"Select Origin",func:function(){return e.onAddOrEditStageBtnClicked()},iconCss:"AddMapLocation"}),r={name:(e.state.isDTMClicked?"Hide":"Show")+" DTM visualization",func:function(){return e.showHideDtmActionClicked()},iconCss:"DTM"},i={name:e.state.gridVisible?"Hide Grid":"Show Grid",func:function(){return e.DoCreateGrid()},iconCss:"Grid"},s={name:"Switch To "+(e.state.is3DClicked?"2D":"3D"),func:e.showHide3DActionClicked,iconCss:"ThreeD"},c={name:"Toggle Map and Tabs",func:e.props.toggleBetweenMapToTabs,iconCss:"SwitchArrows"};n.push(r),n.push(s),n.push(o),n.push(i),n.push(a),n.push(c),e.props.showContextMenu(t.nativeEvent.x,t.nativeEvent.y,n)},e}return Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__.a)(MapContainer,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.resizeCanvases),this.props.isMapCoreSDKLoaded&&(this.openMap(this.props.mapToShow.groupName,!1),console.log("mapCore version: ",window.MapCore.IMcMapDevice.GetVersion()),this.CreateMapcoreObjects())}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resizeCanvases),cancelAnimationFrame(this.requestAnimationFrameId),this.requestAnimationFrameId=null}},{key:"componentDidUpdate",value:function(e){var t=this;(!e.isMapCoreSDKLoaded&&this.props.isMapCoreSDKLoaded||this.props.isMapCoreSDKLoaded&&e.mapToShow!==this.props.mapToShow)&&(this.openMap(this.props.mapToShow.groupName,!1),console.log("mapCore version: ",window.MapCore.IMcMapDevice.GetVersion()),this.CreateMapcoreObjects(),this.RemoveDroneData(),this.setState({gridVisible:!1}));var a=this.props.dronesPositions;a&&e.dronesPositions!=a&&Object.keys(a).forEach((function(n){a[n]&&a[n].workingOrigin&&(a[n].offset&&(e.dronesPositions[n]&&a[n].offset==e.dronesPositions[n].offset||t.MoveDrone(n)),!a[n].enemyOffsets||e.dronesPositions[n]&&a[n].enemyOffsets==e.dronesPositions[n].enemyOffsets||t.DrawEnemyObject(n))})),!this.props.isPointSelectionMode||e.isPointSelectionMode||this.SelectedMissionPointObject||this.selectMissionPointFromMap(),this.props.selectedDrone!=e.selectedDrone&&Object.keys(a).forEach((function(e){t.MapObjects[e]&&t.MapObjects[e].WorkingOrigin&&t.SetOpacityToDroneObjects(e,e==t.props.selectedDrone)}));var n=this.props,o=n.viewerState,r=n.savedMissionPlan,i=n.draftMissionStages;o!=_store_reducers_plannerReducer__WEBPACK_IMPORTED_MODULE_18__.b.savedMission||o==e.viewerState&&r==e.savedMissionPlan?o!=_store_reducers_plannerReducer__WEBPACK_IMPORTED_MODULE_18__.b.draft||o==e.viewerState&&i==e.draftMissionStages||this.DrawMissionWayPoints(i):this.DrawMissionWayPoints(r),this.props.appPrimaryUiElement!==e.appPrimaryUiElement&&this.resizeCanvases()}},{key:"LoadMapcoreObject",value:function(e,t){var a=this;null==this[e]&&this.FetchFileToByteArray("".concat(window.location.protocol,"ObjectWorld/Schemes/")+t).then((function(t){null!=t&&(a[e]=a.overlayManager.LoadObjectSchemes(t)[0],a[e].AddRef())}))}},{key:"DrawEnemyObject",value:function(e){var t=this.props.dronesPositions[e],a=_utils_geoCalculations__WEBPACK_IMPORTED_MODULE_17__.e(t.workingOrigin,t.enemyOffsets[t.enemyOffsets.length-1]);this.EnemyObject=window.MapCore.IMcObject.Create(this.overlay,this.ScreenPictureClick,[a]),this.EnemyObject.SetTextureProperty(1,window.MapCore.IMcImageFileTexture.Create(window.MapCore.SMcFileSource("".concat(window.location.protocol,"ObjectWorld/Images/enemy.png"),!1),!1)),this.EnemyObject.SetFloatProperty(2,.5)}},{key:"DrawDroneObjects",value:function(e){var t=_ExternalConfigurationHandler__WEBPACK_IMPORTED_MODULE_13__.a.getConfiguration().DRONES_DATA.dronesList,a=this.MapObjects[e].WorkingOrigin.GetLocationPoints()[0];this.MapObjects[e].Drone=window.MapCore.IMcObject.Create(this.overlay,this.ScreenPictureDrone,[a]),this.MapObjects[e].Drone.SetTextureProperty(1,window.MapCore.IMcImageFileTexture.Create(window.MapCore.SMcFileSource("".concat(window.location.protocol,"ObjectWorld/Images/droneNew").concat(t.indexOf(e)+1,".png"),!1),!1)),this.MapObjects[e].Drone.SetFloatProperty(2,.9),this.MapObjects[e].Drone.SetFloatProperty(4,this.props.dronesPositions[e].workingOrigin.angle),this.MapObjects[e].Drone.SetDrawPriority(2),this.MapObjects[e].Route=window.MapCore.IMcObject.Create(this.overlay,this.lineScheme,[a]),this.MapObjects[e].Route.SetFloatProperty(2,3);var n=new window.MapCore.SMcBColor(44,229,246,255);1==t.indexOf(this.props.selectedDrone)?n=new window.MapCore.SMcBColor(0,128,0,255):2==t.indexOf(this.props.selectedDrone)&&(n=new window.MapCore.SMcBColor(255,165,0,255)),this.MapObjects[e].Route.SetBColorProperty(1,n),this.SetOpacityToDroneObjects(e,e==this.props.selectedDrone)}},{key:"FetchFileToByteArray",value:function(e){return fetch(e).then((function(e){return e.ok?e.arrayBuffer():null})).then((function(t){return null!=t?new Uint8Array(t):(alert("Cannot fetch "+e),null)}),(function(t){return alert("Network error in fetching "+e),null}))}},{key:"parseLayersConfiguration",value:function(e){try{var t,a=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_3__.a)(e);try{for(a.s();!(t=a.n()).done;){var n=t.value,o="MapCore."+n.coordSystemType+".Create("+n.coordSystemParams+")",r=new SLayerGroup(o,n.showGeoInMetricProportion,n.centerByStaticObjectsLayerOnly,n.InitialScale2D);if(n.layers){var i,s=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_3__.a)(n.layers);try{for(s.s();!(i=s.n()).done;){var c=i.value,l=null,p=window.location.protocol;switch(c.type){case"WMSRaster":l="Create"+c.type+"Layer('"+c.path+"'"+(c.params?", "+c.params:"")+")";break;case"IMcNativeRasterMapLayer":l="MapCore.IMcNativeRasterMapLayer.Create('"+p+c.path+"', "+(c.params?c.params:"MapCore.UINT_MAX, false, 0, false")+", this.layerCallback)";break;case"IMcNativeDtmMapLayer":l="MapCore.IMcNativeDtmMapLayer.Create('"+p+c.path+"', "+(c.params?c.params:"0")+", this.layerCallback)";break;case"IMcNativeVectorMapLayer":l="MapCore.IMcNativeVectorMapLayer.Create('"+p+c.path+"', "+(c.params?c.params:"")+"this.layerCallback)";break;case"IMcNative3DModelMapLayer":l="MapCore.IMcNative3DModelMapLayer.Create('"+p+c.path+"', "+(c.params?c.params:"0")+", this.layerCallback)";break;case"IMcNativeVector3DExtrusionMapLayer":l="MapCore.IMcNativeVector3DExtrusionMapLayer.Create('"+p+c.path+"', "+(c.params?c.params:"0, 10")+", this.layerCallback)";break;default:return void alert("Invalid type of server layer")}r.aLayerCreateStrings.push(l)}}catch(u){s.e(u)}finally{s.f()}}void 0!=n.groupName?this.setState({mapLayerGroups:new Map(this.state.mapLayerGroups.set(n.groupName,r))}):n.wmtsServerURL}}catch(u){a.e(u)}finally{a.f()}}catch(_){alert("Invalid configuration JSON file")}}},{key:"parseCapabilitiesXML",value:function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3?arguments[3]:void 0,o=function(){function e(t){Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_7__.a)(this,e),this.node=t}return Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__.a)(e,[{key:"GetFirstChild",value:function(t){var a,n=this.node.getElementsByTagName(t),o=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_3__.a)(n);try{for(o.s();!(a=o.n()).done;){var r=a.value;if(r.parentNode==this.node)return new e(r)}}catch(i){o.e(i)}finally{o.f()}return null}},{key:"GetFirstChildText",value:function(e){var t,a=this.node.getElementsByTagName(e),n=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_3__.a)(a);try{for(n.s();!(t=n.n()).done;){var o=t.value;if(o.parentNode==this.node)return o.textContent}}catch(r){n.e(r)}finally{n.f()}return null}},{key:"GetFirstChildAttribute",value:function(e,t){var a,n=this.node.getElementsByTagName(e),o=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_3__.a)(n);try{for(o.s();!(a=o.n()).done;){var r=a.value;if(r.parentNode==this.node)return r.attributes.getNamedItem(t).value}}catch(i){o.e(i)}finally{o.f()}return null}},{key:"GetChildren",value:function(t){var a,n=this.node.getElementsByTagName(t),o=[],r=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_3__.a)(n);try{for(r.s();!(a=r.n()).done;){var i=a.value;i.parentNode==this.node&&o.push(new e(i))}}catch(s){r.e(s)}finally{r.f()}return o}},{key:"GetChildrenTexts",value:function(e){var t,a=this.node.getElementsByTagName(e),n=[],o=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_3__.a)(a);try{for(o.s();!(t=o.n()).done;){var r=t.value;r.parentNode==this.node&&n.push(r.textContent)}}catch(i){o.e(i)}finally{o.f()}return n}}]),e}();if(null!=e)try{var r=new o(e).GetFirstChild("Capabilities"),i=r.GetFirstChildAttribute("ServiceMetadataURL","xlink:href");null!=i&&""!=i||(i=t);var s=i.lastIndexOf("?");if(s<0&&(s=i.lastIndexOf("/")),s<0)return void alert("Invalid Capabilities file");var c,l=i.substring(0,s),p=r.GetFirstChild("Contents"),u=p.GetChildren("TileMatrixSet"),_=new Map,d=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_3__.a)(u);try{for(d.s();!(c=d.n()).done;){var O=c.value,m=O.GetFirstChildText("ows:Identifier"),h=O.GetFirstChildText("ows:SupportedCRS");null!=m&&null!=h&&_.set(O.GetFirstChildText("ows:Identifier"),{coordSystem:h,tileMatrixSet:m})}}catch(F){d.e(F)}finally{d.f()}var M,b=p.GetChildren("Layer"),S=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_3__.a)(b);try{for(S.s();!(M=S.n()).done;){var g=M.value,f=g.GetFirstChildText("ows:Identifier");if(this.context.mapToPreview.type!==_config__WEBPACK_IMPORTED_MODULE_11__.a.nodesLevel.layer||this.context.mapToPreview.data.LayerId===f||this.context.mapToPreview.dtmLayerId===f){var E=g.GetChildrenTexts("Format"),C=g.GetChildren("TileMatrixSetLink");0==C.length&&C.push(null);var v,w=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_3__.a)(C);try{for(w.s();!(v=w.n()).done;){var T=v.value,D=null,y=null;if(null!=T){var I=_.get(T.GetFirstChildText("TileMatrixSet"));if(D=I.coordSystem,y=I.tileMatrixSet,n&&n.tileMatrixSetFilter&&y!=n.tileMatrixSetFilter)continue}if(null==D){var P=g.GetFirstChild("ows:BoundingBox");P&&(D=P.GetFirstChildText("ows:crs"))}var j="urn:ogc:def:crs:";if(0==D.indexOf(j)){D=D.substring(j.length).replace("::",":");var x=[];if(a){x=g.GetFirstChildText("Group").split(",");for(var L=0;L<x.length;++L)x[L]=x[L]+" (server "+D+")"}else{var A=g.GetFirstChildText("ows:Title");null==A&&(A=f);for(var N=0;N<E.length;++N)E[N]=E[N].replace("image/",""),x[N]=A+" (WMTS "+E[N]+" "+y+")"}for(var R=0;R<x.length;++R){var k=x[R],B="MapCore.IMcGridGeneric.Create('"+D+"')",W=this.state.mapLayerGroups.get(k);if(void 0==W)W=new SLayerGroup(B,!0),this.setState({mapLayerGroups:new Map(this.state.mapLayerGroups.set(k,W))});else if(B!=W.coordSystemString)return void alert("Layers' coordinate systems do not match");var V=void 0;a?(V=E[0].replace("MapCore","MapCore.IMcNative").replace("DTM","Dtm")+"MapLayer.Create('"+l+"/"+f+"')",W.aLayerCreateStrings.push(V)):(V="CreateWMTSRasterLayer('"+t+"', '"+f+"', '"+y+"', '"+E[R]+"')",W.aLayerCreateStrings.push(V),n&&(W.aLayerCreateStrings=W.aLayerCreateStrings.concat(n.aLayerCreateStrings),W.bSetTerrainBoxByStaticLayerOnly=n.bSetTerrainBoxByStaticLayerOnly,W.bShowGeoInMetricProportion=n.bShowGeoInMetricProportion,W.InitialScale2D=n.InitialScale2D))}}}}catch(F){w.e(F)}finally{w.f()}}}}catch(F){S.e(F)}finally{S.f()}}catch(G){alert("Invalid Capabilities file")}}},{key:"createCallbackClasses",value:function(){this.CLayerReadCallback=window.MapCore.IMcMapLayer.IReadCallback.extend("IMcMapLayer.IReadCallback",{OnInitialized:function(e,t,a){t==window.MapCore.IMcErrors.ECode.SUCCESS||t!=window.MapCore.IMcErrors.ECode.NATIVE_SERVER_LAYER_NOT_VALID&&alert("Layer initialization: "+window.MapCore.IMcErrors.ErrorCodeToString(t)+" ("+a+")")},OnReadError:function(e,t,a){alert("Layer read error: "+window.MapCore.IMcErrors.ErrorCodeToString(t)+" ("+a+")")},OnNativeServerLayerNotValid:function(e,t){},OnRemoved:function(e,t,a){alert("Map layer has been removed")},OnReplaced:function(e,t,a,n){alert("Map layer has been replaced")},Release:function(){this.delete()}}),this.CCameraUpdateCallback=window.MapCore.IMcMapViewport.ICameraUpdateCallback.extend("IMcMapViewport.ICameraUpdateCallback",{OnActiveCameraUpdated:function(e){++this.uCameraUpdateCounter},Release:function(){this.delete()}}),this.CAsyncQueryCallback=window.MapCore.IMcSpatialQueries.IAsyncQueryCallback.extend("IMcSpatialQueries.IAsyncQueryCallback",{__construct:function(e){this.__parent.__construct.call(this),this.viewportData=e},OnTerrainHeightResults:function(e,t,a){null!=this.viewportData.viewport&&(this.viewportData.terrainCenter.z=t+20,this.viewportData.viewport.GetMapType()==window.MapCore.IMcMapCamera.EMapType.EMT_3D&&this.viewportData.viewport.SetCameraPosition(this.viewportData.terrainCenter)),this.delete()},OnTerrainHeightMatrixResults:function(e,t,a){},OnTerrainHeightsAlongLineResults:function(e,t,a){},OnExtremeHeightPointsInPolygonResults:function(e,t,a){},OnTerrainAnglesResults:function(e,t){},OnLineOfSightResults:function(e,t,a){},OnPointVisibilityResults:function(e,t,a){},OnAreaOfSightResults:function(e,t,a,n,o){},OnLocationFromTwoDistancesAndAzimuthResults:function(e){},OnError:function(e){alert("error "+e),this.delete()}});var e=window.MapCore.IMcUserData.extend("IMcUserData",{__construct:function(e){this.__parent.__construct.call(this),this.bToBeDeleted=e},__destruct:function(){this.__parent.__destruct.call(this)},Release:function(){this.bToBeDeleted&&this.delete()},Clone:function(){return this.bToBeDeleted?new e(this.bToBeDeleted):this}});this.layerCallback=new this.CLayerReadCallback}},{key:"calcMinMaxHeights",value:function(){var e=0,t=700,a=this.viewport.GetCameraFootprint();if(a.bUpperLeftFound&&a.bUpperRightFound&&a.bLowerRightFound&&a.bLowerLeftFound){var n={},o={};this.viewport.GetExtremeHeightPointsInPolygon([a.UpperLeft,a.UpperRight,a.LowerRight,a.LowerLeft],o,n)&&(e=n.Value.z,t=o.Value.z)}return{minHeight:e,maxHeight:t}}},{key:"createViewport",value:function(e,t){var a;this.state.bSameCanvas&&0!=this.aViewports.length?a=this.aViewports[0].canvas:((a=document.createElement("canvas")).addEventListener("wheel",this.mouseWheelHandler,!1),a.addEventListener("mousemove",this.mouseMoveHandler,!1),a.addEventListener("mousedown",this.mouseDownHandler,!1),a.addEventListener("mouseup",this.mouseUpHandler,!1),a.addEventListener("dblclick",this.mouseDblClickHandler,!1),a.addEventListener("touchstart",this.touchStartHandler,!1),a.addEventListener("touchend",this.touchEndHandler,!1),a.addEventListener("touchend",this.mouseDownHandler,!1),a.addEventListener("touchmove",this.touchMoveHandler,!1),a.addEventListener("touchcancel",this.touchCancelHandler,!1));var n=this.state.mapLayerGroups.get(this.state.lastTerrainConfiguration),o=new window.MapCore.IMcMapViewport.SCreateData(t);o.pDevice=this.device,o.pCoordinateSystem=null!=e?e.GetCoordinateSystem():this.overlayManager.GetCoordinateSystemDefinition(),o.pOverlayManager=this.overlayManager,o.hWnd=a,n.bShowGeoInMetricProportion&&(o.bShowGeoInMetricProportion=!0),this.viewport=window.MapCore.IMcMapViewport.Create(null,o,null!=e?[e]:null),this.editMode=window.MapCore.IMcEditMode.Create(this.viewport);var r=new this.CCameraUpdateCallback;this.viewport.AddCameraUpdateCallback(r),this.viewport.GetMapType()==window.MapCore.IMcMapCamera.EMapType.EMT_3D?(this.viewport.SetScreenSizeTerrainObjectsFactor(1.5),this.viewport.SetCameraRelativeHeightLimits(3,1e4,!0)):(this.viewport.SetStaticObjectsVisibilityMaxScale(50),n.InitialScale2D&&this.viewport.SetCameraScale(n.InitialScale2D)),this.viewport.SetBackgroundColor(window.MapCore.SMcBColor(70,70,70,255)),this.viewport.SetObjectsDelay(window.MapCore.IMcMapViewport.EObjectDelayType.EODT_VIEWPORT_CHANGE_OBJECT_UPDATE,!0,50),this.viewport.SetObjectsDelay(window.MapCore.IMcMapViewport.EObjectDelayType.EODT_VIEWPORT_CHANGE_OBJECT_CONDITION,!0,50),this.viewport.SetObjectsDelay(window.MapCore.IMcMapViewport.EObjectDelayType.EODT_VIEWPORT_CHANGE_OBJECT_SIZE,!0,5),this.viewport.SetObjectsDelay(window.MapCore.IMcMapViewport.EObjectDelayType.EODT_VIEWPORT_CHANGE_OBJECT_HEIGHT,!0,50),this.viewport.SetObjectsMovementThreshold(1),null!=e&&(this.viewport.SetTerrainNumCacheTiles(e,!1,300),this.viewport.SetTerrainNumCacheTiles(e,!0,300));var i=new SViewportData(this.viewport,this.editMode);i.terrain=e,n.bSetTerrainBoxByStaticLayerOnly&&(i.bSetTerrainBoxByStaticLayerOnly=!0),this.aViewports.push(i),document.getElementById("canvasesContainer").appendChild(a),this.activeViewport=this.aViewports.length-1,this.updateActiveViewport(),this.resizeCanvases(),this.trySetTerainBox()}},{key:"updateActiveViewport",value:function(){if(this.activeViewport>=0)for(var e=0;e<this.aViewports.length;++e)e==this.activeViewport&&(this.viewport=this.aViewports[e].viewport,this.editMode=this.aViewports[e].editMode,this.state.bSameCanvas)}},{key:"doPrevViewport",value:function(){this.aViewports.length>1&&(this.activeViewport=(this.activeViewport+this.aViewports.length-1)%this.aViewports.length,this.updateActiveViewport())}},{key:"doNextViewport",value:function(){this.aViewports.length>1&&(this.activeViewport=(this.activeViewport+1)%this.aViewports.length,this.updateActiveViewport())}},{key:"initializeViewports",value:function(){var e=this.mapTerrains.get(this.state.lastTerrainConfiguration);switch(void 0==e&&(this.aLastTerrainLayers.length>0?(e=window.MapCore.IMcMapTerrain.Create(this.lastCoordSys,this.aLastTerrainLayers)).AddRef():e=null,this.mapTerrains.set(this.state.lastTerrainConfiguration,e)),null==this.overlayManager&&(null==this.lastCoordSys&&(this.lastCoordSys=window.MapCore.IMcGridUTM.Create(36,window.MapCore.IMcGridCoordinateSystem.EDatumType.EDT_ED50_ISRAEL),this.lastCoordSys.AddRef()),this.overlayManager=window.MapCore.IMcOverlayManager.Create(this.lastCoordSys),this.overlayManager.AddRef(),this.overlay=window.MapCore.IMcOverlay.Create(this.overlayManager)),this.state.lastViewportConfiguration){case"2D/3D":this.createViewport(e,window.MapCore.IMcMapCamera.EMapType.EMT_2D),this.createViewport(e,window.MapCore.IMcMapCamera.EMapType.EMT_3D),this.DoPrevViewport();break;case"3D/2D":this.state.bSameCanvas?(this.createViewport(e,window.MapCore.IMcMapCamera.EMapType.EMT_2D),this.createViewport(e,window.MapCore.IMcMapCamera.EMapType.EMT_3D)):(this.createViewport(e,window.MapCore.IMcMapCamera.EMapType.EMT_3D),this.createViewport(e,window.MapCore.IMcMapCamera.EMapType.EMT_2D),this.doPrevViewport());break;case"2D":this.createViewport(e,window.MapCore.IMcMapCamera.EMapType.EMT_2D);break;case"3D":this.createViewport(e,window.MapCore.IMcMapCamera.EMapType.EMT_3D)}try{this.viewport.SetDtmTransparencyWithoutRaster(!0)}catch(t){if(!(t instanceof window.MapCoreError))throw t;alert("MapCore Error #"+t.name+": "+t.message)}requestAnimationFrame(this.renderMapContinuously)}},{key:"createMapLayersAndViewports",value:function createMapLayersAndViewports(){if(void 0==this.mapTerrains.get(this.state.lastTerrainConfiguration)){this.aLastTerrainLayers=[];var group=this.state.mapLayerGroups.get(this.state.lastTerrainConfiguration);this.lastCoordSys=eval(group.coordSystemString);for(var i=0;i<group.aLayerCreateStrings.length;++i){var layer=eval(group.aLayerCreateStrings[i]);this.aLastTerrainLayers.push(layer),layer instanceof window.MapCore.IMc3DModelMapLayer&&(layer.SetDisplayingItemsAttachedToTerrain(!0),layer.SetDisplayingDtmVisualization(!0),layer.SetResolvingConflictsWithDtmAndRaster(!0))}this.lastCoordSys.AddRef()}this.initializeViewports()}},{key:"openMap",value:function(){var e=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__.a)(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function e(t,a){var n,o,r,i=this;return C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=_ExternalConfigurationHandler__WEBPACK_IMPORTED_MODULE_13__.a.getConfiguration().MAPCORE_LAYER_SERVER_URL)){e.next=14;break}return e.prev=2,e.next=5,axios__WEBPACK_IMPORTED_MODULE_10___default.a.get(n+_config__WEBPACK_IMPORTED_MODULE_11__.a.urls.getCapabilities);case 5:o=e.sent,r=(new DOMParser).parseFromString(o.data,"text/xml"),this.parseCapabilitiesXML(r,_config__WEBPACK_IMPORTED_MODULE_11__.a.urls.getCapabilities),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(2);case 12:e.next=15;break;case 14:this.parseLayersConfiguration([this.props.mapToShow]);case 15:this.state.mapLayerGroups.forEach((function(e,n){n===t&&i.setState({lastTerrainConfiguration:n,lastViewportConfiguration:a?"3D":"2D"},(function(){if(null===i.device){var e=new window.MapCore.IMcMapDevice.SInitParams;e.uNumTerrainTileRenderTargets=100;var t=window.MapCore.IMcMapDevice.Create(e);t.AddRef(),i.device=t,i.createCallbackClasses()}i.createMapLayersAndViewports()}))}));case 16:case"end":return e.stop()}}),e,this,[[2,10]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"doDtmVisualization",value:function(){if(this.viewport.GetDtmVisualization())this.viewport.SetDtmVisualization(!1);else{var e=this.calcMinMaxHeights(),t=new window.MapCore.IMcMapViewport.SDtmVisualizationParams;window.MapCore.IMcMapViewport.SDtmVisualizationParams.SetDefaultHeightColors(t,e.minHeight,e.maxHeight),t.bDtmVisualizationAboveRaster=!0,t.uHeightColorsTransparency=120,t.uShadingTransparency=255,this.viewport.SetDtmVisualization(!0,t)}}},{key:"closeMap",value:function(){if(!(this.activeViewport<0)){if(this.editMode.Destroy(),this.viewport.Release(),!this.bSameCanvas||1==this.aViewports.length){var e=this.aViewports[this.activeViewport].canvas;e.removeEventListener("wheel",this.mouseWheelHandler,!1),e.removeEventListener("mousemove",this.mouseMoveHandler,!1),e.removeEventListener("mousedown",this.mouseDownHandler,!1),e.removeEventListener("mouseup",this.mouseUpHandler,!1),e.removeEventListener("dblclick",this.mouseDblClickHandler,!1),e.removeEventListener("touchstart",this.touchStartHandler,!1),e.removeEventListener("touchend",this.touchEndHandler,!1),e.removeEventListener("touchmove",this.touchMoveHandler,!1),e.removeEventListener("touchcancel",this.touchCancelHandler,!1),document.getElementById("canvasesContainer").removeChild(this.aViewports[this.activeViewport].canvas)}this.aViewports.splice(this.activeViewport,1),0==this.aViewports.length?(this.viewport=null,this.editMode=null,this.activeViewport=-1,this.mapTerrains.forEach((function(e){e.Release()})),this.mapTerrains.clear(),this.overlayManager.Release(),this.overlayManager=null):(this.activeViewport>=this.aViewports.length&&(this.activeViewport=this.aViewports.length-1),this.updateActiveViewport(),this.resizeCanvases()),this.setState({mapLayerGroups:new Map,lastTerrainConfiguration:null,lastViewportConfiguration:null,bSameCanvas:!0}),this.mapTerrains=new Map,this.device=null,this.viewportData=null,this.aLastTerrainLayers=[],this.lastCoordSys=null,this.overlayManager=null,this.activeViewport=-1,this.aViewports=[],this.lastRenderTime=(new Date).getTime(),this.lastMemUsageLogTime=(new Date).getTime(),this.uMemUsageLoggingFrequency=0,this.nMousePrevX=0,this.nMousePrevY=0,this.mouseDownButtons=0,this.bEdit=!1}}},{key:"renderLoadingMessage",value:function(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsx)("div",{className:_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.LoadingMessage,children:"Map core SDK is Loading..."})}},{key:"renderRow",value:function(e,t){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsxs)("div",{className:_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.DescRow,children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsxs)("span",{className:_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.DescLabel,children:[e,":"]}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsx)("span",{className:_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.DescValue,children:t})]})}},{key:"renderMapToolbox",value:function(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsxs)("div",{className:"".concat(_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.MapToolbox),children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsx)("div",{className:_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.Description,children:this.props.mapToShow.groupName}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsx)("span",{className:_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.SwithViewBtn,onClick:this.props.toggleBetweenMapToTabs}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsx)("span",{className:_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.MoreActionsBtn,onClick:this.onMoreActionsClick})]})}},{key:"renderSwitchMapForm",value:function(){var e=this,t=this.state.isSwitchMapFormOpen?_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.Open:"";return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsx)("div",{className:"".concat(_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.SwitchMapForm," ").concat(t),children:t?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsx)(_SwitchMapForm_SwitchMapForm__WEBPACK_IMPORTED_MODULE_16__.a,{onCancel:function(){return e.setState({isSwitchMapFormOpen:!1})}}):null})}},{key:"getCanvas",value:function(){var e=this.props.isPointSelectionMode?{zIndex:100,width:"100%"}:{};return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsxs)("div",{className:_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.MapWrapper,style:e,children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsx)("div",{className:_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.CanvasContainer,id:"canvasesContainer"}),this.renderMapToolbox(),this.renderSwitchMapForm()]})}},{key:"render",value:function(){var e=this.props.appPrimaryUiElement===_store_reducers_layoutReducer__WEBPACK_IMPORTED_MODULE_19__.a.tabs?_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.SmallMap:"";return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_20__.jsx)("div",{className:"".concat(_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.Wrapper," ").concat(e),children:this.props.isMapCoreSDKLoaded?this.getCanvas():this.renderLoadingMessage()})}}]),MapContainer}(react__WEBPACK_IMPORTED_MODULE_8__.PureComponent),mapStateToProps=function(e){return{isMapCoreSDKLoaded:e.map.isMapCoreSDKLoaded,mapToShow:e.map.mapToShow,dronesPositions:e.map.dronesPositions,isPointSelectionMode:e.layout.isPointSelectionMode,savedMissionPlan:e.planner.savedMissionPlan,draftMissionStages:e.planner.draftMissionStages,viewerState:e.planner.viewerState,selectedDrone:e.map.selectedDrone,appPrimaryUiElement:e.layout.appPrimaryUiElement}},mapDispachToProps=function(e){return{showContextMenu:function(t,a,n){return e({type:_store_actions_actionTypes__WEBPACK_IMPORTED_MODULE_14__.a.SHOW_CONTEXT_MENU,payload:{x:t,y:a,items:n}})},closeContextMenu:function(){return e({type:_store_actions_actionTypes__WEBPACK_IMPORTED_MODULE_14__.a.CLOSE_CONTEXT_MENU})},showPopup:function(t){return e({type:_store_actions_actionTypes__WEBPACK_IMPORTED_MODULE_14__.a.SHOW_POPUP,payload:t})},saveOriginCoordinate:function(t,a){return e({type:_store_actions_actionTypes__WEBPACK_IMPORTED_MODULE_14__.a.SAVE_ORIGIN_COORDINATE,payload:{coordinate:t,angle:a}})},deleteDronePosition:function(){return e({type:_store_actions_actionTypes__WEBPACK_IMPORTED_MODULE_14__.a.DELETE_DRONE_POSITION})},togglePointSelectionMode:function(){return e({type:_store_actions_actionTypes__WEBPACK_IMPORTED_MODULE_14__.a.TOGGLE_POINT_SELECTION_MODE})},setPositionToPopup:function(t){return e({type:_store_actions_actionTypes__WEBPACK_IMPORTED_MODULE_14__.a.SELECT_POINT_FROM_MAP,payload:{position:t}})},toggleBetweenMapToTabs:function(){return e({type:_store_actions_actionTypes__WEBPACK_IMPORTED_MODULE_14__.a.TOGGLE_MAP_AND_OUTPUT_TABS})}}};__webpack_exports__.a=Object(react_redux__WEBPACK_IMPORTED_MODULE_12__.b)(mapStateToProps,mapDispachToProps)(MapContainer)},function(e,t){},,function(e,t,a){"use strict";var n=a(6),o=a(8),r=a(12),i=a(11),s=a(1),c=a.n(s),l=a(50),p=a.n(l),u=a(3),_=a(17),d=a(21),O=a(73),m=a.n(O),h=a(0),M=function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return Object(h.jsxs)("div",{className:m.a.Wrapper,children:[this.props.label?Object(h.jsx)("legend",{className:m.a.Label,children:this.props.label}):null,Object(h.jsx)("div",{className:m.a.RadioGroupValuesWrapper,children:this.props.children.map((function(e,t){return c.a.cloneElement(e,{key:t,onClick:function(){return e.props.onClick(t)},isChecked:e.props.isChecked,radioIndex:t})}))})]})}}]),a}(s.Component),b=a(58),S=a(68),g=a.n(S),f=function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(e){var o;return Object(n.a)(this,a),(o=t.call(this,e)).state={isChecked:o.props.isChecked},o.onRadioClick=o.onRadioClick.bind(Object(b.a)(o)),o}return Object(o.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState({isChecked:e.isChecked})}},{key:"onRadioClick",value:function(e){e&&e.preventDefault(),this.setState({isChecked:!this.state.isChecked}),this.props.onClick&&this.props.onClick(this.props.radioIndex)}},{key:"render",value:function(){return Object(h.jsxs)("label",{htmlFor:this.props.id,className:g.a.radio,onClick:this.onRadioClick,children:[Object(h.jsx)("input",{className:g.a.radio__input,type:"radio",id:this.props.id,checked:this.props.isChecked,readOnly:!0}),Object(h.jsx)("div",{className:g.a.radio__radio}),Object(h.jsx)("span",{className:g.a.Label,title:this.props.label,children:this.props.label})]})}}]),a}(s.Component),E=function(e){Object(r.a)(a,e);var t=Object(i.a)(a);function a(){var e;Object(n.a)(this,a);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={isShown:!1,selectedGroup:e.props.currentShownMap},e.onMapSelection=function(){e.state.selectedGroup.groupName!==e.props.currentShownMap.groupName&&e.props.setMapToShow(e.state.selectedGroup),e.props.onCancel()},e}return Object(o.a)(a,[{key:"renderHeader",value:function(){return Object(h.jsx)("div",{className:p.a.Header,children:"Select Map to Show:"})}},{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){return e.setState({isShown:!0})}),300)}},{key:"selectMapRadioButton",value:function(e){this.setState({selectedGroup:e})}},{key:"renderBody",value:function(){var e=this,t=d.a.getConfiguration().streamingLayers;return Object(h.jsx)("div",{className:p.a.Body,children:Object(h.jsx)(M,{children:t.map((function(t,a){return Object(h.jsx)(f,{id:t.groupName,isChecked:t.groupName===e.state.selectedGroup.groupName,label:t.groupName,onClick:function(){return e.selectMapRadioButton(t)}},a)}))})})}},{key:"renderFooter",value:function(){return Object(h.jsxs)("div",{className:p.a.Footer,children:[Object(h.jsx)("button",{className:"".concat(p.a.Button," ").concat(p.a.Apply),onClick:this.onMapSelection,children:"Select"}),Object(h.jsx)("button",{className:"".concat(p.a.Button),onClick:this.props.onCancel,children:"Cancel"})]})}},{key:"render",value:function(){var e=this.state.isShown?p.a.Shown:"";return Object(h.jsxs)("div",{className:"".concat(p.a.Wrapper," ").concat(e),children:[this.renderHeader(),this.renderBody(),this.renderFooter()]})}}]),a}(s.Component);t.a=Object(_.b)((function(e){return{currentShownMap:e.map.mapToShow}}),(function(e){return{setMapToShow:function(t){return e({type:u.a.SET_MAP_TO_SHOW,payload:t})}}}))(E)},,,,,function(e,t,a){}],[[32,1,2]]]);
//# sourceMappingURL=main.071fe76c.chunk.js.map