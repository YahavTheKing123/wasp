{"version":3,"sources":["store/actions/actionTypes.js","App.module.css","config.js","components/MissionPlanner/MissionPlanner.module.css","components/ActionButtons/ActionButtons.module.css","services/index.js","store/actions/mapActions.js","utils/imageUtils.js","store/actions/layoutActions.js","store/actions/videoActions.js","store/actions/plannerActions.js","store/actions/index.js","components/Video/Video.module.css","components/OutputTabs/OutputTabs.module.css","components/Popup/Popup.module.css","rosWebsocket.js","ExternalConfigurationHandler.js","components/controls/Input/Input.module.css","utils/geoCalculations.js","components/MissionPlanner/MissionPlanStages/MissionPlanStages.module.css","assets/images/newLogo.svg","components/LoaderAlt/LoaderAlt.js","components/Clock/Clock.js","assets/images/close.svg","components/controls/Input/Input.js","components/SingleInputForm/SingleInputForm.js","components/controls/Select/reactSelectStyles.js","components/controls/Select/Select.js","components/Popup/PopupChildren.js","components/MissionPlanner/AddMissionPlanStageForm/AddMissionPlanStageForm.js","components/Popup/Popup.js","assets/images/infoFull.svg","assets/images/success.svg","assets/images/errorIcon.svg","assets/images/warnIcon.svg","components/GlobalMessage/GlobalMessage.js","components/ContextMenu/ContextMenu.js","components/FlightTelemetry/FlightTelemetry.js","assets/images/target.svg","components/controls/Slider/Slider.js","components/Video/Video.js","assets/EnemySpotted.mp3","assets/images/WeaponDetection.png","assets/images/armedRed.svg","components/OutputTabs/OutputTabs.js","components/ActionButtons/ActionButtons.js","components/Main/Main.js","components/MissionPlanner/MissionPlanStages/MissionPlanStage.js","components/MissionPlanner/MissionPlanStages/MissionPlanStages.js","store/reducers/plannerReducer.js","components/MissionPlanner/MissionPlanner.js","App.js","store/reducers/mapReducer.js","store/reducers/videoReducer.js","store/reducers/outputReducer.js","store/reducers/layoutReducer.js","store/reducers/index.js","store/interceptor.js","index.js","components/MapContainer/MapContainer.module.css","components/LoaderAlt/LoaderAlt.module.css","components/MissionPlanner/AddMissionPlanStageForm/AddMissionPlanStageForm.module.css","components/ContextMenu/ContextMenu.module.css","components/Main/Main.module.css","components/SwitchMapForm/SwitchMapForm.module.css","components/controls/Slider/Slider.module.css","components/FlightTelemetry/FlightTelemetry.module.css","components/controls/Select/Select.module.css","components/GlobalMessage/GlobalMessage.module.css","components/controls/Radio/Radio.module.css","components/controls/RadioGroup/RadioGroup.module.css","components/Clock/Clock.module.css","components/Error/Error.module.css","components/MapContainer/MapContainer.js","components/controls/RadioGroup/RadioGroup.js","components/controls/Radio/Radio.js","components/SwitchMapForm/SwitchMapForm.js"],"names":["actionTypes","PAUSE_VIDEO","RESUME_VIDEO","LOACTE_START","LOACTE_SUCCESS","LOACTE_FAILED","RESET_START","RESET_SUCCESS","RESET_FAILED","TAKE_OFF_START","TAKE_OFF_SUCCESS","TAKE_OFF_FAILED","SET_EXPOSURE_START","SET_EXPOSURE_SUCCESS","SET_EXPOSURE_FAILED","START_INDOOR_EXPLORATION","SET_INDOOR_EXPLORATION_FLAG","REMOVE_INDOOR_EXPLORATION_FLAG","SET_MISSION_STATE","GO_TO_LOCATION_START","GO_TO_LOCATION_SUCCESS","GO_TO_LOCATION_FAILED","POINT_ON_VIDEO_IMAGE_START","POINT_ON_VIDEO_IMAGE_SUCCESS","POINT_ON_VIDEO_IMAGE_FAILED","ROSS_WEBSOCKET_CONNECTION_SUCCESS","ROSS_WEBSOCKET_CONNECTION_FAILED","ROSS_WEBSOCKET_CONNECTION_CLOSED","ROSS_WEBSOCKET_CONNECTION_START","SHOW_GLOBAL_MESSAGE","REMOVE_GLOBAL_MESSAGE","SHOW_CONTEXT_MENU","CLOSE_CONTEXT_MENU","SHOW_POPUP","HIDE_POPUP","IMAGE_SENT_TO_DRONE","SHOW_MISSION_PLANNER_SCREEN","HIDE_MISSION_PLANNER_SCREEN","SET_MAPCORE_SDK_LOADED_FLAG","SET_MAP_TO_SHOW","GET_DRONE_POSITION_OFFSET","GET_ENEMY_POSITION","SAVE_DRONE_LAST_POSITION","SAVE_ORIGIN_COORDINATE","TOGGLE_POINT_SELECTION_MODE","SELECT_POINT_FROM_MAP","UPDATE_SKELETON_RANGE","SET_WEAPON_DETECTION","ADD_NEW_MISSION_PLAN_STAGE","DELETE_MISSION_PLAN_STAGE","EDIT_MISSION_PLAN_STAGE","MOVE_UP_MISSION_PLAN_STAGE","MOVE_DOWN_MISSION_PLAN_STAGE","SAVE_MISSION_PLAN","REMOVE_DRAFT_MISSION_PLAN","REMOVE_SAVED_MISSION_PLAN","TOGGLE_MISSION_PLAN_VIEWER_STATE","LOAD_DEFAULT_PLAN","module","exports","logSeverities","success","info","warn","error","config","urls","getCapabilities","configuration","loadMission","videoStream","videoSnapshot","skeletonStream","skeletonSnapshot","windowDetectionStream","windowDetectionSnapshot","MIN_DRONE_DISTANCE_MOVE","EXPOSURE_MAX_LEVEL","COORDINATE_DECIMALS_PRECISION","DEFAULT_MISSION_POINT_HEIGHT","getService","serviceName","pointingFingerEncode","window","ROSLIB","Service","ros","rosWebSocket","getRosWebsocketObject","name","serviceType","pointingFingerLocate","pointingFingerReset","seekerReset","seekerTakeoff","startIndoorExploration","flyToTopic","Topic","messageType","setExposure","getDronePosition","TFClient","fixedFrame","angularThres","transThres","getDroneExploreState","getSkeletonRange","doMissionReset","doMissionExecute","addMissionTakeoff","addMissionWP","subscribeToDroneData","console","log","dispatch","a","subscribe","response","type","payload","dronePositionOffset","translation","droneRotationQuaternion","rotation","getBase64Image","img","dataURL","naturalWidth","naturalHeight","canvas","document","createElement","width","height","getContext","drawImage","toDataURL","alert","showGlobalMessage","text","isRemoved","setTimeout","locate","getElementById","imgURL","image","dataX","replace","imageMessage","Message","data","format","requestLocate","ServiceRequest","callService","result","isSuccess","pointVideoImage","ev","adjustedX","pageX","getBoundingClientRect","x","adjustedY","pageY","y","roundedX","Math","round","roundedY","point","pointMessage","z","requestEncode","reset","requestReset","takeoff","requestTakeoff","requestIndoorExplorationFlag","goToLocation","location","split","parseFloat","publish","exposureVal","bools","strs","doubles","groups","ints","value","subscribeToSkeletonRange","range","toFixed","skeletonRange","subscribeToWeaponDetection","missionState","startsWith","weaponDetected","asyncCallRossService","params","Promise","resolve","reject","runSavedMissionPlan","getState","requestMissionReset","missionStages","planner","savedMissionPlan","workingOrigin","map","stage","rossService","selectedStageType","stageParamsInput","offset","geoCalculations","coordinate","offsetWithAngle","angle","droneOffset","serviceRequest","requestMissionExecute","importMissionFromDroneFile","axios","get","importMissionFromPcFile","missionData","e","exportPlanToFile","plan","viewerState","url","encodeURIComponent","JSON","stringify","downloadAnchor","setAttribute","body","appendChild","click","remove","actionCreators","output","video","layout","RosWebSocket","RECONNECT_TIMEOUT","reRegister","register","externalConfig","getConfiguration","ROS_BE_PROTOCOL","BE_IP","ROS_BE_PORT","store","actions","this","Ros","on","ExternalConfigurationHandler","externalConfigurationHandler","calculateDistanceBetween2Points","p1","p2","b","c","sqrt","getMapCoordinate","c1","c2","mapOffset","convertMapOffsetToDroneOffset","calculateOffsetWithAngle","radians","PI","cos","sin","parseInt","convertDroneOffsetToMapOffset","getCoordinatesOffset","originCoordinate","roundCoordinate","precision","multiplier","pow","quaternionToYaw","q","undefined","atan2","w","Loader","props","withOverlay","className","classNames","Overlay","renderOverlay","loader","data-message","loadingMessage","bg","circle","PureComponent","Clock","state","date","Date","setInterval","setState","year","getFullYear","month","toLocaleString","day","getDate","DateTime","Hour","toLocaleTimeString","navigator","language","hour12","Input","isShowInfoTooltip","showInfoTooltip","clientX","target","left","clientY","top","hideTooltip","getInputByType","cn","InnerInputWrapper","button","Icon","PositionIcon","title","onClick","action","getInputField","placeHolder","InfoImage","onMouseEnter","onMouseLeave","mandatoyClass","mandatory","Mandatory","disabled","Disabled","errorClass","ShowError","readOnly","Row","Label","label","renderInfo","InputWrapper","ref","parentRef","placeholder","maxLength","onFocus","onChange","ValidationMessage","Component","SingleInputForm","inputRef","React","createRef","onValueChange","newValue","current","focus","Wrapper","defaultValue","connect","ownProps","DropdownIndicator","DropDownArrow","dropDownStyles","container","provided","cursor","isDisabled","fontSize","fontWeight","lineHeight","color","background","border","borderRadius","textTransform","option","backgroundColor","whiteSpace","overflow","textOverflow","isSelected","isFocused","control","minHeight","borderColor","boxShadow","menu","paddingTop","marginTop","maxHeight","valueContainer","indicatorSeparator","display","dropdownIndicator","defaultStyles","singleValue","noOptionsMessage","CustomSelect","styles","components","DropDownWrapper","ComboLabel","popupChildren","AddMissionPlanStageForm","parseMultiParams","getMissionPlanState","subField","onInputChange","multiParamsInput","stageId","random","onPopupInitalLoad","prevProps","pointFromMap","dropDownData","options","isMultiInputs","selectedTypeValue","handleTypeChange","selectPointFromMap","renderStageType","renderStageInput","Popup","EscKey","EnterKey","handleKeyDown","keyCode","closePopup","popupDetails","primayButton","callback","onCloseButtonClick","hidePopup","onCloseBtnClick","preventDefault","onPrimaryBtnClick","onSecondaryBtnClick","secondaryButton","addEventListener","removeEventListener","hideXButton","Close","href","closeBtn","src","closeImg","primaryButton","Btn","BtnPrimary","FormButton","Apply","PopupFooter","renderButtons","PopupHeader","PopupHeaderWrapper","h2","getXBtn","Child","PopupChildren","modalChild","modalChildProps","noBodyOverflowClass","noBodyOverflow","NoBodyOverFlow","PopupBody","renderChild","visibility","isPointSelectionMode","size","style","getHeader","getBody","getFooter","GlobalMessage","icon","appGlobalMessage","infoIcon","successIcon","warnIcon","errorIcon","Text","notification","missionPlannerOpenClass","isMissionPlanScreenHidden","MissionPlannerOpen","renderIcon","renderText","renderNotification","ContextMenu","CONTEXT_MENU_WIDTH","contextRef","menuItems","closeContextMenu","contains","onItemClick","menuItem","func","task","updatePosition","contextMenu","items","menuHight","length","offsetHeight","getNewTop","offsetWidth","closeClass","side","index","iconCss","ContextMenuIcon","menuName","contextMenuUL","FlightTelemetry","TelemetryWrapper","getAltitue","Units","Slider","componentDidUpdate","prevState","dragging","onMouseMove","onMouseUp","getOffset","prevOffset","onMouseDown","startY","stopPropagation","onLineClick","offsetY","prevPos","sliderLine","sliderOffset","moveDraggable","sliderWrapper","mapslider","buttons","dragline","line","draggablebutton","Video","isImageLoadingError","isImageLoading","isFullScreen","targetPosition","showTarget","showExposure","isRecording","onVideoError","setTargetPosition","rect","onVideoLoaded","onPauseOrPlayClick","isPaused","resume","pause","onFullScreenClick","elem","querySelector","requestFullscreen","webkitRequestFullscreen","msRequestFullscreen","onExitFullScreenClick","fullscreenElement","exitFullscreen","webkitExitFullscreen","msExitFullscreen","getRecordButton","RecordindIcon","RecordIcon","getRecordTitle","BE_PORT","snapshotUrl","streamUrl","Play","Pause","hideTargetClass","HideTarget","VideoHeader","Description","StreamingIconWrapper","StreamingIcon","Exposure","ToggleTarget","getPlayOrPauseTitle","ControlBtn","getPlayOrPauseButton","RecordButton","ExitFullScreen","FullScreen","exposureValue","ErrorMessage","ErrorIcon","largeTarget","TargetLarge","renderVideoHeader","TargetIcon","targetIcon","updateExposure","crossOrigin","onLoad","onError","VideoImage","getVideoSrc","id","renderVideoFooter","fullHeightClass","FullHeight","renderImgElement","OutputTabs","onImageLoaded","imageSentToDroneData","tabsWrapper","xFactor","yFactor","pointPosition","onToggleTabClick","selectedTab","renderTabsToggle","tabslidernav","tabslidertabs","tabslidertrigger","TabSelected","showCapture","EnemySpotted","Audio","EnemySpottedSound","onload","play","indoorExplorationFlag","imageElement","pointElement","imageDataUrl","OutputImage","Point","renderTabs","renderNoOutputReceived","weaponDetectedClass","WeaponDetected","SkeletonTab","getSkeletonVideoSrc","AlertIcon","ArmedRed","SkeletonRange","WindowTab","getWindowDetectionVideoSrc","getCaptureTab","getSkeletonTab","getWindowDetectionTab","Tabs","getSelectedTab","tabs","ActionButtons","tempLocationValue","onGoToLocationPopupOkBtnClick","showPopup","PlayIcon","PauseIcon","isHiddenClass","isRosWebsocketConncted","Hidden","Button","TakeoffIcon","ButtonLabel","Clicked","IndoorExploration","LocateIcon","SetLocationIcon","ResetIcon","RunPlanIcon","restart","details","Main","MapContainer","RightPaneWrapper","RightPaneWrapperItem","MainContentWrapper","Split","Left","getMainLeftPane","Right","getMainRightPane","getActionButtons","MissionPlanStage","addOrEditMissionPlanStageFormPopupOkBtnClick","isAddStage","addOrEditStageFormState","getAddMissionPlanStageFormState","addNewStage","editStage","stageIndex","togglePointSelectionMode","onAddOrEditStageBtnClicked","getChildState","onMenuBtnClick","menuItemsList","deleteStage","moveStageDown","moveStageUp","showContextMenu","BtnIconWrapper","BtnIconBall","isShowAddStageBtn","AddNewStageBtn","isShowMenu","MenuBtn","renderMenuBtnIcon","StageWrapper","renderMenuBtn","LabelsWrapper","StageTypeLabel","StageParamsLabel","renderAddNewStageBtn","MissionPlanStages","Arrow","isReadOnly","MissionStagesWrapper","i","Fragment","renderArrow","viewerStates","initialState","draftMissionStages","immutablySwapItems","firstIndex","secondIndex","element","plannerReducer","filter","slice","currentStageIndex","parse","MissionPlanner","addMissionPlanStageFormPopupOkBtnClick","addStageState","onStartNewMissionClick","onBackBtnClick","hideMissionPlannerScreen","onSaveBtnClick","saveMissionPlan","onClearDraftBtnClick","removeDraftPlan","onRemoveSavedPlanBtnClick","removeSavedPlan","onLoadMissionFromDroneBtnClick","onLoadMissionFromPcBtnClick","parseConfigurationFile","fileReader","FileReader","files","readAsText","onerror","onExportMissionBtnClick","onSwitchViewStateClick","toggleViewerState","StartNewBtn","renderStartNewMissionButton","EmptyPlanStagesMessage","push","SideBarBtn","Save","ClearStages","Export","Import","Remove","onLoadMissionBtnClick","ClosePlanner","renderDraftButtons","renderSavedPlanButtons","SideBar","SideBarButtons","SidebarLabel","DraftIcon","SavedPlanIcon","Header","HeaderTextWrapper","HeaderTextState","HeaderBtnWrapper","getSwithBtnTitle","HeaderBtn","centerClass","Center","renderSideBar","renderHeader","renderMissionPlanStages","accept","withRouter","App","disableZoomInTouchScreen","touches","closeErrorPopup","generalErrorMessage","onMoreActionsClick","showMissionPlannerScreen","MapCore","SetStartCallbackFunction","setMapCoreSDKLoadedFlag","defaultGroup","streamingLayers","setMapToShow","passive","AppHeader","LogoWrapper","history","logo","alt","VersionText","HeaderLeftWrapper","HeaderItem","DroneIcon","LongLatWrapper","MissionWrapper","lonLatLabel","lonLatValue","MissionValueWrapper","MissionValue","formatPosition","lastPosition","CompassIcon","WifiIcon","BatteryIcon","BatteryValue","getClock","MenuIcon","isLoading","plannerHiddenClass","MissionPlannerHidden","getGeneralErrorPopup","getMainHeader","MissionPlannerOverlay","groupNode","isMapCoreSDKLoaded","mapToShow","droneMoveOffset","enemyPositionOffset","mapReducer","enemyPosition","videoReducer","outputReducer","TOGGLE_SIDE_BAR","toasts","t","alwaysOnTop","layoutReducer","rootReducer","combineReducers","initInterceptor","interceptors","use","err","isCancel","errorMessage","errMsg","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","createStore","applyMiddleware","reduxThunk","ReactDOM","render","StrictMode","then","res","setConfiguration","rosWebsocketInstance","catch","SLayerGroup","coordSystemString","bShowGeoInMetricProportion","bSetTerrainBoxByStaticLayerOnly","InitialScale2D","aLayerCreateStrings","SViewportData","_viewport","_editMode","viewport","editMode","GetWindowHandle","aViewportTerrains","GetTerrains","aLayers","GetLayers","terrainBox","terrainCenter","rotationCenter","bCameraPositionSet","mapLayerGroups","Map","lastTerrainConfiguration","lastViewportConfiguration","bSameCanvas","isDTMClicked","is3DClicked","isSwitchMapFormOpen","workingOriginSelected","mapTerrains","device","viewportData","uCameraUpdateCounter","aLastTerrainLayers","lastCoordSys","overlayManager","activeViewport","aViewports","lastRenderTime","getTime","lastMemUsageLogTime","uMemUsageLoggingFrequency","nMousePrevX","nMousePrevY","mouseDownButtons","bEdit","layerCallback","requestAnimationFrameId","aPositions","aObjects","droneScheme","lineScheme","textScheme","locationScheme","pinPointScheme","WorldPictureScheme","ScreenPictureScheme","TempOriginAngle","WorkingOrigin","DroneRouteCoordinates","DroneObject","DroneRouteObject","SelectedMissionPointObject","MissionPointsObjects","MapObjectType","Object","freeze","RemoveDroneData","saveOriginCoordinate","CreateMapcoreObjects","LoadMapcoreObject","StartEditMode","ID","pItem","GetNodeByID","pObject","IMcObject","Create","overlay","SetID","StartInitObject","selectMissionPointFromMap","SetWorkingOrigin","MoveDrone","coordinateWithOffset","prevCoordinate","UpdateLocationPoints","SetFloatProperty","SetLocationPoints","saveDroneLastCoordinate","DrawDroneObjects","OnEditClickWorkingOrigin","GetLocationPoints","SetTextureProperty","IMcImageFileTexture","SMcFileSource","OnEditClickMissionPoint","locationPoints","renderMapContinuously","trySetTerainBox","currtRenderTime","Render","IMcMapViewport","RenderAll","IMcMapDevice","GetMaxMemoryUsage","GetHeapSize","requestAnimationFrame","j","aViewportLayers","SMcBox","DBL_MAX","GetLayerType","IMcNativeStaticObjectsMapLayer","LAYER_TYPE","IsInitialized","layerBox","GetBoundingBox","MinVertex","MaxVertex","SMcVector3D","GetMapType","IMcMapCamera","EMapType","EMT_2D","SetCameraPosition","IMcSpatialQueries","SQueryParams","eTerrainPrecision","EQueryPrecision","EQP_HIGH","pAsyncQueryCallback","CAsyncQueryCallback","GetTerrainHeight","resizeCanvases","CanvasesInRow","ceil","ViewportResized","doDtmVisualization","GetDtmVisualization","SetDtmVisualization","calcMinMaxHeights","DtmVisualization","SDtmVisualizationParams","SetDefaultHeightColors","bDtmVisualizationAboveRaster","uHeightColorsTransparency","uShadingTransparency","mouseWheelHandler","bHandled","wheelDelta","deltaY","OnMouseEvent","IMcEditMode","EMouseEvent","EME_MOUSE_WHEEL","SMcPoint","ctrlKey","Value","factor","shiftKey","EMT_3D","MoveCameraRelativeToOrientation","fScale","GetCameraScale","SetCameraScale","cancelBubble","mouseMoveHandler","isTouch","EventPixel","offsetX","targetTouches","eCursor","EME_MOUSE_MOVED_BUTTON_DOWN","EME_MOUSE_MOVED_BUTTON_UP","RotateCameraRelativeToOrientation","SetCameraOrientation","FLT_MAX","ScrollCamera","mouseDownHandler","IsEditingActive","updateActiveViewport","changedTouches","EME_BUTTON_PRESSED","mouseUpHandler","EME_BUTTON_RELEASED","mouseDblClickHandler","aTargets","ScanInGeometry","SMcScanPointGeometry","EMcPointCoordSystem","EPCS_SCREEN","eTargetType","EIntersectionTargetType","EITT_OVERLAY_MANAGER_OBJECT","StartEditObject","ObjectItemData","EME_BUTTON_DOUBLE_CLICK","getID","stopEvent","touchStartHandler","_onMouseDownX","_onMouseDownY","screenToWorld","screenPoint","worldPoint","ScreenToWorldOnTerrain","ScreenToWorldOnPlane","ret","withoutConvert","worldToScreen","srcCoords","native","WorldToScreen","inScreen","_canvas","moveCameraRelativeToOrientation","moveX","moveY","ignorePitch","useHeightFactor","currentPosition","GetCameraPosition","heightDiff","abs","getCameraOrientation","azimuth","pitch","azimuthOrientation","pitchOrientation","GetCameraOrientation","setCameraOrientation","cameraOrientationAzimuth","cameraOrientationPitch","rollOrientation","azimuthToSet","pitchToSet","isGeoCoordValid","coord","isNative","DEG_TO_MC","isValid","coordFactor","Number","MAX_VALUE","rotateCameraAroundWorldPoint","azimuthDelta","azimuthPitch","watchRoll","currentAzimuth","currentPitch","currentRoll","RotateCameraAroundWorldPoint","newRoll","rotateCameraRelativeToOrientation","getCameraScale","convertToMeters","GetPixelPhysicalHeight","setCameraScale","scale","factorFor3D","camPosition","zoomSign","mapScaleTopLimit","cameraScaleChanged","pixelPhysicalHeight","ratio","updatePositionText","updateHeight","heightForQuery","lonNew","latNew","positionToCheck","exp","lastUpdatedHeight","zoomIn","amount","duration","currentScale","lastClickPos","zoomOut","handleZoomOrRotate","xDistance","screenX","yDistance","screenY","currentDistance","lastTouchDistance","prevAverageX","prevAverageY","difDistance","firstTouchX","firstTouchY","secondTouchX","secondTouchY","averageX","averageY","averageWorldPosition","pinchStatus","coordToRotateAround3D","zoomFactor","zooming3D","currentRotation","difRotation","lastTouchRotation","nativeCoord","rotateSign","sign","cameraMoved","currentCameraOrientation","averageScreenAfterZoom","scrollX","scrollY","touchMoveHandler","touchEndHandler","disableMoveAfterMultiTouches","isMouseDown","dbclickHandled","touchCancelHandler","onSelectOtherMapClicked","showHideDtmActionClicked","showHide3DActionClicked","openMap","groupName","setTempAngle","setOriginAngle","selectOtherMapAction","showHideDtmAction","layers","find","layer","toLowerCase","includes","selectOrigin","showHide3DAction","nativeEvent","cancelAnimationFrame","GetVersion","UpdateEnemyPosition","objectName","schemeName","FetchFileToByteArray","bytes","LoadObjectSchemes","AddRef","EnemyObject","SetState","uri","fetch","ok","arrayBuffer","Uint8Array","jsonLayerGroups","jsonGroup","coordSystemType","coordSystemParams","layerGroup","showGeoInMetricProportion","centerByStaticObjectsLayerOnly","layerCreateString","protocol","path","set","wmtsServerURL","xmlDoc","capabilitiesURL","bMapCoreLayerServer","wmtsAdditionalLayerGroup","CXmlNode","node","tagName","children","getElementsByTagName","child","parentNode","textContent","attributeName","attributes","getNamedItem","aNodes","aTexts","capabilities","GetFirstChild","MapLayerServerURL","GetFirstChildAttribute","lastSlashIndex","lastIndexOf","TrimmedMapLayerServerURL","substring","contents","aTileMatrixSets","GetChildren","mapTileMatrixSets","matrixSet","GetFirstChildText","crs","coordSystem","tileMatrixSet","layerID","context","mapToPreview","nodesLevel","LayerId","dtmLayerId","aFormats","GetChildrenTexts","aTileMatrixSetLinks","tileMatrixSetLink","tileMatrixSetParams","tileMatrixSetFilter","boundingBox","prefix","indexOf","aGroups","group","concat","CLayerReadCallback","IMcMapLayer","IReadCallback","extend","OnInitialized","pLayer","eStatus","strAdditionalDataString","IMcErrors","ECode","SUCCESS","NATIVE_SERVER_LAYER_NOT_VALID","ErrorCodeToString","OnReadError","eErrorCode","OnNativeServerLayerNotValid","bLayerVersionUpdated","OnRemoved","OnReplaced","pOldLayer","pNewLayer","Release","delete","CCameraUpdateCallback","ICameraUpdateCallback","OnActiveCameraUpdated","pViewport","IAsyncQueryCallback","__construct","__parent","call","OnTerrainHeightResults","bHeightFound","normal","OnTerrainHeightMatrixResults","uNumHorizontalPoints","uNumVerticalPoints","adHeightMatrix","OnTerrainHeightsAlongLineResults","aPointsWithHeights","aSlopes","pSlopesData","OnExtremeHeightPointsInPolygonResults","bPointsFound","pHighestPoint","pLowestPoint","OnTerrainAnglesResults","dPitch","dRoll","OnLineOfSightResults","aPoints","dCrestClearanceAngle","dCrestClearanceDistance","OnPointVisibilityResults","bIsTargetVisible","pdMinimalTargetHeightForVisibility","pdMinimalScouterHeightForVisibility","OnAreaOfSightResults","pAreaOfSight","aLinesOfSight","pSeenPolygons","pUnseenPolygons","aSeenStaticObjects","OnLocationFromTwoDistancesAndAzimuthResults","Target","OnError","CUserData","IMcUserData","bToBeDeleted","__destruct","Clone","fp","GetCameraFootprint","bUpperLeftFound","bUpperRightFound","bLowerRightFound","bLowerLeftFound","minPoint","maxPoint","GetExtremeHeightPointsInPolygon","UpperLeft","UpperRight","LowerRight","LowerLeft","terrain","eMapTypeToOpen","currCanvas","vpCreateData","SCreateData","pDevice","pCoordinateSystem","GetCoordinateSystem","GetCoordinateSystemDefinition","pOverlayManager","hWnd","AddCameraUpdateCallback","SetScreenSizeTerrainObjectsFactor","SetCameraRelativeHeightLimits","SetStaticObjectsVisibilityMaxScale","SetBackgroundColor","SMcBColor","SetObjectsDelay","EObjectDelayType","EODT_VIEWPORT_CHANGE_OBJECT_UPDATE","EODT_VIEWPORT_CHANGE_OBJECT_CONDITION","EODT_VIEWPORT_CHANGE_OBJECT_SIZE","EODT_VIEWPORT_CHANGE_OBJECT_HEIGHT","SetObjectsMovementThreshold","SetTerrainNumCacheTiles","IMcMapTerrain","IMcGridUTM","IMcGridCoordinateSystem","EDatumType","EDT_ED50_ISRAEL","IMcOverlayManager","IMcOverlay","createViewport","DoPrevViewport","doPrevViewport","createMapLayersAndViewports","eval","IMc3DModelMapLayer","SetDisplayingItemsAttachedToTerrain","SetDisplayingDtmVisualization","initializeViewports","is3d","serverUrl","MAPCORE_LAYER_SERVER_URL","capabilitiesXMLDoc","DOMParser","parseFromString","parseCapabilitiesXML","parseLayersConfiguration","forEach","key","init","SInitParams","uNumTerrainTileRenderTargets","createCallbackClasses","Destroy","removeChild","splice","clear","LoadingMessage","DescRow","DescLabel","DescValue","MapToolbox","MoreActionsBtn","isOpenClass","Open","SwitchMapForm","onCancel","zIndex","MapWrapper","CanvasContainer","renderMapToolbox","renderSwitchMapForm","getCanvas","renderLoadingMessage","mapStateToProps","mapDispachToProps","RadioGroup","RadioGroupValuesWrapper","cloneElement","isChecked","radioIndex","Radio","onRadioClick","bind","newProps","htmlFor","radio","radio__input","checked","radio__radio","isShown","selectedGroup","currentShownMap","onMapSelection","Body","item","selectMapRadioButton","Footer","isShownClass","Shown","renderBody","renderFooter"],"mappings":"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","file":"static/js/main.2d4cd92e.chunk.js","sourcesContent":["const actionTypes = {\r\n\t/* Video */\r\n\tPAUSE_VIDEO: 'PAUSE_VIDEO',\r\n\tRESUME_VIDEO: 'RESUME_VIDEO',\r\n\r\n\tLOACTE_START: 'LOACTE_START',\r\n\tLOACTE_SUCCESS: 'LOACTE_SUCCESS',\r\n\tLOACTE_FAILED: 'LOACTE_FAILED',\r\n\r\n\tRESET_START: 'RESET_START',\r\n\tRESET_SUCCESS: 'RESET_SUCCESS',\r\n\tRESET_FAILED: 'RESET_FAILED',\r\n\r\n\tTAKE_OFF_START: 'TAKE_OFF_START',\r\n\tTAKE_OFF_SUCCESS: 'TAKE_OFF_SUCCESS',\r\n\tTAKE_OFF_FAILED: 'TAKE_OFF_FAILED',\r\n\r\n\tSET_EXPOSURE_START: 'SET_EXPOSURE_START',\r\n\tSET_EXPOSURE_SUCCESS: 'SET_EXPOSURE_SUCCESS',\r\n\tSET_EXPOSURE_FAILED: 'SET_EXPOSURE_FAILED',\r\n\t\r\n\tSTART_INDOOR_EXPLORATION: 'START_INDOOR_EXPLORATION',\r\n\tSET_INDOOR_EXPLORATION_FLAG: 'SET_INDOOR_EXPLORATION_FLAG',\r\n\tREMOVE_INDOOR_EXPLORATION_FLAG: 'REMOVE_INDOOR_EXPLORATION_FLAG',\r\n\tSET_MISSION_STATE: 'SET_MISSION_STATE',\r\n\r\n\tGO_TO_LOCATION_START: 'GO_TO_LOCATION_START',\r\n\tGO_TO_LOCATION_SUCCESS: 'GO_TO_LOCATION_SUCCESS',\r\n\tGO_TO_LOCATION_FAILED: 'GO_TO_LOCATION_FAILED',\r\n\r\n\tPOINT_ON_VIDEO_IMAGE_START: 'POINT_ON_VIDEO_IMAGE_START',\r\n\tPOINT_ON_VIDEO_IMAGE_SUCCESS: 'POINT_ON_VIDEO_IMAGE_SUCCESS',\r\n\tPOINT_ON_VIDEO_IMAGE_FAILED: 'POINT_ON_VIDEO_IMAGE_FAILED',\r\n\r\n\tROSS_WEBSOCKET_CONNECTION_SUCCESS: 'ROSS_WEBSOCKET_CONNECTION_SUCCESS',\r\n\tROSS_WEBSOCKET_CONNECTION_FAILED: 'ROSS_WEBSOCKET_CONNECTION_FAILED',\r\n\tROSS_WEBSOCKET_CONNECTION_CLOSED: 'ROSS_WEBSOCKET_CONNECTION_CLOSED',\r\n\tROSS_WEBSOCKET_CONNECTION_START: 'ROSS_WEBSOCKET_CONNECTION_START',\r\n\r\n\t/* UI */\r\n\tSHOW_GLOBAL_MESSAGE: 'SHOW_GLOBAL_MESSAGE',\r\n\tREMOVE_GLOBAL_MESSAGE: 'REMOVE_GLOBAL_MESSAGE',\r\n\tSHOW_CONTEXT_MENU: 'SHOW_CONTEXT_MENU',\r\n\tCLOSE_CONTEXT_MENU: 'CLOSE_CONTEXT_MENU',\r\n\tSHOW_POPUP: 'SHOW_POPUP',\r\n\tHIDE_POPUP: 'HIDE_POPUP',\r\n\tIMAGE_SENT_TO_DRONE: 'IMAGE_SENT_TO_DRONE',\r\n\tSHOW_MISSION_PLANNER_SCREEN: 'SHOW_MISSION_PLANNER_SCREEN',\r\n\tHIDE_MISSION_PLANNER_SCREEN: 'HIDE_MISSION_PLANNER_SCREEN',\r\n\r\n\t/* Map */\r\n\tSET_MAPCORE_SDK_LOADED_FLAG: 'SET_MAPCORE_SDK_LOADED_FLAG',\r\n\tSET_MAP_TO_SHOW: 'SET_MAP_TO_SHOW' ,\r\n\tGET_DRONE_POSITION_OFFSET: 'GET_DRONE_POSITION_OFFSET',\r\n\tGET_ENEMY_POSITION:'GET_ENEMY_POSITION',\r\n\tSAVE_DRONE_LAST_POSITION: 'SAVE_DRONE_LAST_POSITION',\r\n\tSAVE_ORIGIN_COORDINATE: 'SAVE_ORIGIN_COORDINATE',\r\n\tTOGGLE_POINT_SELECTION_MODE : 'TOGGLE_POINT_SELECTION_MODE',\r\n\tSELECT_POINT_FROM_MAP :'SELECT_POINT_FROM_MAP',\r\n\t\r\n\r\n\t/* Output */\r\n\tUPDATE_SKELETON_RANGE: 'UPDATE_SKELETON_RANGE',\r\n\tSET_WEAPON_DETECTION: 'SET_WEAPON_DETECTION',\r\n\t\r\n\t/*Planner */\t\r\n\tADD_NEW_MISSION_PLAN_STAGE: 'ADD_NEW_MISSION_PLAN_STAGE',\r\n\tDELETE_MISSION_PLAN_STAGE: 'DELETE_MISSION_PLAN_STAGE',\r\n\tEDIT_MISSION_PLAN_STAGE: 'EDIT_MISSION_PLAN_STAGE',\r\n\tMOVE_UP_MISSION_PLAN_STAGE: 'MOVE_UP_MISSION_PLAN_STAGE',\r\n\tMOVE_DOWN_MISSION_PLAN_STAGE: 'MOVE_DOWN_MISSION_PLAN_STAGE',\r\n\tSAVE_MISSION_PLAN: 'SAVE_MISSION_PLAN',\r\n\tREMOVE_DRAFT_MISSION_PLAN: 'REMOVE_DRAFT_MISSION_PLAN',\r\n\tREMOVE_SAVED_MISSION_PLAN: 'REMOVE_SAVED_MISSION_PLAN',\r\n\tTOGGLE_MISSION_PLAN_VIEWER_STATE: 'TOGGLE_MISSION_PLAN_VIEWER_STATE',\r\n\tLOAD_DEFAULT_PLAN: 'LOAD_DEFAULT_PLAN',\r\n};\r\nexport default actionTypes;\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"App\":\"App_App__x9TLM\",\"AppHeader\":\"App_AppHeader__3NsLy\",\"LogoWrapper\":\"App_LogoWrapper__2lB98\",\"ActionsBar\":\"App_ActionsBar__1FkPZ\",\"ActionButtons\":\"App_ActionButtons__3iBDf\",\"HeaderElementWrapper\":\"App_HeaderElementWrapper__ignMN\",\"ExportBtn\":\"App_ExportBtn__1HeRI\",\"Disabled\":\"App_Disabled__2WDPY\",\"FileInput\":\"App_FileInput__2FqUW\",\"RightHeader\":\"App_RightHeader__15n8f\",\"HeaderLeftWrapper\":\"App_HeaderLeftWrapper__2X6Bn\",\"HeaderItem\":\"App_HeaderItem__115kC\",\"Icon\":\"App_Icon__hsNmT\",\"GpsIcon\":\"App_GpsIcon__2kVjk\",\"PositionIcon\":\"App_PositionIcon__fRF4m\",\"CompassIcon\":\"App_CompassIcon__hmZoo\",\"WifiIcon\":\"App_WifiIcon__2szZf\",\"BatteryIcon\":\"App_BatteryIcon__1KkY0\",\"DroneIcon\":\"App_DroneIcon__1P7hs\",\"BatteryValue\":\"App_BatteryValue__2lwfm\",\"LongLatWrapper\":\"App_LongLatWrapper__3vKFF\",\"lonLatLabel\":\"App_lonLatLabel__1q6ZB\",\"lonLatValue\":\"App_lonLatValue__W-qNL\",\"MissionWrapper\":\"App_MissionWrapper__VIEat\",\"MissionValue\":\"App_MissionValue__v9sLK\",\"MissionValueWrapper\":\"App_MissionValueWrapper__2XjYt\",\"MenuBtn\":\"App_MenuBtn__3YqbB\",\"MenuIcon\":\"App_MenuIcon__1BZwI\",\"MissionPlannerOverlay\":\"App_MissionPlannerOverlay__3a6bR\",\"MissionPlannerHidden\":\"App_MissionPlannerHidden__1UT3F\",\"VersionText\":\"App_VersionText__3ISgJ\"};","const config = {   \r\n    urls: {\r\n      getCapabilities: '/map/opr?service=wmts&request=GetCapabilities',\r\n      configuration: 'configuration.json',\r\n      loadMission: 'defaultMission.json',\r\n      videoStream: '/stream?topic=/d415/color/image_raw',\r\n      videoSnapshot: '/snapshot?topic=/d415/color/image_raw',\r\n\r\n      skeletonStream: '/stream?topic=/SkeletonDetector/Image',\r\n      skeletonSnapshot: '/snapshot?topic=/SkeletonDetector/Image',\r\n\r\n      windowDetectionStream: '/stream?topic=/seeker/detectionImage',\r\n      windowDetectionSnapshot: '/snapshot?topic=/seeker/detectionImage',\r\n    },\r\n\r\n    MIN_DRONE_DISTANCE_MOVE : 0.25, // 25 cm\r\n    EXPOSURE_MAX_LEVEL : 100,\r\n    COORDINATE_DECIMALS_PRECISION : 2,\r\n    DEFAULT_MISSION_POINT_HEIGHT : 0\r\n};\r\n\r\nexport const devVideoSnapshotUrl = `https://images.pexels.com/photos/78783/submachine-gun-rifle-automatic-weapon-weapon-78783.jpeg?auto=compress&cs=tinysrgb&h=750&w=1260`;\r\n//export const devVideoSnapshotUrl = `//camera.ehps.ncsu.edu:8100/c8`\r\n\r\n//export const devVideoStreamUrl = `http://88.53.197.250/axis-cgi/mjpg/video.cgi?resolution=320x240`;\r\n//export const devVideoStreamUrl = `//camera.ehps.ncsu.edu:8100/c8`;\r\nexport const devVideoStreamUrl = `https://images.pexels.com/photos/78783/submachine-gun-rifle-automatic-weapon-weapon-78783.jpeg?auto=compress&cs=tinysrgb&h=750&w=1260`;\r\n\r\nexport const popupSize  = {\r\n  small: 'small',\r\n  medium: 'medium'\r\n};\r\n\r\nexport const logSeverities = {\r\n  success: 'success',\r\n  info: 'info',\r\n  warn: 'warn',\r\n  error: 'error'\r\n};\r\n\r\n\r\nexport default config;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Wrapper\":\"MissionPlanner_Wrapper__3_9-5\",\"Center\":\"MissionPlanner_Center__2Zodv\",\"StartNewBtn\":\"MissionPlanner_StartNewBtn__zWWxr\",\"SideBar\":\"MissionPlanner_SideBar__3AIuT\",\"SidebarLabel\":\"MissionPlanner_SidebarLabel__1GnOt\",\"SideBarButtons\":\"MissionPlanner_SideBarButtons___Y2Zg\",\"Header\":\"MissionPlanner_Header__1H2py\",\"HeaderBtnWrapper\":\"MissionPlanner_HeaderBtnWrapper__12H2B\",\"HeaderBtn\":\"MissionPlanner_HeaderBtn__19r21\",\"HeaderIcon\":\"MissionPlanner_HeaderIcon__rsbSC\",\"HeaderTextWrapper\":\"MissionPlanner_HeaderTextWrapper__2CMNL\",\"HeaderTextState\":\"MissionPlanner_HeaderTextState__15FnS\",\"DraftIcon\":\"MissionPlanner_DraftIcon__3x3w5\",\"SavedPlanIcon\":\"MissionPlanner_SavedPlanIcon__1tQ8V\",\"SideBarBtn\":\"MissionPlanner_SideBarBtn__1Eu9y\",\"EmptyPlanStagesMessage\":\"MissionPlanner_EmptyPlanStagesMessage__2pXvV\",\"ClosePlanner\":\"MissionPlanner_ClosePlanner__A1_Z_\",\"Import\":\"MissionPlanner_Import__3_vBw\",\"Export\":\"MissionPlanner_Export__TIryV\",\"Save\":\"MissionPlanner_Save__19yX9\",\"Remove\":\"MissionPlanner_Remove__2tRYU\",\"ClearStages\":\"MissionPlanner_ClearStages__3euOJ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Wrapper\":\"ActionButtons_Wrapper__3DsLD\",\"Hidden\":\"ActionButtons_Hidden__3WlGR\",\"Button\":\"ActionButtons_Button__28JNJ\",\"ButtonLabel\":\"ActionButtons_ButtonLabel__16Rqx\",\"Clicked\":\"ActionButtons_Clicked__3YY1-\",\"Icon\":\"ActionButtons_Icon__zeqx4\",\"LocateIcon\":\"ActionButtons_LocateIcon__YkA4I\",\"PauseIcon\":\"ActionButtons_PauseIcon__2gs8R\",\"ResetIcon\":\"ActionButtons_ResetIcon___eeBX\",\"TakeoffIcon\":\"ActionButtons_TakeoffIcon__1zHhJ\",\"SetLocationIcon\":\"ActionButtons_SetLocationIcon__3bgZm\",\"PlayIcon\":\"ActionButtons_PlayIcon__2ogw7\",\"IndoorExploration\":\"ActionButtons_IndoorExploration__YfED4\",\"RunPlanIcon\":\"ActionButtons_RunPlanIcon__1ziLT\"};","import rosWebSocket from '../rosWebsocket';\r\n\r\n// export const pointingFingerEncode = new window.ROSLIB.Service({\r\n//     ros : rosWebSocket.getRosWebsocketObject(),\r\n//     name : 'EncodeCompressed',\r\n//     serviceType : 'pointingfinger/EncodeCompressed'\r\n// });\r\n\r\n// export const pointingFingerLocate = new window.ROSLIB.Service({\r\n//     ros : rosWebSocket.getRosWebsocketObject(),\r\n//     name : 'LocateCompressed',\r\n//     serviceType : 'pointingfinger/LocateCompressed'\r\n// });\r\n\r\n// export const pointingFingerReset = new window.ROSLIB.Service({\r\n//     ros : rosWebSocket.getRosWebsocketObject(),\r\n//     name : 'Reset',\r\n//     serviceType : 'pointingfinger/Reset'\r\n// });\r\n\r\n// export const seekerReset = new window.ROSLIB.Service({\r\n//     ros : rosWebSocket.getRosWebsocketObject(),\r\n//     name : 'seeker/Reset',\r\n//     serviceType : 'seeker/Reset'\r\n// });\r\n\r\n// export const seekerTakeoff = new window.ROSLIB.Service({\r\n//     ros : rosWebSocket.getRosWebsocketObject(),\r\n//     name : 'seeker/Takeoff',\r\n//     serviceType : 'seeker/Takeoff'\r\n// });\r\n\r\nexport function getService(serviceName) {\r\n\r\n    const services = {\r\n        pointingFingerEncode: new window.ROSLIB.Service({\r\n            ros: rosWebSocket.getRosWebsocketObject(),\r\n            name: 'EncodeCompressed',\r\n            serviceType: 'pointingfinger/EncodeCompressed'\r\n        }),\r\n        pointingFingerLocate: new window.ROSLIB.Service({\r\n            ros: rosWebSocket.getRosWebsocketObject(),\r\n            name: 'LocateCompressed',\r\n            serviceType: 'pointingfinger/LocateCompressed'\r\n        }),\r\n        pointingFingerReset: new window.ROSLIB.Service({\r\n            ros: rosWebSocket.getRosWebsocketObject(),\r\n            name: 'Reset',\r\n            serviceType: 'pointingfinger/Reset'\r\n        }),\r\n        seekerReset: new window.ROSLIB.Service({\r\n            ros: rosWebSocket.getRosWebsocketObject(),\r\n            name: 'seeker/Reset',\r\n            serviceType: 'seeker/Reset'\r\n        }),\r\n        seekerTakeoff: new window.ROSLIB.Service({\r\n            ros: rosWebSocket.getRosWebsocketObject(),\r\n            name: 'seeker/Takeoff',\r\n            serviceType: 'seeker/Takeoff'\r\n        }),\r\n        startIndoorExploration: new window.ROSLIB.Service({\r\n            ros: rosWebSocket.getRosWebsocketObject(),\r\n            name: 'seeker/SetIndoorState',\r\n            serviceType: 'seeker/SetIndoorState'\r\n        }),\r\n        flyToTopic: new window.ROSLIB.Topic({\r\n            ros: rosWebSocket.getRosWebsocketObject(),\r\n            name: '/seeker/TranslatePosition',\r\n            messageType: 'geometry_msgs/Vector3'\r\n        }),\r\n        setExposure: new window.ROSLIB.Service({\r\n            ros: rosWebSocket.getRosWebsocketObject(),\r\n            name: '/d415/rgb_camera/set_parameters',\r\n            serviceType: 'dynamic_reconfigure/Reconfigure'\r\n        }),\r\n        getDronePosition: new window.ROSLIB.TFClient({\r\n            ros: rosWebSocket.getRosWebsocketObject(),\r\n            fixedFrame: 'map',\r\n            angularThres: 0.1,\r\n            transThres: 0.1\r\n        }),\r\n        getDroneExploreState: new window.ROSLIB.Topic({\r\n            ros: rosWebSocket.getRosWebsocketObject(),\r\n            name: '/seeker/state',\r\n            messageType: 'std_msgs/String'\r\n        }),\r\n        getSkeletonRange: new window.ROSLIB.Topic({\r\n            ros: rosWebSocket.getRosWebsocketObject(),\r\n            name: '/SkeletonDetector/Range',\r\n            messageType: 'std_msgs/Float32'\r\n        }),\r\n        // Mission Plan Execute - state\r\n        doMissionReset: new window.ROSLIB.Service({\r\n            ros: rosWebSocket.getRosWebsocketObject(),\r\n            name: '/seeker/DoMissionReset',\r\n            serviceType: '/seeker/DoMissionReset'\r\n        }),\r\n        doMissionExecute: new window.ROSLIB.Service({\r\n            ros: rosWebSocket.getRosWebsocketObject(),\r\n            name: '/seeker/DoMissionExecute',\r\n            serviceType: '/seeker/DoMissionExecute'\r\n        }),\r\n        addMissionTakeoff: new window.ROSLIB.Service({\r\n            ros: rosWebSocket.getRosWebsocketObject(),\r\n            name: '/seeker/AddMissionTakeoff',\r\n            serviceType: '/seeker/AddMissionTakeoff'\r\n        }),\r\n        addMissionWP: new window.ROSLIB.Service({\r\n            ros: rosWebSocket.getRosWebsocketObject(),\r\n            name: '/seeker/AddMissionWP',\r\n            serviceType: '/seeker/AddMissionWP'\r\n        }),        \r\n        // Mission Plan Execute - end\r\n    }\r\n\r\n    return services[serviceName];\r\n}","import actionTypes from './actionTypes';\r\nimport { getService } from '../../services';\r\n\r\nexport const subscribeToDroneData = () => {\r\n    console.log(\"subscribeToDroneData\");\r\n\r\n    return async (dispatch) => {\r\n        //dispatch({ type: actionTypes.SHOW_GLOBAL_MESSAGE, payload: { text: `Subscribe to Drone Position...`, type: logSeverities.info } });\r\n        console.log(\"subscribe: getDronePosition\");\r\n        getService('getDronePosition').subscribe('base_link', function (response) {\r\n            console.log(response);\r\n            dispatch({ type: actionTypes.GET_DRONE_POSITION_OFFSET, payload: { dronePositionOffset: response.translation, droneRotationQuaternion: response.rotation } });\r\n        });\r\n\r\n    };\r\n};\r\n\r\n","export function getBase64Image(img) {\n    let dataURL = null;\n    if (img.naturalWidth && img.naturalHeight) {\n        // Create an empty canvas element\n        const canvas = document.createElement(\"canvas\");\n        canvas.width = img.naturalWidth;\n        canvas.height = img.naturalHeight;\n\n        // Copy the image contents to the canvas\n        const ctx = canvas.getContext(\"2d\");\n        ctx.drawImage(img, 0, 0);\n\n        // Get the data-URL formatted image\n        // Firefox supports PNG and JPEG. You could check img.src to\n        // guess the original format, but be aware the using \"image/jpg\"\n        // will re-encode the image.\n        dataURL = canvas.toDataURL(\"image/jpeg\");\n    } else {\n        alert('error: captured image height or width size is 0');\n    }\n\n    return dataURL;\n}","\r\n\r\n\r\nimport actionTypes from './actionTypes';\r\n\r\n\r\nexport const showGlobalMessage = ({text, type, isRemoved}) => {\r\n    return (dispatch) => {\r\n        const payload = {\r\n            text,\r\n            type\r\n        }\r\n        dispatch({type: actionTypes.SHOW_GLOBAL_MESSAGE, payload});\r\n        if (isRemoved) {\r\n            setTimeout(() => dispatch({type: actionTypes.REMOVE_GLOBAL_MESSAGE}), 3000)\r\n        }\r\n    };\r\n};","import actionTypes from './actionTypes';\r\nimport { getBase64Image } from '../../utils/imageUtils';\r\nimport { getService } from '../../services';\r\nimport { logSeverities } from '../../config';\r\nimport { showGlobalMessage } from './layoutActions';\r\n\r\nexport const locate = () => {\r\n    return async (dispatch) => {\r\n        dispatch({ type: actionTypes.LOACTE_START });\r\n\r\n        const img = document.getElementById('droneImage');\r\n        if (img) {\r\n            const imgURL = getBase64Image(img);\r\n            //dispach img to send and pixel\r\n            dispatch({ type: actionTypes.IMAGE_SENT_TO_DRONE, payload: { image: imgURL } });\r\n\r\n            const dataX = imgURL && imgURL.replace(\"data:image/jpeg;base64,\", \"\");\r\n            if (!dataX) {\r\n                dispatch({ type: actionTypes.LOACTE_FAILED });\r\n                return;\r\n            }\r\n\r\n            const imageMessage = new window.ROSLIB.Message({ data: dataX, format: \"jpeg\" });\r\n            const requestLocate = new window.ROSLIB.ServiceRequest({ image: imageMessage });\r\n\r\n            getService('pointingFingerLocate').callService(requestLocate, result => {\r\n                if (result.isSuccess) {\r\n                    dispatch({ type: actionTypes.LOACTE_SUCCESS });\r\n                } else {\r\n                    dispatch({ type: actionTypes.LOACTE_FAILED });\r\n                }\r\n                console.log(getService('pointingFingerLocate').name, result)\r\n            });\r\n        } else {\r\n            dispatch({ type: actionTypes.LOACTE_FAILED });\r\n        }\r\n    };\r\n};\r\n\r\nexport const pointVideoImage = ev => {\r\n    return async (dispatch) => {\r\n        dispatch({ type: actionTypes.POINT_ON_VIDEO_IMAGE_START });\r\n\r\n        const img = document.getElementById('droneImage');\r\n        // Adjusting pixel to original img sizes\r\n        let adjustedX = (ev.pageX - img.getBoundingClientRect().x) / img.width * img.naturalWidth;\r\n        let adjustedY = (ev.pageY - img.getBoundingClientRect().y) / img.height * img.naturalHeight;\r\n\r\n        console.log(adjustedX, adjustedY);\r\n\r\n        const roundedX = Math.round(adjustedX);\r\n        const roundedY = Math.round(adjustedY);\r\n        dispatch(showGlobalMessage({ text: `selected pixel: (${roundedX}, ${roundedY})`, type: logSeverities.info, isRemoved: true }));\r\n\r\n        if (img) {\r\n            const imgURL = getBase64Image(img);\r\n            //dispach img to send and pixel\r\n            dispatch({ type: actionTypes.IMAGE_SENT_TO_DRONE, payload: { image: imgURL, point: { roundedX, roundedY } } });\r\n\r\n            const dataX = imgURL && imgURL.replace(\"data:image/jpeg;base64,\", \"\");\r\n            if (!dataX) {\r\n                dispatch({ type: actionTypes.POINT_ON_VIDEO_IMAGE_FAILED });\r\n                return;\r\n            }\r\n            const imageMessage = new window.ROSLIB.Message({ data: dataX, format: \"jpeg\" });\r\n\r\n            const pointMessage = new window.ROSLIB.Message({\r\n                x: roundedX,\r\n                y: roundedY,\r\n                z: 0.0\r\n            });\r\n\r\n            const requestEncode = new window.ROSLIB.ServiceRequest({ image: imageMessage, point: pointMessage });\r\n\r\n            getService('pointingFingerEncode').callService(requestEncode, result => {\r\n\r\n                console.log(getService('pointingFingerEncode').name, result);\r\n            });\r\n\r\n            const requestLocate = new window.ROSLIB.ServiceRequest({ image: imageMessage });\r\n\r\n            getService('pointingFingerLocate').callService(requestLocate, result => {\r\n                if (result.isSuccess) {\r\n                    dispatch({ type: actionTypes.POINT_ON_VIDEO_IMAGE_SUCCESS });\r\n                }\r\n                console.log(getService('pointingFingerLocate').name, result);\r\n            });\r\n\r\n        } else {\r\n            dispatch({ type: actionTypes.POINT_ON_VIDEO_IMAGE_FAILED });\r\n        }\r\n    };\r\n};\r\n\r\nexport const reset = () => {\r\n    return async (dispatch) => {\r\n        dispatch({ type: actionTypes.RESET_START });\r\n\r\n        const requestReset = new window.ROSLIB.ServiceRequest({});\r\n\r\n        getService('pointingFingerReset').callService(requestReset, result => {\r\n            if (result.isSuccess) {\r\n                dispatch({ type: actionTypes.RESET_SUCCESS });\r\n            } else {\r\n                dispatch({ type: actionTypes.RESET_FAILED });\r\n            }\r\n            console.log(getService('pointingFingerReset').name, result)\r\n        });\r\n\r\n        getService('seekerReset').callService(requestReset, function (result) {\r\n            console.log('Result for service call on ' + getService('seekerReset').name + ': ' + result.isSuccess);\r\n            console.log(getService('seekerReset').name, result)\r\n        });\r\n\r\n    };\r\n};\r\n\r\nexport const takeoff = () => {\r\n    return async (dispatch) => {\r\n        dispatch({ type: actionTypes.TAKE_OFF_START });        \r\n        dispatch(showGlobalMessage({ text: `Taking off...`, type: logSeverities.info, isRemoved: true }));\r\n        const requestTakeoff = new window.ROSLIB.ServiceRequest({});\r\n\r\n        getService('seekerTakeoff').callService(requestTakeoff, result => {\r\n            dispatch({ type: actionTypes.TAKE_OFF_SUCCESS });\r\n            /*if (result.isSuccess) {\r\n                dispatch({ type: actionTypes.TAKE_OFF_SUCCESS });\r\n            } else {\r\n                dispatch({ type: actionTypes.TAKE_OFF_FAILED });\r\n                dispatch({ type: actionTypes.SHOW_GLOBAL_MESSAGE, payload: { text: `Taking off failed...`, type: logSeverities.error } });\r\n            }*/\r\n            console.log(result)\r\n        });\r\n    };\r\n};\r\nexport const startIndoorExploration = () => {\r\n    return async (dispatch) => {\r\n        dispatch({ type: actionTypes.START_INDOOR_EXPLORATION });\r\n        const requestIndoorExplorationFlag = new window.ROSLIB.ServiceRequest({});\r\n\r\n        getService('startIndoorExploration').callService(requestIndoorExplorationFlag, result => {\r\n            console.log(result);\r\n        });\r\n    };\r\n};\r\n\r\nexport const goToLocation = (location) => {\r\n    return async (dispatch) => {\r\n        dispatch({ type: actionTypes.GO_TO_LOCATION_START });\r\n        dispatch(showGlobalMessage({ text: `Go To Location ${location}`, type: logSeverities.info, isRemoved: true }));\r\n\r\n        const [x, y, z] = location.split(',');\r\n        const pointMessage = new window.ROSLIB.Message({\r\n            x: parseFloat(x),\r\n            y: parseFloat(y),\r\n            z: parseFloat(z)\r\n        });\r\n\r\n        getService('flyToTopic').publish(pointMessage);\r\n    };\r\n};\r\n\r\n\r\n\r\nexport const setExposure = (exposureVal) => {\r\n    return async (dispatch) => {\r\n        dispatch({ type: actionTypes.SET_EXPOSURE_START });        \r\n        dispatch(showGlobalMessage({ text: `Setting Exposure...`, type: logSeverities.info, isRemoved: true }));\r\n        const setExposure = new window.ROSLIB.ServiceRequest({\r\n            config: {\r\n                bools: [], strs: [], doubles: [], groups: [],\r\n                ints: [\r\n                    { name: 'exposure', value: exposureVal }\r\n                ],\r\n\r\n            }\r\n        });\r\n        \r\n        getService('setExposure').callService(setExposure, result => {\r\n            if (result.isSuccess) {\r\n                dispatch({ type: actionTypes.SET_EXPOSURE_SUCCESS });\r\n            } else {\r\n                //   dispatch({ type: actionTypes.SET_EXPOSURE_FAILED });\r\n                //  dispatch({ type: actionTypes.SHOW_GLOBAL_MESSAGE, payload: { text: `Setting Exposure failed...`, type: logSeverities.error } });\r\n            }\r\n            console.log(result)\r\n        });\r\n    };\r\n};\r\n\r\n\r\nexport const subscribeToSkeletonRange = () => {\r\n    return (dispatch) => {\r\n        console.log(\"subscribe: getSkeletonRange\");\r\n        getService('getSkeletonRange').subscribe(function (response) {\r\n            let range = 0;\r\n            try {\r\n                if (response.data) {\r\n                    range = (response.data / 100).toFixed(1)\r\n\r\n                }\r\n            } catch {\r\n\r\n            }\r\n            dispatch({ type: actionTypes.UPDATE_SKELETON_RANGE, payload: { skeletonRange: range } });\r\n        });\r\n    };\r\n};\r\n\r\nexport const subscribeToWeaponDetection = () => {\r\n    return (dispatch) => {\r\n        console.log(\"subscribe: getDroneExploreState\");\r\n        getService('getDroneExploreState').subscribe(function (response) {\r\n            \r\n            //const WEAPON_ID = 1;\r\n            const INDOOR_EXPLORATION = \"INDOOR_EXPLORATION\";\r\n            const INDOOR_EXPLORATION_THREAT = \"INDOOR_EXPLORATION_THREAT\";\r\n\r\n            console.log(response);\r\n            \r\n            if(response && response.data) {\r\n                dispatch({ type: actionTypes.SET_MISSION_STATE, payload: { missionState: response.data } });\r\n\r\n                if (response.data &&  response.data.startsWith(INDOOR_EXPLORATION)) {\r\n                    dispatch({ type: actionTypes.SET_INDOOR_EXPLORATION_FLAG });\r\n                    dispatch({ type: actionTypes.SET_WEAPON_DETECTION, payload: { weaponDetected: true } });                \r\n                    dispatch(showGlobalMessage({ text: `Threat Detected`, type: logSeverities.warn, isRemoved: true }));                    \r\n                } else if (response.data === INDOOR_EXPLORATION_THREAT) {\r\n                    // dispatch({ type: actionTypes.SET_WEAPON_DETECTION, payload: { weaponDetected: true } });                \r\n                    // dispatch(showGlobalMessage({ text: `Threat Detected`, type: logSeverities.warn, isRemoved: true }));\r\n                }\r\n                                \r\n            }\r\n        });\r\n    };\r\n};\r\n","import { showGlobalMessage } from './layoutActions';\r\nimport config, { logSeverities } from '../../config';\r\nimport { getService } from '../../services';\r\nimport axios from 'axios';\r\nimport actionTypes from './actionTypes';\r\nimport * as geoCalculations from '../../utils/geoCalculations';\r\n\r\n\r\n\r\nfunction asyncCallRossService(serviceName, params) {\r\n    console.log('starting calling service ', serviceName, 'with params:', params);\r\n    return new Promise((resolve, reject) => {\r\n        getService(serviceName).callService(params, result => {\r\n            // TODO - check how to get failure from the service and then call the reject() func.\r\n            console.log('finish calling service ', serviceName);\r\n            resolve(result);\r\n        })\r\n    })\r\n}\r\n\r\n\r\nexport const runSavedMissionPlan = () => {\r\n    return async (dispatch, getState) => {\r\n        dispatch(showGlobalMessage({ text: `Starting to execute planned mission`, type: logSeverities.info, isRemoved: true }));\r\ndebugger;\r\n        // 1. reset\r\n        const requestMissionReset = new window.ROSLIB.ServiceRequest({});\r\n        await asyncCallRossService('doMissionReset', requestMissionReset);        \r\n        \r\n        // 2. mission plan stages\r\n        const missionStages = getState().planner.savedMissionPlan;        \r\n        const workingOrigin = getState().map.workingOrigin;\r\n        let serviceRequest;\r\n\r\n        for (const stage of missionStages) {\r\n            \r\n            const { rossService } = stage.selectedStageType;\r\n            if (rossService) {\r\n                switch (rossService) {\r\n                    case 'addMissionWP':\r\n                        const [x, y, z] = stage.stageParamsInput.split(',');\r\n                        const offset = geoCalculations.getCoordinatesOffset(workingOrigin.coordinate, { x, y, z });\r\n                        const offsetWithAngle = geoCalculations.calculateOffsetWithAngle(offset, -(workingOrigin.angle));\r\n                        const droneOffset = geoCalculations.convertDroneOffsetToMapOffset(offsetWithAngle);\r\n                        serviceRequest = new window.ROSLIB.ServiceRequest({\r\n                            coordinate: droneOffset\r\n                        });\r\n                        break;\r\n\r\n                    case 'addMissionTakeoff':\r\n                        serviceRequest = new window.ROSLIB.ServiceRequest({});\r\n                        break;\r\n                    default:\r\n                        serviceRequest = null;\r\n                        break;\r\n                }\r\n                await asyncCallRossService(rossService, serviceRequest);\r\n            }\r\n        };\r\n\r\n        // 3. execute\r\n        const requestMissionExecute = new window.ROSLIB.ServiceRequest({});\r\n        await asyncCallRossService('doMissionExecute', requestMissionExecute);\r\n    };\r\n};\r\n\r\nexport const importMissionFromDroneFile = () => {\r\n    return async (dispatch) => {\r\n        try {\r\n            const response = await axios.get(config.urls.loadMission);\r\n            dispatch({ type: actionTypes.LOAD_DEFAULT_PLAN, payload: response.data });\r\n            dispatch(showGlobalMessage({ text: `Default plan loaded successfully`, type: logSeverities.success, isRemoved: true }));\r\n        } catch (e) {\r\n            dispatch(showGlobalMessage({ text: `Unable to load default plan`, type: logSeverities.error, isRemoved: true }));\r\n            console.log(e)\r\n        }\r\n    };\r\n};\r\n\r\nexport const importMissionFromPcFile = (missionData) => {\r\n    return async (dispatch) => {\r\n        try {\r\n            dispatch({ type: actionTypes.LOAD_DEFAULT_PLAN, payload: missionData });\r\n            dispatch(showGlobalMessage({ text: `Default plan loaded successfully`, type: logSeverities.success, isRemoved: true }));\r\n        } catch (e) {\r\n            dispatch(showGlobalMessage({ text: `Unable to load default plan`, type: logSeverities.error, isRemoved: true }));\r\n            console.log(e)\r\n        }\r\n    };\r\n};\r\n\r\nexport const exportPlanToFile = (plan, viewerState) => {\r\n    \r\n    return async (dispatch) => {\r\n        try {\r\n            const url = 'data:text/json;charset=utf8,' + encodeURIComponent(JSON.stringify(plan, null, 2));\r\n            const downloadAnchor = document.createElement('a');\r\n            downloadAnchor.setAttribute(\"href\", url);\r\n            downloadAnchor.setAttribute(\"download\", `${viewerState}.json`);\r\n            document.body.appendChild(downloadAnchor);\r\n            downloadAnchor.click();\r\n            downloadAnchor.remove();\r\n        } catch (e) {\r\n            dispatch(showGlobalMessage({ text: `Unable to load default plan`, type: logSeverities.error, isRemoved: true }));\r\n            console.log(e)\r\n        }\r\n    };\r\n};\r\n\r\n\r\n","import * as map from './mapActions';\r\nimport * as output from './outputActions';\r\nimport * as video from './videoActions';\r\nimport * as layout from './layoutActions';\r\nimport * as planner from './plannerActions';\r\n\r\nconst actionCreators = {\r\n    ...map,    \r\n    ...output,\r\n    ...video,\r\n    ...layout,\r\n    ...planner\r\n};\r\n\r\nexport default actionCreators;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Wrapper\":\"Video_Wrapper__3WDZ5\",\"FullHeight\":\"Video_FullHeight__1m4jz\",\"VideoImage\":\"Video_VideoImage__35chy\",\"ErrorIcon\":\"Video_ErrorIcon__KdGyZ\",\"ErrorMessage\":\"Video_ErrorMessage__13Q-q\",\"VideoHeader\":\"Video_VideoHeader__1eAEl\",\"Description\":\"Video_Description__kochl\",\"ToggleTarget\":\"Video_ToggleTarget__2NVDj\",\"HideTarget\":\"Video_HideTarget__1LRwo\",\"Exposure\":\"Video_Exposure__1W6Ol\",\"VideoFooter\":\"Video_VideoFooter__39IDx\",\"ControlBtn\":\"Video_ControlBtn__3Y1I5\",\"Play\":\"Video_Play__3k8Yx\",\"Pause\":\"Video_Pause__2-JfD\",\"RecordButton\":\"Video_RecordButton__3yDsC\",\"RecordIcon\":\"Video_RecordIcon__1QWtC\",\"RecordindIcon\":\"Video_RecordindIcon__12Ahh\",\"recordAnimation\":\"Video_recordAnimation__2sBXB\",\"FullScreen\":\"Video_FullScreen__sW_M1\",\"ExitFullScreen\":\"Video_ExitFullScreen__1OHpR\",\"StreamingIconWrapper\":\"Video_StreamingIconWrapper__1pQZP\",\"StreamingIcon\":\"Video_StreamingIcon__1n3jI\",\"Footer\":\"Video_Footer__2O9Ds\",\"TargetIcon\":\"Video_TargetIcon__2dWVS\",\"TargetLarge\":\"Video_TargetLarge__2N0y0\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Wrapper\":\"OutputTabs_Wrapper__20mIk\",\"NoOutput\":\"OutputTabs_NoOutput__MIjCN\",\"ErrorIcon\":\"OutputTabs_ErrorIcon__24qg2\",\"ErrorMessage\":\"OutputTabs_ErrorMessage__2Jd7x\",\"Tabs\":\"OutputTabs_Tabs__3ZGhk\",\"OutputImage\":\"OutputTabs_OutputImage__3hA-j\",\"Point\":\"OutputTabs_Point__y_dsR\",\"tabslidernav\":\"OutputTabs_tabslidernav__3FN3l\",\"tabslidertabs\":\"OutputTabs_tabslidertabs__AgWjB\",\"TabSelected\":\"OutputTabs_TabSelected__hJSqC\",\"tabslidertrigger\":\"OutputTabs_tabslidertrigger__HRmSB\",\"SkeletonTab\":\"OutputTabs_SkeletonTab__1TCoA\",\"WeaponDetected\":\"OutputTabs_WeaponDetected__3fFnF\",\"borderAnimation\":\"OutputTabs_borderAnimation__2FhIy\",\"WindowTab\":\"OutputTabs_WindowTab__3zepD\",\"VideoImage\":\"OutputTabs_VideoImage__2xrrV\",\"AlertIcon\":\"OutputTabs_AlertIcon__3jBfP\",\"SkeletonRange\":\"OutputTabs_SkeletonRange__3mtrV\",\"alertAnimation\":\"OutputTabs_alertAnimation__1YWoC\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"h2\":\"Popup_h2__1Epm6\",\"Overlay\":\"Popup_Overlay__1W-_B\",\"Popup\":\"Popup_Popup__1vmFB\",\"PopupHeaderWrapper\":\"Popup_PopupHeaderWrapper__2ihcK\",\"PopupBody\":\"Popup_PopupBody__uqkJ8\",\"NoBodyOverFlow\":\"Popup_NoBodyOverFlow__PVwpV\",\"PopupFooter\":\"Popup_PopupFooter__1hmcd\",\"closeBtn\":\"Popup_closeBtn__7Co7R\",\"FormButton\":\"Popup_FormButton__1lu1-\",\"Apply\":\"Popup_Apply__Lh240\",\"small\":\"Popup_small__15mt6\",\"medium\":\"Popup_medium__3Jjwh\",\"Disabled\":\"Popup_Disabled__2miuo\"};","import { logSeverities } from './config';\r\nimport actionTypes from './store/actions/actionTypes';\r\nimport actions from './store/actions';\r\nimport externalConfig from './ExternalConfigurationHandler';\r\nimport {store} from './index';\r\n\r\n\r\nclass RosWebSocket {\r\n\r\n    rosWebSocket = null;\r\n    RECONNECT_TIMEOUT = 2000;\r\n\r\n\r\n    register() {\r\n        try {\r\n            const { ROS_BE_PROTOCOL, BE_IP, ROS_BE_PORT } = externalConfig.getConfiguration();\r\n            const url =  `${ROS_BE_PROTOCOL}://${BE_IP}:${ROS_BE_PORT}`;\r\n            store.dispatch({type: actionTypes.SHOW_GLOBAL_MESSAGE, payload: {text: `Trying to connect ros websocket on: ${url}`, type:logSeverities.info}})\r\n            store.dispatch(actions.showGlobalMessage({text: `Trying to connect ros websocket on: ${url}`, type:logSeverities.info}))\r\n            console.log(\"Trying to connect ros websocket\");\r\n            this.rosWebSocket = new window.ROSLIB.Ros({url});\r\n    \r\n            this.rosWebSocket.on('connection', () => {\r\n                store.dispatch(actions.showGlobalMessage({text: `Connected successfuly to ros websocket`, type:logSeverities.success, isRemoved: true}))                \r\n                store.dispatch({type: actionTypes.ROSS_WEBSOCKET_CONNECTION_SUCCESS});\r\n\r\n                store.dispatch(actions.subscribeToDroneData());\r\n                store.dispatch(actions.subscribeToSkeletonRange());\r\n                store.dispatch(actions.subscribeToWeaponDetection());\r\n\r\n            });\r\n    \r\n            this.rosWebSocket.on('error', error => {                \r\n                store.dispatch(actions.showGlobalMessage({text: `Failed to connect ros websocket on: ${url}`, type:logSeverities.error}));\r\n                store.dispatch({type: actionTypes.ROSS_WEBSOCKET_CONNECTION_FAILED});\r\n                console.log(error);\r\n            });\r\n    \r\n            this.rosWebSocket.on('close', () => {\r\n                store.dispatch(actions.showGlobalMessage({text: `Connection to ros websocket on: ${url} closed`, type:logSeverities.error}))\r\n                store.dispatch({type: actionTypes.ROSS_WEBSOCKET_CONNECTION_CLOSED});\r\n                this.reRegister();\r\n            });\r\n        } catch (e) {\r\n            console.log(\"RosWebSocket.register() Exception:\" + e);\r\n        }\r\n    }\r\n\r\n    reRegister = () => {\r\n        setTimeout( () => this.register() , this.RECONNECT_TIMEOUT);\r\n    }\r\n\r\n    getRosWebsocketObject() {\r\n        if (this.rosWebSocket == null) {\r\n            this.register();\r\n        }\r\n        return this.rosWebSocket;\r\n    }\r\n}\r\n\r\nexport default new RosWebSocket();\r\n\r\n\r\n\r\n","class ExternalConfigurationHandler {\n\n    externalConfigurationHandler = null;\n    \n    setConfiguration(configuration) {\n        this.externalConfigurationHandler = configuration;\n    }\n\n    getConfiguration() {\n        return this.externalConfigurationHandler;\n    }\n}\n\nexport default new ExternalConfigurationHandler();","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Row\":\"Input_Row__1w6Rb\",\"Label\":\"Input_Label__1ABD4\",\"Mandatory\":\"Input_Mandatory__19Z8M\",\"InputWrapper\":\"Input_InputWrapper__1Vd4e\",\"InnerInputWrapper\":\"Input_InnerInputWrapper__3_c98\",\"Input\":\"Input_Input___8XVY\",\"ShowError\":\"Input_ShowError__3z0Gt\",\"ValidationMessage\":\"Input_ValidationMessage__2yyk0\",\"ValidationImg\":\"Input_ValidationImg__32L5C\",\"readOnly\":\"Input_readOnly__3hVEi\",\"InfoImage\":\"Input_InfoImage__3o-sE\",\"Disabled\":\"Input_Disabled__3bRRV\"};","export function calculateDistanceBetween2Points(p1, p2) {\r\n    var a = p2.x - p1.x;\r\n    var b = p2.y - p1.y;\r\n    var c = p2.z - p1.z;\r\n\r\n    return Math.sqrt(a * a + b * b + c * c);\r\n}\r\n\r\nexport function getMapCoordinate(workingOrigin , offset){\r\n    const offsetWithAngle = calculateOffsetWithAngle(offset,  workingOrigin.angle);\r\n    const mapOffset = convertMapOffsetToDroneOffset(offsetWithAngle);\r\n    return addCoordinates(workingOrigin.coordinate, mapOffset);\r\n}\r\n\r\nexport function calculateOffsetWithAngle(offset, angle) {\r\n    const radians = angle * Math.PI / 180;\r\n    const {x, y, z} = offset;\r\n    return {\r\n        x: x * Math.cos(radians) - y * Math.sin(radians),\r\n        y: x * Math.sin(radians) + y * Math.cos(radians),\r\n        z: parseInt(z)\r\n    }\r\n\r\n}\r\n\r\nexport function convertMapOffsetToDroneOffset(offset) {\r\n    return {\r\n        x: -offset.y,\r\n        y: offset.x,\r\n        z: offset.z\r\n    }\r\n}\r\nexport function convertDroneOffsetToMapOffset(offset) {\r\n    return {\r\n        x: offset.y,\r\n        y: -offset.x,\r\n        z: offset.z\r\n    }\r\n}\r\nexport function mapCoordiantesToDroneCoordinates(coordinate) {\r\n    \r\n    return {\r\n        x: coordinate.y,\r\n        y: -coordinate.x,\r\n        z: coordinate.z\r\n    }\r\n}\r\n\r\n\r\nexport function addCoordinates(c1, c2) {\r\n\r\n    return {\r\n        x: c1.x + c2.x,\r\n        y: c1.y + c2.y,\r\n        z: c1.z + c2.z\r\n    }\r\n}\r\n\r\nexport function getCoordinatesOffset(originCoordinate, coordinate) {\r\n\r\n    return {\r\n        x: coordinate.x - originCoordinate.x,\r\n        y: coordinate.y - originCoordinate.y,\r\n        z: coordinate.z\r\n    }\r\n}\r\n\r\nexport function roundCoordinate(coordinate, precision) {\r\n    //precision = decimals after point\r\n    var multiplier = Math.pow(10, precision || 0);\r\n    return {\r\n        x: Math.round(coordinate.x * multiplier) / multiplier,\r\n        y: Math.round(coordinate.y * multiplier) / multiplier,\r\n        z: Math.round(coordinate.z * multiplier) / multiplier,\r\n    }\r\n}\r\n\r\nexport function quaternionToYaw(q) {\r\n    if(q === null || q === undefined){\r\n        return 0;\r\n    }\r\n    const yawRadians = Math.atan2(2.0*(q.y*q.z + q.w*q.x), q.w*q.w - q.x*q.x - q.y*q.y + q.z*q.z);\r\n    const angle = yawRadians * 180 / Math.PI;\r\n    return angle;\r\n}\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"MissionStagesWrapper\":\"MissionPlanStages_MissionStagesWrapper__36zfY\",\"StageWrapper\":\"MissionPlanStages_StageWrapper__3kX5R\",\"MenuBtn\":\"MissionPlanStages_MenuBtn__qy6F7\",\"BtnIconWrapper\":\"MissionPlanStages_BtnIconWrapper__3o-4I\",\"BtnIconBall\":\"MissionPlanStages_BtnIconBall__3jxxt\",\"AddNewStageBtn\":\"MissionPlanStages_AddNewStageBtn__1BXuT\",\"Arrow\":\"MissionPlanStages_Arrow__2_v6J\",\"arrow-grow\":\"MissionPlanStages_arrow-grow__3sfMh\",\"LabelsWrapper\":\"MissionPlanStages_LabelsWrapper__2rpm0\",\"StageTypeLabel\":\"MissionPlanStages_StageTypeLabel__JEDAg\",\"StageParamsLabel\":\"MissionPlanStages_StageParamsLabel__3TjxM\"};","export default __webpack_public_path__ + \"static/media/newLogo.c9fb1139.svg\";","import React, { PureComponent } from 'react';\nimport classNames from './LoaderAlt.module.css';\n\nexport default class Loader extends PureComponent {\n\n  renderOverlay() {\n    return this.props.withOverlay ? <div className={classNames.Overlay}></div> : null;\n  }\n  render() {\n    return (\n      <>\n        {this.renderOverlay()}\n        <div className={classNames.loader} data-message={this.props.loadingMessage}>\n          <div className={classNames.bg}></div>\n          <div className={classNames.circle}></div>\n          <div className={classNames.circle}></div>\n          <div className={classNames.circle}></div>\n          <div className={classNames.circle}></div>\n          <div className={classNames.circle}></div>\n        </div>\n      </>\n    );\n  }\n}","import React, { PureComponent}  from 'react'\nimport classNames from './Clock.module.css';\n\nexport default class Clock extends PureComponent {\n    \n    state = {\n        date: new Date()\n    }\n\n    componentDidMount() {\n        setInterval(\n          () =>\n            this.setState({\n              date: new Date()\n            }),\n          1000\n        );    \n    }\n    \n    getFormatedData() {\n        const {date} = this.state;\n        const year = date.getFullYear();\n        const month = date.toLocaleString('en', { month: 'short' });        \n        let day = date.getDate();\n        day = day < 10 ? `0${day}` : day;\n        return `${month}. ${day} ${year},`;\n    }\n\n    render() {\n        return (\n            <span className={classNames.DateTime}>                \n                <span className={classNames.Hour}>{this.state.date.toLocaleTimeString(navigator.language,{hour12: false})}</span>\n            </span>\n        )\n    }\n}\n","export default __webpack_public_path__ + \"static/media/close.46b1631b.svg\";","import React, { Component } from 'react'\r\nimport cn from './Input.module.css';\r\n//import validationX from '../../assets/images/close-red.svg';\r\n//import Tooltip from '../Tooltip/Tooltip';\r\n\r\nexport default class Input extends Component {\r\n    state = {\r\n        isShowInfoTooltip: false\r\n    }\r\n\r\n    showInfoTooltip = e => {\r\n        this.setState({ isShowInfoTooltip: true, clientX: e.target.getBoundingClientRect().left, clientY: e.target.getBoundingClientRect().top });\r\n    }\r\n\r\n    hideTooltip = () => this.setState({ isShowInfoTooltip: false, clientX: null, clientY: null })\r\n\r\n    renderInfo() {\r\n        if (this.props.info) {\r\n            return (\r\n                <span className={cn.InfoImage} onMouseEnter={this.showInfoTooltip} onMouseLeave={this.hideTooltip}>\r\n                    {/* {\r\n                        this.state.isShowInfoTooltip ? \r\n                            (<Tooltip \r\n                                title={this.props.info.title}\r\n                                text={this.props.info.text}\r\n                                x={this.state.clientX}\r\n                                y={this.state.clientY}\r\n                            />) : null\r\n                    } */}\r\n                </span>\r\n            )\r\n        }\r\n    }\r\n\r\n    getInputByType = () => {\r\n        const value = this.props.value;\r\n        switch (this.props.type) {\r\n            case \"Coordinate\":\r\n                return (\r\n                    <div className={cn.InnerInputWrapper}>\r\n                        {this.props.button && <span className={`${cn.Icon} ${cn.PositionIcon}`} title=\"Select On Map\" onClick={() => this.props.button.action()} />}\r\n                        {this.getInputField(value && value.x || \"\", 'X')}\r\n                        {this.getInputField(value && value.y || \"\", 'Y')}\r\n                        {this.getInputField(value && value.z || \"\", 'Z')}\r\n                    </div>)\r\n            default:\r\n                return this.getInputField(value, this.props.placeHolder);\r\n        }\r\n    }\r\n\r\n\r\n\r\n    render() {\r\n        const mandatoyClass = this.props.mandatory ? ` ${cn.Mandatory}` : '';\r\n        const disabled = this.props.disabled ? ` ${cn.Disabled}` : '';\r\n        const errorClass = this.props.error ? ` ${cn.ShowError}` : '';\r\n        const readOnly = this.props.readOnly ? ` ${cn.readOnly}` : '';\r\n        return (\r\n            <div className={`${cn.Row}${disabled}`}>\r\n                <span className={`${cn.Label}${mandatoyClass}`}>{this.props.label}{this.renderInfo()}</span>\r\n                <div className={cn.InputWrapper}>\r\n                <div className={cn.InnerInputWrapper}>\r\n                    <input\r\n                        ref={this.props.parentRef || null}\r\n                        placeholder={this.props.placeHolder}\r\n                        value={this.props.value}\r\n                        name={this.props.name}\r\n                        className={`${cn.Input}${errorClass}${readOnly}`}\r\n                        maxLength={this.props.maxLength || null}\r\n                        type={this.props.type || 'text'}\r\n                        onFocus={this.props.onFocus}\r\n                        onChange={this.props.onChange}\r\n                        readOnly={this.props.readOnly || this.props.disabled} />\r\n                         </div>\r\n                    {/*<img className={`${cn.ValidationImg}${errorClass}`} src={validationX} alt=\"\"/>*/}\r\n                    <div className={`${cn.ValidationMessage}${errorClass}`}>{this.props.error || ''}</div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","import React, { Component } from 'react';\nimport cn from './SingleInputForm.module.css';\nimport {connect} from 'react-redux';\nimport Input from '../controls/Input/Input';\n\nclass SingleInputForm extends Component {\n    inputRef = React.createRef()\n    state = {\n        value: ''\n    }\n\n    componentDidMount() {\n        if (this.inputRef && this.inputRef.current) {\n          this.inputRef.current.focus();\n        }\n    }\n\n    \n    onValueChange = e => {        \n        const newValue = e.target.value;\n\n        this.setState({\n            value: newValue\n        }, () => this.props.onValueChange(newValue))\n    }\n\n    render() {\n        return (            \n            <div className={cn.Wrapper}>                \n                <Input \n                    parentRef={this.inputRef}\n                    value={this.state.value || this.props.defaultValue}\n                    onChange={this.onValueChange}\n                    placeHolder= {this.props.placeHolder || \"\"}\n                    label={this.props.label} />\n            </div>\n        );\n    }\n}\n\nconst mapStateToProps = (state, ownProps) => {        \n    return {        \n        //scaleValue: state.layout.selectedConfigPerService[ownProps.name].scale\n    }\n};\n\nconst mapDispachToProps = dispatch => {\n    return {        \n        \n    }\n}\n\nexport default connect(\n    mapStateToProps,\n    mapDispachToProps\n)(SingleInputForm)\n","import { components } from 'react-select';\r\nimport React from 'react';\r\nimport cn from './Select.module.css';\r\n\r\nexport const DropdownIndicator = props => {\r\n    return (\r\n        <components.DropdownIndicator {...props}>\r\n            <span className={cn.DropDownArrow}/>\r\n        </components.DropdownIndicator>\r\n    );\r\n};\r\n\r\nexport const dropDownStyles = {\r\n\r\n    container: (provided, state) => ({\r\n        ...provided,\r\n        cursor: state.isDisabled ? \"not-allowed\" : \"pointer\",\r\n        width: '100%',\r\n        fontSize: '14px',\r\n        fontWeight: '400',\r\n        lineHeight: '1.5',\r\n        color: 'var(--input-text-text-color)',\r\n        background: 'var(--input-text-bg-color)',\r\n        border: '1px solid var(--input-border-color)',\r\n        borderRadius: '4px',\r\n        textTransform: 'capitalize',\r\n\r\n    }),\r\n    option: (provided, state) => ({\r\n        ...provided,\r\n        '&:hover': {\r\n            backgroundColor: '#b4b4b425',\r\n        },\r\n        color: 'var(--app-font-color)',\r\n        fontSize: 'var(--app-font-size)',\r\n        whiteSpace: 'nowrap',\r\n        overflow: 'hidden',\r\n        textOverflow: 'ellipsis',\r\n        textTransform: 'capitalize',\r\n        backgroundColor: state.isSelected || state.isFocused ? '#b4b4b425' : 'trasparent',\r\n        border: state.isSelected ? '1px solid var(--app-select-selected-border-color)' : 'none',\r\n        cursor: state.isDisabled ? \"not-allowed\" : \"pointer\",\r\n    }),\r\n    control: (provided, state) => ({\r\n        // none of react-select's styles are passed to <Control />\r\n        ...provided,\r\n        borderRadius: '2px',\r\n        backgroundColor: 'transparent',\r\n        minHeight: 'unset',\r\n        borderColor: \"transparent\",\r\n        color: 'var(--app-font-color)',\r\n        boxShadow: state.isFocused ? 0 : 0,\r\n        '&:hover': {\r\n            //borderColor: '#7f7f7f'\r\n        },\r\n        cursor: state.isDisabled ? \"not-allowed\" : \"pointer\",\r\n    }),\r\n    menu: (provided) => ({\r\n        ...provided,\r\n        backgroundColor: '#191919',\r\n        paddingTop: 0,\r\n        marginTop: 2,\r\n        border: '1px solid var(--input-border-color)',\r\n        maxHeight: '150px',\r\n        overflow: 'auto'\r\n    }),\r\n    valueContainer: (provided) => ({\r\n        ...provided,\r\n        fontSize: 'var(--app-font-size)',\r\n\r\n    }),\r\n    indicatorSeparator: (provided) => ({\r\n        ...provided,\r\n        display: 'none'\r\n    }),\r\n    dropdownIndicator: defaultStyles => ({\r\n        ...defaultStyles,\r\n        color: 'black' // your changes to the arrow\r\n    }),\r\n    singleValue: (provided) => ({\r\n        ...provided,\r\n        fontSize: 'var(--app-font-size)',\r\n        fontWeight: 400,\r\n        color: 'var(--container-list-header-item-color)'\r\n    }),\r\n    placeholder: (provided) => ({\r\n        ...provided,        \r\n        color: 'var(--app-font-color)'\r\n    }),\r\n    noOptionsMessage: (provided) => ({\r\n        ...provided,\r\n        fontWeight: 400,\r\n        color: 'var(--app-font-color)',\r\n        fontSize: 'var(--app-font-size)',\r\n    }),\r\n\r\n}\r\n","import React, { Component } from 'react'\r\nimport cn from './Select.module.css';\r\nimport { DropdownIndicator, dropDownStyles } from './reactSelectStyles';\r\nimport Select from 'react-select';\r\n\r\nexport default class CustomSelect extends Component {\r\n\r\n\r\n\r\n    render() {\r\n        const props = {\r\n            ...this.props,\r\n            styles: dropDownStyles,\r\n            components: {\r\n                DropdownIndicator\r\n            },\r\n        }\r\n\r\n\r\n        return (\r\n            <div className={cn.DropDownWrapper}>\r\n                <label className={cn.ComboLabel}>{this.props.label}</label>\r\n                <Select {...props} />\r\n            </div>\r\n        )\r\n    }\r\n}","import SingleInputForm from '../SingleInputForm/SingleInputForm';\r\nimport AddMissionPlanStageForm from '../MissionPlanner/AddMissionPlanStageForm/AddMissionPlanStageForm';\r\n\r\nconst popupChildren = {\r\n        SingleInputForm,\r\n        AddMissionPlanStageForm,\r\n};\r\n\r\nexport default popupChildren;","import React, { Component } from 'react'\r\nimport cn from './AddMissionPlanStageForm.module.css';\r\nimport Select from '../../controls/Select/Select';\r\nimport Input from '../../controls/Input/Input';\r\n\r\nexport default class AddMissionPlanStageForm extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            selectedStageType: props.stage && props.stage.selectedStageType || null,\r\n            stageParamsInput: props.stage && props.stage.stageParamsInput || '',\r\n            multiParamsInput: this.parseMultiParams() || {},\r\n            stageId: props.stage && props.stage.stageId || Math.round(Math.random() * 100000),\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.props.onPopupInitalLoad) {\r\n            this.props.onPopupInitalLoad(this.getMissionPlanState);\r\n        }\r\n    }\r\n    componentDidUpdate(prevProps) {\r\n        if (prevProps.pointFromMap != this.props.pointFromMap) {\r\n            const pointFromMap = this.props.pointFromMap;\r\n            const stageParamsInput = pointFromMap.x + \",\" +pointFromMap.y + \",\" + pointFromMap.z;\r\n            this.setState({ multiParamsInput: pointFromMap , stageParamsInput })\r\n        }\r\n    }\r\n    parseMultiParams = () => {\r\n        if (this.props.stage && this.props.stage.stageParamsInput!=\"\") {\r\n            const [x, y, z] = this.props.stage.stageParamsInput.split(',');\r\n            return {x,y,z};\r\n        }\r\n        else{\r\n            return null\r\n        }\r\n    }\r\n    getMissionPlanState = () => {\r\n        return this.state;\r\n    }\r\n\r\n    handleTypeChange(selectedStageType) {\r\n        this.setState({\r\n            selectedStageType,\r\n            stageParamsInput: '',\r\n            multiParamsInput: {}\r\n        });\r\n    }\r\n\r\n\r\n    renderStageType() {\r\n        const options = [\r\n            { label: 'Go To Waypoint', isMultiInputs: true, params: { label: 'Waypoint Coordinate:', }, rossService: 'addMissionWP' },\r\n            { label: 'Pause', params: { label: 'Pause for:', placeHolder: \"seconds\" } },\r\n            { label: 'Takeoff', params: { label: 'Height:', placeHolder: \"meters\" }, rossService: 'addMissionTakeoff' },\r\n            { label: 'Set Speed', params: { label: 'Speed Value:', placeHolder: \"km/h\" } },\r\n            { label: 'Set Waypoint Radius', params: { label: 'Radius Value:', placeHolder: \"meters\" } },\r\n        ]\r\n\r\n        const dropDownData = {\r\n            label: 'Select Stage Type:',\r\n            defaultValue: this.state.selectedStageType || { label: \"Select...\", value: \"Select...\" },\r\n            options,\r\n            onChange: selectedTypeValue => this.handleTypeChange(selectedTypeValue)\r\n        };\r\n\r\n\r\n        return (\r\n            <div className={cn.Row}>\r\n                <Select {...dropDownData} />\r\n            </div>\r\n        )\r\n    }\r\n    onInputChange(e, subField) {\r\n        let { stageParamsInput, multiParamsInput } = this.state;\r\n        if (subField) {\r\n\r\n            multiParamsInput[subField] = e.target.value;\r\n            stageParamsInput = multiParamsInput.x + \",\" + multiParamsInput.y + \",\" + multiParamsInput.z;\r\n        }\r\n        else {\r\n            stageParamsInput = e.target.value;\r\n        }\r\n        this.setState({ stageParamsInput, multiParamsInput });\r\n\r\n    }\r\n\r\n    renderStageInput() {\r\n        if (!this.state.selectedStageType ||\r\n            !this.state.selectedStageType.params) {\r\n            return;\r\n        }\r\n\r\n        const { selectedStageType, stageParamsInput, multiParamsInput } = this.state;\r\n\r\n\r\n        return (\r\n            <div className={cn.Row}>\r\n                <span className={`${cn.Label}`}>{this.state.selectedStageType.label + \":\"}</span>\r\n                <div className={cn.InputWrapper}>\r\n                    {selectedStageType.isMultiInputs ?\r\n                        <>\r\n                            <span className={`${cn.Icon} ${cn.PositionIcon}`} title=\"Select On Map\" onClick={this.props.selectPointFromMap} />\r\n                            {this.getInputField(multiParamsInput.x, 'x')}\r\n                            {this.getInputField(multiParamsInput.y, 'y')}\r\n                            {this.getInputField(multiParamsInput.z, 'z')}\r\n                        </>\r\n                        :\r\n                        this.getInputField(stageParamsInput)\r\n                    }\r\n                </div>\r\n            </div>\r\n        )\r\n\r\n    }\r\n\r\n    getInputField = (value, subField) => {\r\n        const selectedStageType = this.state.selectedStageType;\r\n        return (\r\n            <div className={cn.InnerInputWrapper}>\r\n                <Input\r\n                    parentRef={this.inputRef}\r\n                    value={value !== null && value !== undefined? value : \"\"}\r\n                    onChange={e => this.onInputChange(e, subField)}\r\n                    disabled={false}\r\n                    type={selectedStageType.params.type || \"\"}\r\n                    placeHolder={subField || selectedStageType.params.placeHolder || \"\"}\r\n                    button={selectedStageType.params.button || null}\r\n                />\r\n            </div>\r\n        )\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className={cn.Wrapper}>\r\n                {this.renderStageType()}\r\n                {this.renderStageInput()}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","import React, { PureComponent } from 'react';\nimport cn from './Popup.module.css';\nimport closeImg from '../../assets/images/close.svg';\nimport PopupChildren from './PopupChildren';\nimport { connect } from 'react-redux';\nimport actionTypes from '../../store/actions/actionTypes';\n\nclass Popup extends PureComponent {\n    EscKey = 27;\n    EnterKey = 13;\n\n    componentDidMount() {\n        document.addEventListener('keydown', this.handleKeyDown);\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('keydown', this.handleKeyDown);\n    }\n\n    handleKeyDown = (e) => {\n        if (e.keyCode === this.EscKey) {\n            this.closePopup();\n        } else if ((e.keyCode === this.EnterKey) && this.props.popupDetails.primayButton && this.props.popupDetails.primayButton.callback) {\n            this.props.popupDetails.primayButton.callback();\n            this.closePopup();\n        }\n    }\n\n    closePopup = () => {\n        if (this.props.popupDetails && this.props.popupDetails.onCloseButtonClick) {\n            this.props.popupDetails.onCloseButtonClick();\n        }\n        this.props.hidePopup();\n    }\n\n    onCloseBtnClick = e => {\n        e.preventDefault();\n        this.closePopup()\n    }\n\n    getXBtn() {\n        return (\n            this.props.hideXButton ? null :\n                <a className={cn.Close} href=\"#\" onClick={this.onCloseBtnClick}>\n                    <img className={cn.closeBtn} src={closeImg} />\n                </a>\n        );\n    }\n    closePopup() {\n        if (this.props.popupDetails && this.props.popupDetails.onCloseButtonClick) {\n            this.props.popupDetails.onCloseButtonClick();\n        }\n        this.props.hidePopup();\n    }\n\n    onPrimaryBtnClick = e => {\n        e.preventDefault();\n        if (this.props.popupDetails.primayButton && this.props.popupDetails.primayButton.callback) {\n            this.props.popupDetails.primayButton.callback();\n        }\n        this.closePopup();\n    }\n\n    onSecondaryBtnClick = e => {\n        e.preventDefault();\n        if (this.props.popupDetails.secondaryButton && this.props.popupDetails.secondaryButton.callback) {\n            this.props.popupDetails.secondaryButton.callback();\n        }\n        this.closePopup();\n    }\n\n    renderButtons() {\n        //default primary button in case no other button was injected as props\n        let primaryButton = <button type=\"button\" className={`${cn.Btn} ${cn.BtnPrimary}`} onClick={this.onPrimaryBtnClick}>Close</button>;\n        let secondaryButton = null;\n        const popupDetails = this.props.popupDetails;\n\n        if (popupDetails.primayButton) {\n            let disabled = popupDetails.primayButton.disabled;\n            primaryButton =\n                <button type=\"button\"\n                    className={`${cn.FormButton} ${cn.Apply} ${disabled ? cn.Disabled : \"\"}`}\n                    onClick={disabled ? undefined : this.onPrimaryBtnClick}>\n                    {popupDetails.primayButton.title}\n                </button>;\n        }\n\n        if (popupDetails.secondaryButton) {\n            let disabled = popupDetails.secondaryButton.disabled;\n            secondaryButton =\n                <button type=\"button\"\n                    className={`${cn.FormButton}   ${disabled ? cn.Disabled : \"\"}`}\n                    onClick={disabled ? undefined : this.onSecondaryBtnClick}>\n                    {popupDetails.secondaryButton.title}\n                </button>\n        }\n\n        return (\n            <>\n                {secondaryButton}\n                {primaryButton}\n            </>\n        )\n    }\n\n    getFooter() {\n        return (\n\n            <div className={cn.PopupFooter}>\n                <div>\n                    {this.renderButtons()}\n                </div>\n            </div>\n        );\n    }\n\n    getHeader() {\n        return (\n            <div className={cn.PopupHeader}>\n                <div className={cn.PopupHeaderWrapper}>\n                    <h2 className={cn.h2}>{this.props.popupDetails.title}</h2>\n                    {this.getXBtn()}\n                </div>\n            </div>\n        );\n    }\n\n    renderChild() {\n        const Child = PopupChildren[this.props.popupDetails.modalChild];\n        return <Child {...this.props.popupDetails.modalChildProps} />;\n    }\n\n    getBody() {\n        const noBodyOverflowClass = this.props.noBodyOverflow ? cn.NoBodyOverFlow : '';\n\n        const body =\n            <div className={`${cn.PopupBody} ${noBodyOverflowClass}`}>\n                {this.props.popupDetails.modalChild ? this.renderChild() : null}\n            </div>;\n        return body;\n    }\n\n    render() {\n        if (!this.props.popupDetails) return null;\n        let visibility = this.props.isPointSelectionMode ? { visibility: \"hidden\" } : {};\n        const size = this.props.popupDetails.size ? cn[this.props.popupDetails.size] : '';\n        return (\n            <div className={cn.Overlay} >\n                <div className={`${cn.Popup} ${size}`} style={visibility}>\n                    {this.getHeader()}\n                    {this.getBody()}\n                    {this.getFooter()}\n                </div>\n            </div>\n        )\n    }\n}\n\nconst mapStateToProps = state => {\n    return {\n        isPointSelectionMode: state.layout.isPointSelectionMode\n    }\n};\n\nconst mapDispachToProps = dispatch => {\n    return {\n        hidePopup: () => dispatch({ type: actionTypes.HIDE_POPUP })\n\n    }\n}\n\nexport default connect(\n    mapStateToProps,\n    mapDispachToProps\n)(Popup)","export default __webpack_public_path__ + \"static/media/infoFull.ec8088f8.svg\";","export default __webpack_public_path__ + \"static/media/success.6d75a589.svg\";","export default __webpack_public_path__ + \"static/media/errorIcon.30e82293.svg\";","export default __webpack_public_path__ + \"static/media/warnIcon.0c100db2.svg\";","import React,{ PureComponent } from 'react';\r\nimport classNames from './GlobalMessage.module.css';\r\nimport infoIcon from '../../assets/images/infoFull.svg';\r\nimport successIcon from '../../assets/images/success.svg';\r\nimport errorIcon from '../../assets/images/errorIcon.svg';\r\nimport warnIcon from '../../assets/images/warnIcon.svg';\r\nimport { connect } from 'react-redux';\r\nimport { logSeverities } from '../../config';\r\n\r\nclass GlobalMessage extends PureComponent {    \r\n    \r\n    renderIcon() {\r\n        let icon;\r\n        switch (this.props.appGlobalMessage.type) {\r\n            case logSeverities.info:\r\n                icon = infoIcon;\r\n                break;\r\n            case logSeverities.success:\r\n                icon = successIcon;\r\n                break;\r\n            case logSeverities.warn:\r\n                icon = warnIcon;\r\n                break;\r\n            case logSeverities.error:\r\n                icon = errorIcon;\r\n                break;        \r\n            default:\r\n                icon = infoIcon;\r\n                break;\r\n        }\r\n        return <img className={classNames.Icon} src={icon}></img>\r\n    }\r\n    renderText(text) {\r\n        return <div className={classNames.Text}>{text}</div>\r\n    }\r\n\r\n    renderNotification(notification) {\r\n        const missionPlannerOpenClass = this.props.isMissionPlanScreenHidden ? '' : ` ${classNames.MissionPlannerOpen}`;\r\n\r\n        return (\r\n            <div className={`${classNames.Wrapper}${missionPlannerOpenClass}`}>\r\n                {this.renderIcon()}\r\n                {this.renderText(notification.text)}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    render() {      \r\n        const {appGlobalMessage} = this.props;\r\n        return appGlobalMessage && appGlobalMessage.text ? this.renderNotification(appGlobalMessage) : null\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        appGlobalMessage: state.layout.appGlobalMessage,\r\n        isMissionPlanScreenHidden: state.layout.isMissionPlanScreenHidden\r\n    };\r\n};\r\n\r\nconst mapDispachToProps = (dispatch) => {\r\n    return {\r\n        \r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispachToProps)(GlobalMessage);","import React, {Component} from 'react';\r\nimport classNames from './ContextMenu.module.css';\r\nimport { connect } from 'react-redux';\r\nimport actionTypes from '../../store/actions/actionTypes';\r\n\r\nclass ContextMenu extends Component {\r\n\r\n\r\n    CONTEXT_MENU_WIDTH = 150;        \r\n    contextRef = React.createRef();\r\n\r\n    state = {\r\n      top: 0,\r\n      left: 0,\r\n      menuItems: []\r\n    }\r\n\r\n    componentDidMount() {\r\n      document.addEventListener('mousedown', this.closeContextMenu); \r\n      this.updatePosition(this.props.contextMenu.x, this.props.contextMenu.y, this.props.contextMenu.items)     \r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener('mousedown', this.closeContextMenu);\r\n    }\r\n\r\n    getNewTop(top) {\r\n      const menuHight = 35 * this.props.contextMenu.items.length;\r\n      if (top +  menuHight > document.body.offsetHeight) {        \r\n        return top - menuHight;\r\n      }\r\n      return top;\r\n    }\r\n    \r\n   updatePosition( left ,top, menuItems) {     \r\n     this.setState({\r\n       top: this.getNewTop(top) ,\r\n       left : ( left + this.CONTEXT_MENU_WIDTH )  > document.body.offsetWidth ? document.body.offsetWidth - 20 : left ,       \r\n       menuItems\r\n     })\r\n   }\r\n\r\n   \r\n   closeContextMenu = (e) => {\r\n     if (this.contextRef && this.contextRef.current && !this.contextRef.current.contains(e.target)) {\r\n        this.props.closeContextMenu();\r\n     }\r\n   }\r\n\r\n\r\n   onItemClick = (menuItem) => {\r\n     menuItem.func && menuItem.func(menuItem.task);\r\n      this.props.closeContextMenu();\r\n   }\r\n\r\n    render() {\r\n      const closeClass = ((this.state.menuItems != null) && (this.state.menuItems.length > 0))  ?  '' : classNames.Close;\r\n      const side = this.props.contextMenu.options && this.props.contextMenu.options.side ? classNames[this.props.contextMenu.options.side] : '';\r\n      \r\n      let menuItems = \"\";\r\n\r\n      if (this.state.menuItems && this.state.menuItems.length > 0) {\r\n\r\n        menuItems = \r\n           this.state.menuItems.map((menuItem,index) => \r\n                                    <li key={index}\r\n                                        title={menuItem.title}\r\n                                        className={classNames.menuItem} \r\n                                        onClick={() => this.onItemClick(menuItem)}\r\n                                        style={{cursor : menuItem.func ? \"pointer\" : \"default\"}}\r\n                                    >\r\n                                       {menuItem.iconCss && <span className={`${classNames.ContextMenuIcon} ${classNames[menuItem.iconCss]}`}/>}\r\n                                        <div className={classNames.menuName}>{menuItem.name}</div>\r\n                                    </li>\r\n                         );\r\n      }\r\n\r\n      return(\r\n        <div style={{top: this.state.top , left: this.state.left}} className={`${classNames.contextMenu} ${closeClass}`} ref={this.contextRef}>\r\n          <ul  className={`${classNames.contextMenuUL} ${closeClass} ${side}`}>\r\n            {menuItems}\r\n          </ul>\r\n        </div>\r\n      )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    \r\n  }\r\n};\r\n\r\nconst mapDispachToProps = dispatch => {\r\n  return {\r\n    closeContextMenu: () => dispatch({ type: actionTypes.CLOSE_CONTEXT_MENU}),\r\n  }\r\n}\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispachToProps\r\n)(ContextMenu)\r\n\r\n   ","import React, { Component } from 'react'\r\nimport cn from './FlightTelemetry.module.css'\r\nimport { connect } from 'react-redux';\r\nclass FlightTelemetry extends Component {\r\n\r\n    getAltitue(dronePositionOffset) {\r\n        if (dronePositionOffset && dronePositionOffset.z > 0) {\r\n            return dronePositionOffset.z.toFixed(1);\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    render() {\r\n        const {dronePositionOffset} = this.props;\r\n        return (\r\n            <div className={cn.Wrapper}>\r\n                <span className={cn.TelemetryWrapper}>\r\n                    <span>Altitude:</span>\r\n                    <span>{this.getAltitue(dronePositionOffset)}<span className={cn.Units}>m</span></span>\r\n                </span>\r\n                <span className={cn.TelemetryWrapper}>\r\n                    <span>Speed:</span>\r\n                    <span>21<span className={cn.Units}>km/h</span></span>\r\n                </span>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        dronePositionOffset: state.map.dronePositionOffset\r\n    };\r\n};\r\n\r\nconst mapDispachToProps = (dispatch) => {\r\n    return {\r\n      \r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispachToProps)(FlightTelemetry);","export default __webpack_public_path__ + \"static/media/target.ce3b4521.svg\";","import React, { Component } from 'react';\nimport cn from './Slider.module.css';\n\nexport default class Slider extends Component {\n\n    constructor(props) {\n        super(props);\n\n        this.sliderLine = React.createRef();\n\n        this.state = {\n            offset: 0,\n            prevOffset: this.props.sliderOffset ? this.props.sliderOffset : 0,\n            dragging: false,\n            startY: null\n        };\n    }\n\n    componentDidUpdate = (prevProps, prevState) => {\n        if (this.state.dragging && !prevState.dragging) {\n            document.addEventListener('mousemove', this.onMouseMove)\n            document.addEventListener('mouseup', this.onMouseUp)\n        } else if (!this.state.dragging && prevState.dragging) {\n            document.removeEventListener('mousemove', this.onMouseMove)\n            document.removeEventListener('mouseup', this.onMouseUp)\n        }\n    }\n\n    getOffset = () => {\n        let offset = this.state.prevOffset + this.state.offset;\n        return offset > 100 ? 100 : offset < 0 ? 0 : offset;\n    }\n\n    onMouseDown = (e) => {\n        this.setState({ dragging: true, startY: e.pageY, prevOffset: this.getOffset(), offset: 0 })\n        e.stopPropagation();\n        e.preventDefault();\n    }\n    onMouseUp = (e) => {\n        this.setState({ dragging: false });\n        this.props.updatePosition(this.getOffset());\n        e.stopPropagation();\n        e.preventDefault();\n    }\n    onMouseMove = (e) => {\n        if (!this.state.dragging) return;\n        this.setState({\n            offset: (e.pageY - this.state.startY)\n        })\n        e.stopPropagation();\n        e.preventDefault();\n    }\n    onLineClick = (e) => {\n        this.setState({\n            offsetY: e.pageY - this.state.prevPos\n        })\n        e.stopPropagation();\n        e.preventDefault();\n    }\n\n\n\n    render() {\n        let moveDraggable = { \"marginTop\": `${this.getOffset()}px` };\n        return (\n            <div className={cn.sliderWrapper}>\n                <div className={cn.mapslider}>\n                    <div className={cn.buttons}>\n                        <div className={cn.dragline}>\n                            <div className={cn.line} ref={this.sliderLine} onClick={(e) => this.onLineClick(e)} />\n                            <div className={cn.draggablebutton} style={moveDraggable}\n                                onMouseDown={(e) => this.onMouseDown(e)}\n                                onMouseUp={(e) => this.onMouseUp(e)}\n                                onMouseMove={(e) => this.onMouseMove(e)} />\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n","import React, { Component } from 'react';\r\nimport cn from './Video.module.css';\r\nimport { connect } from 'react-redux';\r\nimport actions from '../../store/actions';\r\nimport actionTypes from '../../store/actions/actionTypes';\r\nimport externalConfig from '../../ExternalConfigurationHandler';\r\nimport config, { devVideoSnapshotUrl, devVideoStreamUrl } from '../../config';\r\nimport targetIcon from '../../assets/images/target.svg';\r\nimport Slider from '../controls/Slider/Slider';\r\n\r\n\r\nclass Video extends Component {\r\n\r\n    state = {\r\n        isImageLoadingError: false,\r\n        isImageLoading: true,\r\n        isFullScreen: false,\r\n        targetPosition: null,\r\n        showTarget: true,\r\n        showExposure: false,\r\n        isRecording: false\r\n\r\n    }\r\n\r\n    componentDidMount() {\r\n        //window.addEventListener('resize', this.setTargetPosition)\r\n    }\r\n\r\n    getVideoSrc() {\r\n        const { BE_PORT, BE_IP } = externalConfig.getConfiguration();\r\n\r\n        const snapshotUrl = `//${BE_IP}:${BE_PORT}${config.urls.videoSnapshot}`;\r\n        const streamUrl = `//${BE_IP}:${BE_PORT}${config.urls.videoStream}`;\r\n\r\n        if (this.props.isPaused) {\r\n            return process.env.NODE_ENV === 'developments' ? devVideoSnapshotUrl : snapshotUrl;\r\n        } else {\r\n            return process.env.NODE_ENV === 'developments' ? devVideoStreamUrl : streamUrl;\r\n        }\r\n    }\r\n\r\n    onVideoError = (e) => {\r\n        console.log('error when trying to load camera video', e);\r\n        this.setState({\r\n            isImageLoadingError: true\r\n        })\r\n    }\r\n\r\n    setTargetPosition = () => {\r\n        const img = document.getElementById('droneImage');\r\n        if (!img) return;\r\n        const rect = img.getBoundingClientRect();\r\n        if (!rect) return;\r\n\r\n        this.setState({\r\n            targetPosition: {\r\n                top: rect.top + (rect.height / 2),\r\n                left: rect.left + (rect.width / 2)\r\n            }\r\n        })\r\n    }\r\n\r\n    onVideoLoaded = e => {\r\n        //this.setTargetPosition();\r\n        this.setState({\r\n            isImageLoading: false\r\n        })\r\n    }\r\n\r\n    onPauseOrPlayClick = e => {\r\n        e.stopPropagation();\r\n        this.props.isPaused ? this.props.resume() : this.props.pause()\r\n    }\r\n\r\n    onFullScreenClick = () => {\r\n        //const elem = document.querySelector('#droneImage');\r\n        const elem = document.querySelector('#videoWrapper');\r\n        if (elem.requestFullscreen) {\r\n            elem.requestFullscreen();\r\n        } else if (elem.webkitRequestFullscreen) { /* Safari */\r\n            elem.webkitRequestFullscreen();\r\n        } else if (elem.msRequestFullscreen) { /* IE11 */\r\n            elem.msRequestFullscreen();\r\n        }\r\n        this.setState({ isFullScreen: true })\r\n    }\r\n\r\n    onExitFullScreenClick = () => {\r\n        // bug when we are in full screen and click on ESC key\r\n        if (document.fullscreenElement === null) {\r\n            this.onFullScreenClick();\r\n        } else {\r\n            if (document.exitFullscreen) {\r\n                document.exitFullscreen();\r\n            } else if (document.webkitExitFullscreen) { /* Safari */\r\n                document.webkitExitFullscreen();\r\n            } else if (document.msExitFullscreen) { /* IE11 */\r\n                document.msExitFullscreen();\r\n            }\r\n            this.setState({ isFullScreen: false })\r\n        }\r\n    }\r\n\r\n    getPlayOrPauseButton() {\r\n        return this.props.isPaused ? cn.Play : cn.Pause\r\n    }\r\n\r\n    getPlayOrPauseTitle() {\r\n        return this.props.isPaused ? 'Play' : 'Pause'\r\n    }\r\n\r\n    getRecordButton = () => {\r\n        return this.state.isRecording ? cn.RecordindIcon : cn.RecordIcon\r\n    }\r\n\r\n    getRecordTitle = () => {\r\n        return this.state.isRecording ? 'Recording' : 'Start Recording'\r\n    }\r\n\r\n    renderVideoHeader() {\r\n        const hideTargetClass = this.state.showTarget ? '' : cn.HideTarget;\r\n        return (\r\n            <div className={`${cn.VideoHeader}`}>\r\n                <div className={cn.Description}>\r\n                    {this.props.isPaused ? 'Video paused' :\r\n                        <span className={cn.StreamingIconWrapper}>Video Feed<span className={cn.StreamingIcon} /></span>\r\n                    }\r\n                </div>\r\n                <span className={`${cn.Exposure}`}\r\n                    onClick={() => this.setState({ showExposure: !this.state.showExposure })}>\r\n                </span>\r\n                {this.props.weaponDetected && <span className={`${cn.ToggleTarget} ${hideTargetClass}`}\r\n                    onClick={() => this.setState({ showTarget: !this.state.showTarget })}>\r\n                </span>\r\n                }\r\n            </div>\r\n        )\r\n    }\r\n\r\n    renderVideoFooter() {\r\n        return (\r\n            <>\r\n                <button\r\n                    onClick={this.onPauseOrPlayClick}\r\n                    title={this.getPlayOrPauseTitle()}\r\n                    className={`${cn.ControlBtn} ${this.getPlayOrPauseButton()}`}>\r\n                </button>\r\n                <button\r\n                    onClick={() => this.setState({ isRecording: !this.state.isRecording })}\r\n                    title={this.getRecordTitle()}\r\n                    className={`${cn.ControlBtn} ${cn.RecordButton}`}>\r\n                    <span className={`${this.getRecordButton()}`} />\r\n                </button>\r\n                <button\r\n                    onClick={this.state.isFullScreen ? this.onExitFullScreenClick : this.onFullScreenClick}\r\n                    title={this.state.isFullScreen ? 'Exit Full Screen' : 'Full Screen'}\r\n                    className={`${cn.ControlBtn} ${this.state.isFullScreen ? cn.ExitFullScreen : cn.FullScreen}`}>\r\n                </button>\r\n            </>\r\n        )\r\n    }\r\n\r\n    updateExposure(sliderOffset) {\r\n        const exposureValue = config.EXPOSURE_MAX_LEVEL * (100 - sliderOffset) / 100;\r\n        console.log(\"new exposureValue is \", exposureValue);\r\n        this.setState({ sliderOffset });\r\n        this.props.setExposure(exposureValue)\r\n    }\r\n\r\n    renderImgElement() {\r\n\r\n        if (this.state.isImageLoadingError) {\r\n            return (\r\n                <div className={cn.ErrorMessage}><span className={cn.ErrorIcon}></span> Error loading video stream</div>\r\n            )\r\n        }\r\n        const largeTarget = this.state.isFullScreen ? ` ${cn.TargetLarge}` : '';\r\n        return (\r\n            <>\r\n                {this.renderVideoHeader()}\r\n\r\n                {this.state.showTarget && this.props.weaponDetected &&\r\n                    <img className={`${cn.TargetIcon}${largeTarget}`} style={this.state.targetPosition} src={targetIcon} />\r\n                }\r\n\r\n                {this.state.showExposure &&\r\n                    <Slider sliderOffset={this.state.sliderOffset} updatePosition={(offset) => this.updateExposure(offset)} />\r\n                }\r\n\r\n                <img\r\n                    crossOrigin=\"anonymous\"\r\n                    onLoad={this.onVideoLoaded}\r\n                    onError={this.onVideoError}\r\n                    className={cn.VideoImage}\r\n                    src={this.getVideoSrc()}\r\n                    id='droneImage'\r\n                    onClick={this.props.pointVideoImage}\r\n                //onTouchStart={this.props.pointVideoImage}\r\n                />\r\n                {this.renderVideoFooter()}\r\n            </>\r\n        )\r\n    }\r\n\r\n    render() {\r\n        const fullHeightClass = this.state.isImageLoadingError || this.state.isImageLoading ? cn.FullHeight : '';\r\n        return (\r\n            <div className={`${cn.Wrapper} ${fullHeightClass}`} id='videoWrapper'>\r\n                {this.renderImgElement()}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        isPaused: state.video.isPaused,\r\n        weaponDetected: state.output.weaponDetected,\r\n    };\r\n};\r\n\r\nconst mapDispachToProps = (dispatch) => {\r\n    return {\r\n        pointVideoImage: e => dispatch(actions.pointVideoImage(e)),\r\n        setExposure: exposureValue => dispatch(actions.setExposure(exposureValue)),\r\n        pause: () => dispatch({ type: actionTypes.PAUSE_VIDEO }),\r\n        resume: () => dispatch({ type: actionTypes.RESUME_VIDEO }),\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispachToProps)(Video);\r\n\r\n\r\n","export default __webpack_public_path__ + \"static/media/EnemySpotted.efd0437a.mp3\";","export default __webpack_public_path__ + \"static/media/WeaponDetection.758e844f.png\";","export default __webpack_public_path__ + \"static/media/armedRed.8b5ec0b4.svg\";","import React, { Component } from 'react'\r\nimport cn from './OutputTabs.module.css'\r\nimport WeaponDetection from '../../assets/images/WeaponDetection.png';\r\nimport externalConfig from '../../ExternalConfigurationHandler';\r\nimport actions from '../../store/actions';\r\nimport config, { devVideoSnapshotUrl, devVideoStreamUrl } from '../../config';\r\nimport { connect } from 'react-redux';\r\nimport EnemySpottedSound from '../../assets/EnemySpotted.mp3';\r\nimport ArmedRed from '../../assets/images/armedRed.svg';\r\n\r\n\r\nclass OutputTabs extends Component {\r\n\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            pointPosition: null,\r\n            showCapture: true,\r\n            selectedTab: \"WindowDetection\"\r\n        }\r\n        this.EnemySpotted = new Audio(EnemySpottedSound);\r\n\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        window.removeEventListener('resize', this.onImageLoaded())\r\n    }\r\n\r\n      onImageLoaded = (e) => {\r\n        if (!this.props.imageSentToDroneData || !this.props.imageSentToDroneData.point) {\r\n            console.log(\"Error, this.props.imageSentToDroneData.point as it is undefined\");\r\n            return;\r\n        }\r\n\r\n        const tabsWrapper = document.getElementById('tabs-wrapper');\r\n\r\n        const img = e.target;\r\n        const xFactor = img.naturalWidth / tabsWrapper.getBoundingClientRect().width;\r\n        const yFactor = img.naturalHeight / tabsWrapper.getBoundingClientRect().height;\r\n        const { roundedX, roundedY } = this.props.imageSentToDroneData.point;\r\n        this.setState({\r\n            pointPosition: {\r\n                top: roundedY / yFactor,\r\n                left: roundedX / xFactor,\r\n            }\r\n        })\r\n\r\n    }\r\n\r\n    componentDidUpdate(prevProps) {\r\n        if (prevProps.imageSentToDroneData !== this.props.imageSentToDroneData) {\r\n            const img = document.createElement('img');\r\n            img.onload = this.onImageLoaded;\r\n            img.src = this.props.imageSentToDroneData.image;\r\n            window.addEventListener('resize', () => this.onImageLoaded({target: img}))\r\n        }\r\n\r\n        if (prevProps.weaponDetected !== this.props.weaponDetected) {\r\n            this.EnemySpotted.play();\r\n            this.onToggleTabClick(\"Skeleton\");\r\n        }\r\n\r\n        if ((prevProps.skeletonRange === 'N/A' && this.props.skeletonRange !== 'N/A') || \r\n            (!prevProps.indoorExplorationFlag && this.props.indoorExplorationFlag)) {\r\n            this.onToggleTabClick(\"Skeleton\");\r\n        }\r\n    }\r\n\r\n    renderTabs() {\r\n\r\n        let imageElement = null;\r\n        let pointElement = null;\r\n\r\n        const imageDataUrl = this.props.imageSentToDroneData && this.props.imageSentToDroneData.image;\r\n        const point = this.props.imageSentToDroneData && this.props.imageSentToDroneData.point;\r\n        if (imageDataUrl && point) {\r\n            imageElement = <img className={cn.OutputImage} src={imageDataUrl} />\r\n            pointElement = <div className={cn.Point} style={this.state.pointPosition}></div>\r\n        }\r\n        return (<>\r\n            { imageElement}\r\n            { pointElement}\r\n        </>\r\n        );\r\n    }\r\n\r\n    renderNoOutputReceived() {\r\n        return <div className={cn.ErrorMessage}><span className={cn.ErrorIcon}></span> No output has been received yet</div>\r\n    }\r\n\r\n    onToggleTabClick = (selectedTab) => {\r\n              this.setState({ selectedTab });\r\n    }\r\n\r\n    renderTabsToggle = () => {\r\n        const selectedTab = this.state.selectedTab;\r\n        return (<>\r\n\r\n            <div className={cn.tabslidernav} >\r\n                <ul className={cn.tabslidertabs} >\r\n                    <li className={`${cn.tabslidertrigger} ${ selectedTab == \"Capture\" ? cn.TabSelected : \"\"}`}\r\n                        onClick={() => this.onToggleTabClick(\"Capture\")}>\r\n                        Capture\r\n                    </li>\r\n                    <li className={`${cn.tabslidertrigger} ${selectedTab == \"Skeleton\"  ? cn.TabSelected : \"\"}`}\r\n                        onClick={() => this.onToggleTabClick(\"Skeleton\")}>\r\n                        Skeleton\r\n                    </li>\r\n                    <li className={`${cn.tabslidertrigger} ${selectedTab == \"WindowDetection\"  ? cn.TabSelected : \"\"}`}\r\n                        onClick={() => this.onToggleTabClick(\"WindowDetection\")}>\r\n                        Window\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n\r\n        </>)\r\n\r\n    }\r\n\r\n    getCaptureTab() {\r\n        return this.props.imageSentToDroneData ? this.renderTabs() : this.renderNoOutputReceived();\r\n    }\r\n\r\n    getSkeletonRange() {\r\n        if (this.props.skeletonRange && this.props.skeletonRange !== 'N/A') {\r\n            return `${this.props.skeletonRange} m`;\r\n        }\r\n        return this.props.skeletonRange;\r\n    }\r\n\r\n    getSkeletonTab() {\r\n        let weaponDetectedClass = this.props.weaponDetected ?  cn.WeaponDetected : undefined;\r\n        return (<div className={`${cn.SkeletonTab} ${weaponDetectedClass}`} >\r\n            <img\r\n                crossOrigin=\"anonymous\"\r\n                //    onLoad={this.onVideoLoaded}\r\n                //   onError={this.onVideoError}\r\n                className={cn.VideoImage}\r\n                src={this.getSkeletonVideoSrc()}\r\n                id='droneImage'\r\n            //    onClick={this.props.pointVideoImage}\r\n            />\r\n            {this.props.weaponDetected &&  <img  className={`${cn.AlertIcon}`} src={ArmedRed} />}\r\n            { this.props.skeletonRange && <span className={`${cn.SkeletonRange}`} > {this.getSkeletonRange()} </span>}\r\n        </div>)\r\n    }\r\n\r\n    getWindowDetectionTab() {\r\n        return (<div className={`${cn.WindowTab}`} >\r\n            <img\r\n                crossOrigin=\"anonymous\"\r\n                //    onLoad={this.onVideoLoaded}\r\n                //   onError={this.onVideoError}\r\n                className={cn.VideoImage}\r\n                src={this.getWindowDetectionVideoSrc()}\r\n                id='droneImage'\r\n            //    onClick={this.props.pointVideoImage}\r\n            />\r\n            <span className={`${cn.AlertIcon}`} />            \r\n        </div>)\r\n    }\r\n\r\n    getWindowDetectionVideoSrc() {\r\n        const { BE_PORT, BE_IP } = externalConfig.getConfiguration();\r\n\r\n        const snapshotUrl = `//${BE_IP}:${BE_PORT}${config.urls.windowDetectionSnapshot}`;\r\n        const streamUrl = `//${BE_IP}:${BE_PORT}${config.urls.windowDetectionStream}`;\r\n\r\n        if (this.props.isPaused) {\r\n            return process.env.NODE_ENV === 'developments' ? devVideoSnapshotUrl : snapshotUrl;\r\n        } else {\r\n            return process.env.NODE_ENV === 'developments' ? devVideoStreamUrl : streamUrl;\r\n        }\r\n    }\r\n    getSkeletonVideoSrc() {\r\n        const { BE_PORT, BE_IP } = externalConfig.getConfiguration();\r\n\r\n        const snapshotUrl = `//${BE_IP}:${BE_PORT}${config.urls.skeletonSnapshot}`;\r\n        const streamUrl = `//${BE_IP}:${BE_PORT}${config.urls.skeletonStream}`;\r\n\r\n        if (this.props.isPaused) {\r\n            return process.env.NODE_ENV === 'developments' ? devVideoSnapshotUrl : snapshotUrl;\r\n        } else {\r\n            return process.env.NODE_ENV === 'developments' ? devVideoStreamUrl : streamUrl;\r\n        }\r\n    }\r\n    getSelectedTab() {\r\n        switch (this.state.selectedTab) {\r\n            case \"Capture\":\r\n                return this.getCaptureTab();\r\n            case \"Skeleton\":\r\n                return this.getSkeletonTab();\r\n            case \"WindowDetection\":\r\n                return this.getWindowDetectionTab();\r\n            default:\r\n                return \"\";\r\n        }\r\n    }\r\n\r\n    render() {\r\n\r\n        return (\r\n            <div className={cn.Wrapper}>\r\n                {this.renderTabsToggle()}\r\n                <div className={cn.Tabs} id='tabs-wrapper'>\r\n                    {this.getSelectedTab()}\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        tabs: state.video.tabs,\r\n        imageSentToDroneData: state.layout.imageSentToDroneData,\r\n        skeletonRange: state.output.skeletonRange,\r\n        weaponDetected :  state.output.weaponDetected,\r\n        indoorExplorationFlag: state.output.indoorExplorationFlag\r\n    };\r\n};\r\n\r\nconst mapDispachToProps = (dispatch) => {\r\n    return {\r\n      \r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispachToProps)(OutputTabs);","import React, { Component } from 'react'\r\nimport cn from './ActionButtons.module.css'\r\nimport { connect } from 'react-redux';\r\nimport actions from '../../store/actions';\r\nimport actionTypes from '../../store/actions/actionTypes';\r\n\r\nclass ActionButtons extends Component {\r\n\r\n    getPauseIcon() {\r\n        return this.props.isPaused ? cn.PlayIcon : cn.PauseIcon        \r\n    }\r\n\r\n    goToLocation = () => {\r\n        const popupDetails = {\r\n            title: 'Go To Location',            \r\n            modalChild: 'SingleInputForm',            \r\n            modalChildProps: {\r\n                size: 'small',\r\n                label: \"Set Location:\",\r\n                placeHolder: \"x,y,z\",\r\n                onValueChange: value => this.tempLocationValue = value\r\n            },\r\n            onCloseButtonClick: () => {\r\n                this.tempLocationValue = null\r\n            },\r\n            primayButton: {\r\n                title: 'Go',\r\n                callback: this.onGoToLocationPopupOkBtnClick\r\n            },\r\n            secondaryButton: {\r\n                title: 'Cancel',\r\n                callback: () => {\r\n                    this.tempLocationValue = null\r\n                }\r\n            }\r\n        };\r\n        this.props.showPopup(popupDetails);\r\n    }\r\n\r\n    onGoToLocationPopupOkBtnClick = () => {\r\n        if (this.tempLocationValue) {\r\n            this.props.goToLocation(this.tempLocationValue);\r\n        } else {\r\n            this.tempLocationValue = null;\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const isHiddenClass = this.props.isRosWebsocketConncted ? '' : cn.Hidden;\r\n        return (\r\n            <div className={`${cn.Wrapper} ${isHiddenClass}`}>\r\n                    <button className={cn.Button} onClick={this.props.takeoff}>\r\n                        <span className={`${cn.Icon} ${cn.TakeoffIcon}`}></span>\r\n                        <span className={cn.ButtonLabel}>Takeoff</span>\r\n                    </button>\r\n                    <button className={`${cn.Button} ${this.props.indoorExplorationFlag ? cn.Clicked : ''}`} onClick={this.props.startIndoorExploration}>\r\n                        <span className={`${cn.Icon} ${cn.IndoorExploration}`}></span>\r\n                        <span className={cn.ButtonLabel}>{'Indoor \\nExploration'}</span>\r\n                    </button>\r\n                    <button className={cn.Button } onClick={this.props.locate}>\r\n                        <span className={`${cn.Icon} ${cn.LocateIcon}`}></span>\r\n                        <span className={cn.ButtonLabel}>Locate</span>\r\n                    </button>\r\n                    <button className={cn.Button} onClick={this.goToLocation}>\r\n                        <span className={`${cn.Icon} ${cn.SetLocationIcon}`}></span>\r\n                        <span className={cn.ButtonLabel}>Go To</span>\r\n                    </button>\r\n                    <button className={cn.Button} onClick={this.props.reset}>\r\n                        <span className={`${cn.Icon} ${cn.ResetIcon}`}></span>\r\n                        <span className={cn.ButtonLabel}>Reset</span>\r\n                    </button>\r\n                    {\r\n                        this.props.savedMissionPlan.length ? \r\n                            (<button className={cn.Button} onClick={this.props.runSavedMissionPlan}>\r\n                                <span className={`${cn.Icon} ${cn.RunPlanIcon}`}></span>\r\n                                <span className={cn.ButtonLabel}>Run Saved Plan</span>\r\n                            </button>) : null\r\n                    }\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        isPaused: state.video.isPaused,\r\n        isRosWebsocketConncted: state.layout.isRosWebsocketConncted,\r\n        indoorExplorationFlag: state.output.indoorExplorationFlag,\r\n        savedMissionPlan: state.planner.savedMissionPlan,\r\n    }\r\n};\r\n\r\nconst mapDispachToProps = dispatch => {\r\n    return {\r\n        takeoff: () => dispatch(actions.takeoff()),\r\n        startIndoorExploration: () => dispatch(actions.startIndoorExploration()),\r\n        locate: () => dispatch(actions.locate()),\r\n        restart: () => dispatch(actions.restart()),\r\n        showPopup: details => dispatch({ type: actionTypes.SHOW_POPUP, payload: details }),\r\n        goToLocation: location => dispatch(actions.goToLocation(location)),\r\n        runSavedMissionPlan: () => dispatch(actions.runSavedMissionPlan()),\r\n    }\r\n}\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispachToProps\r\n)(ActionButtons)","import React, { Component } from 'react'\r\nimport classNames from './Main.module.css';\r\nimport FlightTelemetry from '../FlightTelemetry/FlightTelemetry';\r\nimport MapContainer from '../MapContainer/MapContainer';\r\nimport Video from '../Video/Video';\r\nimport OutputTabs from '../OutputTabs/OutputTabs';\r\nimport ActionButtons from '../ActionButtons/ActionButtons';\r\n\r\nexport default class Main extends Component {\r\n\r\n    getMainLeftPane() {\r\n        return <MapContainer />;\r\n    }\r\n\r\n    getMainRightPane() {\r\n        return (\r\n            <div className={classNames.RightPaneWrapper}>\r\n                <div className={classNames.RightPaneWrapperItem}>\r\n                    <Video />\r\n                </div>\r\n                <div className={classNames.RightPaneWrapperItem}>\r\n                    <OutputTabs />\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    getActionButtons() {\r\n        return <ActionButtons/>        \r\n    }\r\n\r\n\r\n    render() {\r\n\r\n        //const hiddenClass = !this.props.isMissionPlanScreenHidden ? ` ${classNames.Hidden}` : '';\r\n\r\n        return (\r\n            <div className={`${classNames.MainContentWrapper}`}>\r\n                <div className={`${classNames.Split} ${classNames.Left}`}>\r\n                    {this.getMainLeftPane()}\r\n                </div>\r\n                <div className={`${classNames.Split} ${classNames.Right}`}>\r\n                    {this.getMainRightPane()}\r\n                </div>\r\n                {this.getActionButtons()}\r\n                <FlightTelemetry/>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n","import React, { Component } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport cn from './MissionPlanStages.module.css';\r\nimport actionTypes from '../../../store/actions/actionTypes';\r\n\r\nclass MissionPlanStage extends Component {\r\n\r\n    renderMenuBtnIcon() {\r\n        return (\r\n            <span className={cn.BtnIconWrapper}>\r\n                <span className={cn.BtnIconBall}></span>\r\n                <span className={cn.BtnIconBall}></span>\r\n                <span className={cn.BtnIconBall}></span>\r\n            </span>\r\n        )\r\n    }\r\n\r\n    addOrEditMissionPlanStageFormPopupOkBtnClick = (isAddStage) => {\r\n        const addOrEditStageFormState = this.getAddMissionPlanStageFormState();\r\n        if (addOrEditStageFormState.selectedStageType) {\r\n            if (isAddStage) {\r\n                this.props.addNewStage(addOrEditStageFormState);\r\n            } else {\r\n                this.props.editStage(addOrEditStageFormState, this.props.stageIndex);\r\n            }\r\n        }\r\n    }\r\n\r\n    selectPointFromMap = () => {\r\n        this.props.togglePointSelectionMode();\r\n    }\r\n\r\n    onAddOrEditStageBtnClicked = (isAddStage = false) => {\r\n        const popupDetails = {\r\n            title: isAddStage ? 'Add New Stage' : `Edit Stage #${this.props.stageIndex + 1} `,\r\n            modalChild: 'AddMissionPlanStageForm',\r\n            modalChildProps: {\r\n                stage: isAddStage ? null : this.props.stage,\r\n                size: 'small',\r\n                onPopupInitalLoad: getChildState => this.getAddMissionPlanStageFormState = getChildState,\r\n                selectPointFromMap: this.selectPointFromMap,\r\n\r\n            },\r\n            onCloseButtonClick: () => { },\r\n            primayButton: {\r\n                title: 'Done',\r\n                callback: () => this.addOrEditMissionPlanStageFormPopupOkBtnClick(isAddStage)\r\n            },\r\n            secondaryButton: {\r\n                title: 'Cancel',\r\n                callback: () => { }\r\n            }\r\n        };\r\n        this.props.showPopup(popupDetails);\r\n    }\r\n\r\n    onMenuBtnClick = e => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n\r\n        const menuItemsList = [\r\n            {\r\n                name: \"Delete\",\r\n                func: () => this.props.deleteStage(this.props.stage.stageId),\r\n                iconCss: \"DeleteIcon\"\r\n            },\r\n            {\r\n                name: \"Edit\",\r\n                func: this.onAddOrEditStageBtnClicked,\r\n                iconCss: \"EditIcon\"\r\n            },\r\n            {\r\n                name: \"Move Back\",\r\n                func: () => this.props.moveStageDown(this.props.stageIndex),\r\n                iconCss: \"ArrowDownIcon\"\r\n            },\r\n            {\r\n                name: \"Move Forward\",\r\n                func: () => this.props.moveStageUp(this.props.stageIndex),\r\n                iconCss: \"ArrowUpIcon\"\r\n            },\r\n        ];\r\n\r\n        this.props.showContextMenu(e.clientX, e.clientY, { side: 'left' }, menuItemsList);\r\n    }\r\n\r\n    renderAddNewStageBtn() {\r\n        if (this.props.isShowAddStageBtn) {\r\n            return <button className={cn.AddNewStageBtn} onClick={() => this.onAddOrEditStageBtnClicked(true)}>+</button>\r\n        }\r\n        return false;\r\n    }\r\n\r\n    renderMenuBtn() {\r\n        const { isShowMenu } = this.props;\r\n        if (!isShowMenu) return null;\r\n        return (\r\n            <button className={cn.MenuBtn} onClick={this.onMenuBtnClick}>{this.renderMenuBtnIcon()}</button>\r\n        )\r\n    }\r\n\r\n    render() {\r\n        const { selectedStageType, stageParamsInput } = this.props.stage;\r\n        let params = stageParamsInput;\r\n        if (selectedStageType.label == \"Go To Waypoint\") {\r\n            const [x, y, z] = stageParamsInput.split(',');\r\n            params = `x: ${x.split(\".\")[0]}\\ny: ${y.split(\".\")[0]}\\nz: ${z.split(\".\")[0]}`\r\n        }\r\n        return (\r\n            <div className={cn.StageWrapper}>\r\n                {this.renderMenuBtn()}\r\n                <div className={cn.LabelsWrapper}>\r\n                    <div className={cn.StageTypeLabel}>{selectedStageType.label}</div>\r\n                    <div className={cn.StageParamsLabel}>{params}</div>\r\n                </div>\r\n                {this.renderAddNewStageBtn()}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n\r\n})\r\n\r\nconst mapDispachToProps = (dispatch) => {\r\n    return {\r\n        showPopup: details => dispatch({ type: actionTypes.SHOW_POPUP, payload: details }),\r\n        togglePointSelectionMode: () => dispatch({ type: actionTypes.TOGGLE_POINT_SELECTION_MODE }),\r\n        showContextMenu: (x, y, options, items) => dispatch({ type: actionTypes.SHOW_CONTEXT_MENU, payload: { x, y, options, items } }),\r\n        deleteStage: id => dispatch({ type: actionTypes.DELETE_MISSION_PLAN_STAGE, payload: { id } }),\r\n        editStage: (stage, index) => dispatch({ type: actionTypes.EDIT_MISSION_PLAN_STAGE, payload: { stage, stageIndex: index } }),\r\n        moveStageDown: (index) => dispatch({ type: actionTypes.MOVE_DOWN_MISSION_PLAN_STAGE, payload: index }),\r\n        moveStageUp: (index) => dispatch({ type: actionTypes.MOVE_UP_MISSION_PLAN_STAGE, payload: index }),\r\n        addNewStage: stage => dispatch({ type: actionTypes.ADD_NEW_MISSION_PLAN_STAGE, payload: stage }),\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispachToProps)(MissionPlanStage)\r\n","import React, { Component } from 'react'\r\nimport Stage from './MissionPlanStage';\r\nimport cn from './MissionPlanStages.module.css';\r\n\r\nexport default class MissionPlanStages extends Component {\r\n\r\n    renderArrow() {\r\n        return (\r\n            <div className={cn.Arrow}></div>\r\n        )\r\n    }\r\n\r\n    render() {\r\n        const {missionStages} = this.props;\r\n        const {isReadOnly} = this.props;\r\n\r\n        return (\r\n            <div className={cn.MissionStagesWrapper}>\r\n                {\r\n                    missionStages.map((stage,i) => \r\n                                        <React.Fragment key={stage.stageId}>\r\n                                            <Stage\r\n                                                stageIndex={i}\r\n                                                stage={stage} \r\n                                                isShowAddStageBtn={!isReadOnly &&  i === missionStages.length - 1}\r\n                                                isShowMenu={!isReadOnly}\r\n                                            />\r\n                                            {i !== missionStages.length - 1 ? this.renderArrow() : null}\r\n                                        </React.Fragment>\r\n                                        \r\n                    )\r\n                }                \r\n            </div>\r\n        )\r\n    }\r\n}\r\n","import actionTypes from '../actions/actionTypes';\r\n\r\nexport const viewerStates = {\r\n    draft: 'draft',\r\n    savedMission: 'savedMission'\r\n}\r\n\r\nconst initialState = {    \r\n    draftMissionStages: [],\r\n    savedMissionPlan: [],\r\n    viewerState: viewerStates.draft,\r\n\r\n};\r\n\r\nfunction immutablySwapItems(items, firstIndex, secondIndex) {\r\n    return items.map(function(element, index) {\r\n        if (index === firstIndex) return items[secondIndex];\r\n        else if (index === secondIndex) return items[firstIndex];\r\n        else return element;\r\n    })\r\n}\r\n\r\nconst plannerReducer = (state = initialState, action) => {\r\n    switch (action.type) {\r\n        case actionTypes.ADD_NEW_MISSION_PLAN_STAGE:\r\n            return {\r\n                ...state,\r\n                draftMissionStages: [...state.draftMissionStages, action.payload]\r\n            }\r\n        case actionTypes.DELETE_MISSION_PLAN_STAGE:\r\n            return {\r\n                ...state,\r\n                draftMissionStages: state.draftMissionStages.filter(stage => stage.stageId !== action.payload.id)\r\n            }\r\n        case actionTypes.EDIT_MISSION_PLAN_STAGE: {\r\n            return {\r\n                ...state,\r\n                draftMissionStages: [\r\n                    ...state.draftMissionStages.slice(0, action.payload.stageIndex),\r\n                    action.payload.stage,\r\n                    ...state.draftMissionStages.slice(action.payload.stageIndex + 1),\r\n                ]\r\n            }\r\n        }\r\n        case actionTypes.MOVE_DOWN_MISSION_PLAN_STAGE: {\r\n            const currentStageIndex = action.payload;\r\n\r\n            if (currentStageIndex === 0) return state;\r\n            // swapping the elements in immutable way:\r\n            return {\r\n                ...state,\r\n                draftMissionStages: immutablySwapItems(state.draftMissionStages, currentStageIndex, currentStageIndex - 1)\r\n\r\n            }            \r\n        }\r\n        case actionTypes.MOVE_UP_MISSION_PLAN_STAGE: {\r\n            const currentStageIndex = action.payload;\r\n\r\n            if (state.draftMissionStages.length === 0 ||\r\n                currentStageIndex === state.draftMissionStages.length - 1) return state;\r\n            // swapping the elements in immutable way:\r\n            return {\r\n                ...state,\r\n                draftMissionStages: immutablySwapItems(state.draftMissionStages, currentStageIndex, currentStageIndex + 1)\r\n            }            \r\n        }\r\n        case actionTypes.SAVE_MISSION_PLAN: {\r\n            // deep array clone\r\n            const savedMissionPlan = JSON.parse(JSON.stringify(state.draftMissionStages)); \r\n\r\n            return {\r\n                ...state,\r\n                savedMissionPlan\r\n            }            \r\n        }\r\n        case actionTypes.REMOVE_DRAFT_MISSION_PLAN: {\r\n            return {\r\n                ...state,\r\n                draftMissionStages: []\r\n            }            \r\n        }\r\n        case actionTypes.REMOVE_SAVED_MISSION_PLAN: {\r\n            return {\r\n                ...state,\r\n                savedMissionPlan: []\r\n            }            \r\n        }\r\n        case actionTypes.TOGGLE_MISSION_PLAN_VIEWER_STATE: {            \r\n            return {\r\n                ...state,\r\n                viewerState: state.viewerState === viewerStates.draft ? viewerStates.savedMission : viewerStates.draft\r\n            }            \r\n        }\r\n        case actionTypes.LOAD_DEFAULT_PLAN: {\r\n            debugger;\r\n            if (state.viewerState === viewerStates.savedMission) {\r\n                return {\r\n                    ...state,\r\n                    savedMissionPlan: action.payload                \r\n                }   \r\n            } else {\r\n                return {\r\n                    ...state,\r\n                    draftMissionStages: action.payload                \r\n                }   \r\n            }\r\n         \r\n        }\r\n\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default plannerReducer;","import React, { Component } from 'react'\r\nimport cn from './MissionPlanner.module.css';\r\nimport { connect } from 'react-redux';\r\nimport actionTypes from '../../store/actions/actionTypes';\r\nimport actions from '../../store/actions';\r\nimport MissionPlanStages from './MissionPlanStages/MissionPlanStages';\r\nimport { withRouter } from 'react-router-dom';\r\nimport { logSeverities } from '../../config';\r\nimport { viewerStates } from '../../store/reducers/plannerReducer';\r\n\r\nclass MissionPlanner extends Component {\r\n\r\n    inputRef = React.createRef();\r\n\r\n    addMissionPlanStageFormPopupOkBtnClick = () => {\r\n        const addStageState = this.getAddMissionPlanStageFormState();\r\n        if (addStageState && addStageState.selectedStageType) {\r\n            this.props.addNewStage(addStageState)\r\n        }\r\n    }\r\n\r\n    onStartNewMissionClick = () => {\r\n        const popupDetails = {\r\n            title: 'Add First Stage',\r\n            modalChild: 'AddMissionPlanStageForm',\r\n            modalChildProps: {\r\n                size: 'small',\r\n                onPopupInitalLoad: getChildState => this.getAddMissionPlanStageFormState = getChildState,\r\n                selectPointFromMap: this.selectPointFromMap,\r\n            },\r\n            onCloseButtonClick: () => {\r\n            },\r\n            primayButton: {\r\n                title: 'Add',\r\n                disabled: false,\r\n                callback: this.addMissionPlanStageFormPopupOkBtnClick\r\n            },\r\n            secondaryButton: {\r\n                title: 'Cancel',\r\n                callback: () => { }\r\n            }\r\n        };\r\n        this.props.showPopup(popupDetails);\r\n    }\r\n\r\n    renderStartNewMissionButton() {\r\n        return (\r\n            <button className={cn.StartNewBtn} onClick={this.onStartNewMissionClick}>Start New Mission Plan</button>\r\n        )\r\n    }\r\n\r\n\r\n    renderMissionPlanStages() {\r\n\r\n\r\n        const { viewerState, draftMissionStages, savedMissionPlan } = this.props;\r\n        if (viewerState === viewerStates.draft) {\r\n            return (\r\n                draftMissionStages.length ?\r\n                    <MissionPlanStages\r\n                        missionStages={viewerState === viewerStates.draft ? draftMissionStages : savedMissionPlan}\r\n                        isReadOnly={viewerState === viewerStates.savedMission}\r\n                    /> :\r\n                    this.renderStartNewMissionButton()\r\n            )\r\n        } else {\r\n            // saved mission plan flow\r\n            return (\r\n                savedMissionPlan.length > 0 ?\r\n                    <MissionPlanStages\r\n                        missionStages={viewerState === viewerStates.draft ? draftMissionStages : savedMissionPlan}\r\n                        isReadOnly={viewerState === viewerStates.savedMission}\r\n                    /> :\r\n                    <div className={cn.EmptyPlanStagesMessage}>\r\n                        No Saved Plan in Memory\r\n                </div>\r\n            )\r\n        }\r\n    }\r\n\r\n    selectPointFromMap = () => {\r\n        this.props.togglePointSelectionMode();\r\n    }\r\n\r\n    onBackBtnClick = () => {\r\n        this.props.hideMissionPlannerScreen();\r\n    }\r\n\r\n    onSaveBtnClick = () => {\r\n        this.props.saveMissionPlan();\r\n        this.props.showGlobalMessage('Draft Successfuly Saved');\r\n    }\r\n\r\n    onClearDraftBtnClick = () => {\r\n        this.props.removeDraftPlan();\r\n    }\r\n\r\n    onRemoveSavedPlanBtnClick = () => {\r\n        this.props.removeSavedPlan();\r\n        this.props.showGlobalMessage('Mission Plan Successfuly Removed');\r\n    }\r\n\r\n    onLoadMissionFromDroneBtnClick = () => {\r\n        this.props.importMissionFromDroneFile();\r\n    }\r\n\r\n    onLoadMissionFromPcBtnClick = () => {\r\n        this.inputRef.current.click();\r\n\r\n    }\r\n\r\n    parseConfigurationFile = (e) => {\r\n        const fileReader = new FileReader();\r\n        if (e.target.files && e.target.files[0]) {\r\n            console.log(\"Reading file: \" + e.target.files[0]);\r\n            fileReader.readAsText(e.target.files[0], \"UTF-8\");\r\n            fileReader.onload = e => {\r\n                const missionData = JSON.parse(e.target.result);\r\n                this.props.importMissionFromPcFile(missionData);\r\n            };\r\n            fileReader.onerror = e => {\r\n                console.log(\"parseConfigurationFile: error reading file\");\r\n            };\r\n        }\r\n    }\r\n\r\n\r\n    onExportMissionBtnClick = () => {\r\n        const { draftMissionStages, savedMissionPlan, viewerState } = this.props;\r\n        const plan = viewerState === viewerStates.draft ? draftMissionStages : savedMissionPlan;\r\n        this.props.exportPlanToFile(plan, viewerState);\r\n    }\r\n\r\n\r\n    onMenuBtnClick = e => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n\r\n        const menuItemsList = [\r\n            {\r\n                name: \"Load From PC\",\r\n                func: this.onLoadMissionFromPcBtnClick,\r\n                iconCss: \"PcIcon\"\r\n            },\r\n            {\r\n                name: \"Load From Drone\",\r\n                func: this.onLoadMissionFromDroneBtnClick,\r\n                iconCss: \"DroneIcon\"\r\n            },\r\n        ];\r\n\r\n        this.props.showContextMenu(e.clientX, e.clientY, { side: 'left' }, menuItemsList);\r\n    }\r\n\r\n\r\n    renderDraftButtons(draftMissionStages) {\r\n        const buttons = [];\r\n\r\n        if (draftMissionStages.length > 0) {\r\n            buttons.push(<button title='Save Plan' className={`${cn.SideBarBtn} ${cn.Save}`} onClick={this.onSaveBtnClick} />)\r\n            buttons.push(<button title='Clear Draft Stages' className={`${cn.SideBarBtn} ${cn.ClearStages}`} onClick={this.onClearDraftBtnClick} />)\r\n            buttons.push(<button title='Download Draft' className={`${cn.SideBarBtn} ${cn.Export}`} onClick={this.onExportMissionBtnClick} />)\r\n        }\r\n        buttons.push(<button title='Load Mission Plan' className={`${cn.SideBarBtn} ${cn.Import}`} onClick={e => this.onMenuBtnClick(e)} />)\r\n\r\n        return buttons;\r\n    }\r\n\r\n    renderSavedPlanButtons(savedMissionPlan) {\r\n        const buttons = [];\r\n\r\n        if (savedMissionPlan.length > 0) {\r\n            buttons.push(<button title='Remove Saved Plan' className={`${cn.SideBarBtn} ${cn.Remove}`} onClick={this.onRemoveSavedPlanBtnClick} />)\r\n            buttons.push(<button title='Download Saved Plan' className={`${cn.SideBarBtn} ${cn.Export}`} onClick={this.onExportMissionBtnClick} />)\r\n        }\r\n        buttons.push(<button title='Load Mission Plan From File' className={`${cn.SideBarBtn} ${cn.Import}`} onClick={this.onLoadMissionBtnClick} />)\r\n\r\n        return buttons;\r\n    }\r\n\r\n\r\n    renderSideBar() {\r\n        const { draftMissionStages, savedMissionPlan, viewerState } = this.props;\r\n        let buttons = [<button title='Back to Main' className={`${cn.SideBarBtn} ${cn.ClosePlanner}`} onClick={this.onBackBtnClick} />];\r\n        ;\r\n        if (viewerState === viewerStates.draft) {\r\n            buttons.push(...this.renderDraftButtons(draftMissionStages));\r\n        } else {\r\n            buttons.push(...this.renderSavedPlanButtons(savedMissionPlan));\r\n        }\r\n\r\n        return (\r\n            <div className={cn.SideBar}>\r\n                <div className={cn.SideBarButtons}>\r\n                    {buttons}\r\n                </div>\r\n                <span className={cn.SidebarLabel}>Mission Planner</span>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    onSwitchViewStateClick = e => {\r\n        e.preventDefault();\r\n        this.props.toggleViewerState();\r\n    }\r\n\r\n    getSwithBtnTitle(viewerState) {\r\n        return `View ${viewerState === viewerStates.draft ? 'Saved Mission' : 'Draft Mission'}`;\r\n    }\r\n\r\n    renderHeader() {\r\n        const { viewerState } = this.props;\r\n        const icon = viewerState === viewerStates.draft ? ` ${cn.DraftIcon}` : ` ${cn.SavedPlanIcon}`\r\n        return (\r\n            <div className={cn.Header}>\r\n                <span></span>\r\n                <span className={cn.HeaderTextWrapper}>\r\n                    <span className={cn.HeaderTextState}>{viewerState === viewerStates.draft ? 'Mission Draft' : 'Saved Mission'}</span>\r\n                    <a href={'#'} className={cn.HeaderBtnWrapper} onClick={this.onSwitchViewStateClick} title={this.getSwithBtnTitle(viewerState)}>\r\n                        <span className={cn.HeaderBtn}></span>\r\n                    </a>\r\n                </span>\r\n            </div>\r\n        )\r\n    }\r\n\r\n\r\n    render() {\r\n        const centerClass = !this.props.draftMissionStages.length ? cn.Center : '';\r\n        return (\r\n            <>\r\n                {this.renderSideBar()}\r\n                <div className={`${cn.Wrapper} ${centerClass}`}>\r\n                    {this.renderHeader()}\r\n                    {this.renderMissionPlanStages()}\r\n                </div>\r\n                <input type=\"file\" style={{ display: 'none' }} accept={\"application/json\"} ref={this.inputRef} onChange={(e) => this.parseConfigurationFile(e)} />\r\n            </>)\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        draftMissionStages: state.planner.draftMissionStages,\r\n        savedMissionPlan: state.planner.savedMissionPlan,\r\n        viewerState: state.planner.viewerState\r\n    }\r\n};\r\n\r\nconst mapDispachToProps = dispatch => {\r\n    return {\r\n        showPopup: details => dispatch({ type: actionTypes.SHOW_POPUP, payload: details }),\r\n        showGlobalMessage: text => dispatch(actions.showGlobalMessage({ text, type: logSeverities.success, isRemoved: true })),\r\n        addNewStage: stage => dispatch({ type: actionTypes.ADD_NEW_MISSION_PLAN_STAGE, payload: stage }),\r\n        hideMissionPlannerScreen: () => dispatch({ type: actionTypes.HIDE_MISSION_PLANNER_SCREEN }),\r\n        saveMissionPlan: () => dispatch({ type: actionTypes.SAVE_MISSION_PLAN }),\r\n        removeDraftPlan: () => dispatch({ type: actionTypes.REMOVE_DRAFT_MISSION_PLAN }),\r\n        removeSavedPlan: () => dispatch({ type: actionTypes.REMOVE_SAVED_MISSION_PLAN }),\r\n        toggleViewerState: () => dispatch({ type: actionTypes.TOGGLE_MISSION_PLAN_VIEWER_STATE }),\r\n        importMissionFromDroneFile: () => dispatch(actions.importMissionFromDroneFile()),\r\n        importMissionFromPcFile: (missionData) => dispatch(actions.importMissionFromPcFile(missionData)),\r\n        exportPlanToFile: (plan, viewerState) => dispatch(actions.exportPlanToFile(plan, viewerState)),\r\n        togglePointSelectionMode: () => dispatch({ type: actionTypes.TOGGLE_POINT_SELECTION_MODE }),\r\n        showContextMenu: (x, y, options, items) => dispatch({ type: actionTypes.SHOW_CONTEXT_MENU, payload: { x, y, options, items } }),\r\n    }\r\n}\r\n\r\nexport default withRouter(connect(mapStateToProps, mapDispachToProps)(MissionPlanner));\r\n\r\n// export default connect(\r\n//     mapStateToProps,\r\n//     mapDispachToProps\r\n// )(MissionPlanner)\r\n","import React, { PureComponent, Component } from 'react';\r\nimport logo from '../src/assets/images/newLogo.svg';\r\nimport classNames from './App.module.css';\r\nimport Loader from './components/LoaderAlt/LoaderAlt';\r\nimport Clock from './components/Clock/Clock';\r\nimport Popup from './components/Popup/Popup';\r\nimport Error from './components/Error/Error';\r\nimport GlobalMessage from './components/GlobalMessage/GlobalMessage';\r\nimport actionTypes from './store/actions/actionTypes';\r\nimport { connect } from 'react-redux';\r\nimport ContextMenu from './components/ContextMenu/ContextMenu';\r\nimport externalConfig from './ExternalConfigurationHandler';\r\nimport { Switch, Route, withRouter } from 'react-router-dom';\r\nimport Main from './components/Main/Main';\r\nimport MissionPlanner from './components/MissionPlanner/MissionPlanner';\r\nimport * as geoCalculations from './utils/geoCalculations';\r\n\r\nclass App extends Component {\r\n\r\n    disableZoomInTouchScreen = e => {\r\n        if (e.touches.length > 1) {\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        window.MapCore.SetStartCallbackFunction(this.props.setMapCoreSDKLoadedFlag);\r\n\r\n        const defaultGroup = externalConfig.getConfiguration().streamingLayers[0];\r\n        this.props.setMapToShow(defaultGroup);\r\n\r\n        //Disable zoom in touch\r\n        window.addEventListener('touchstart', this.disableZoomInTouchScreen, { passive: false });\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        window.removeEventListener('touchstart', this.disableZoomInTouchScreen);\r\n    }\r\n\r\n    closeErrorPopup = () => {\r\n        this.setState({\r\n            generalErrorMessage: false,\r\n        });\r\n    };\r\n\r\n    getGeneralErrorPopup() {\r\n        if (false) {\r\n            return (\r\n                <Popup\r\n                    buttonOk='OK'\r\n                    header={''}\r\n                    hideXButton\r\n                    onOk={this.closeErrorPopup}>\r\n                    <Error errorMsg={''} />\r\n                </Popup>\r\n            );\r\n        }\r\n        return null;\r\n    }\r\n\r\n    getClock() {\r\n        return <Clock />;\r\n    }\r\n\r\n    formatPosition(value) {\r\n        if (value === null || value === undefined) return null;\r\n        return Math.round(value);\r\n    }\r\n\r\n    getMainHeader() {\r\n        const droneOffset = this.props.dronePositionOffset? geoCalculations.roundCoordinate(this.props.dronePositionOffset) : {} ;\r\n        return (\r\n            <header className={classNames.AppHeader}>\r\n                <div className={classNames.LogoWrapper} onClick={() => this.props.history.push('/')}>\r\n                    <img src={logo} alt='logo' />\r\n                    <span className={classNames.VersionText}>version: 21.05.26 </span>\r\n                </div>\r\n                <div className={classNames.HeaderLeftWrapper}>\r\n                <span className={classNames.HeaderItem}>\r\n                        <span className={`${classNames.Icon} ${classNames.DroneIcon}`}></span>\r\n                        <span className={classNames.LongLatWrapper}>\r\n                            <span className={classNames.MissionWrapper}>\r\n                                <span className={classNames.lonLatLabel}>IP:</span>\r\n                                <span className={classNames.lonLatValue}>{externalConfig.getConfiguration().BE_IP}</span>\r\n                            </span>\r\n                        </span>\r\n                    </span>\r\n                    <span className={classNames.HeaderItem}>\r\n                        <span className={classNames.LongLatWrapper}>\r\n                        <span className={classNames.MissionWrapper}>\r\n                                <span className={classNames.lonLatLabel}>Mission:</span>\r\n                            </span>\r\n                            <span className={classNames.MissionValueWrapper}>\r\n                                <span className={classNames.MissionValue}>{this.props.missionState}</span>\r\n                            </span>\r\n                        </span>\r\n                    </span>\r\n                    <span className={classNames.HeaderItem}>\r\n                        <span className={`${classNames.Icon} ${classNames.PositionIcon}`}></span>\r\n                        <span className={classNames.LongLatWrapper}>\r\n                            <span>\r\n                                <span className={classNames.lonLatLabel}>X:</span>\r\n                                <span className={classNames.lonLatValue}>{this.formatPosition(this.props.lastPosition.x) || \"N/A\"}</span>\r\n                            </span>\r\n                            <span>\r\n                                <span className={classNames.lonLatLabel}>Y:</span>\r\n                                <span className={classNames.lonLatValue}>{this.formatPosition(this.props.lastPosition.y) || \"N/A\"}</span>\r\n                            </span>\r\n                            <span>\r\n                                <span className={classNames.lonLatLabel}>Z:</span>\r\n                                <span className={classNames.lonLatValue}>{this.formatPosition(this.props.lastPosition.z) || \"N/A\"}</span>\r\n                            </span>\r\n                        </span>\r\n                    </span>\r\n                    <span className={classNames.HeaderItem}>\r\n                        <span className={`${classNames.Icon} ${classNames.CompassIcon}`}></span>\r\n                        <span className={classNames.LongLatWrapper}>\r\n                            <span>\r\n                                <span className={classNames.lonLatLabel}>X:</span>\r\n                                <span className={classNames.lonLatValue}>{droneOffset.x}</span>\r\n                            </span>\r\n                            <span>\r\n                                <span className={classNames.lonLatLabel}>Y:</span>\r\n                                <span className={classNames.lonLatValue}>{droneOffset.y}</span>\r\n                            </span>\r\n                            <span>\r\n                                <span className={classNames.lonLatLabel}>Z:</span>\r\n                                <span className={classNames.lonLatValue}>{droneOffset.z}</span>\r\n                            </span>\r\n                        </span>\r\n                    </span>\r\n                    <span className={classNames.HeaderItem}><span className={`${classNames.Icon} ${classNames.WifiIcon}`}></span></span>\r\n                    <span className={classNames.HeaderItem}>\r\n                        <span className={`${classNames.Icon} ${classNames.BatteryIcon}`}></span>\r\n                        <span className={classNames.BatteryValue}>59%</span>\r\n                    </span>\r\n                    <div className={classNames.HeaderItem}>{this.getClock()}</div>\r\n                    <button className={classNames.MenuBtn} onClick={this.onMoreActionsClick}>\r\n                        <span className={`${classNames.Icon} ${classNames.MenuIcon}`}></span>\r\n                    </button>\r\n                </div>\r\n            </header>\r\n        );\r\n    }\r\n\r\n    onMoreActionsClick = (e) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n\r\n        const menuItemsList = [\r\n            {\r\n                name: \"Mission Planner Page\",\r\n                func: this.props.showMissionPlannerScreen,\r\n                iconCss: \"MissionPlannerIcon\"\r\n            }\r\n        ];\r\n\r\n        this.props.showContextMenu(e.clientX, e.clientY, menuItemsList);\r\n    }\r\n\r\n    render() {\r\n\r\n        if (this.props.isLoading) {\r\n            return <Loader loadingMessage={'initializing...'} />;\r\n        }\r\n\r\n        const plannerHiddenClass = this.props.isMissionPlanScreenHidden ? ` ${classNames.MissionPlannerHidden}` : '';\r\n\r\n        return (\r\n            <div className={classNames.App}>\r\n                <GlobalMessage />\r\n                {this.props.popupDetails ? <Popup popupDetails={this.props.popupDetails} /> : null}\r\n                {this.props.contextMenu ? <ContextMenu contextMenu={this.props.contextMenu} /> : null}\r\n                {this.getGeneralErrorPopup()}\r\n                {this.getMainHeader()}\r\n                <Main isMissionPlanScreenHidden={this.props.isMissionPlanScreenHidden} />\r\n                <div className={`${classNames.MissionPlannerOverlay}${plannerHiddenClass}`}>\r\n                    <MissionPlanner />\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        contextMenu: state.layout.contextMenu,\r\n        popupDetails: state.layout.popupDetails,\r\n        missionState: state.output.missionState || 'N/A',\r\n        lastPosition: state.map.lastPosition || {},\r\n        isMissionPlanScreenHidden: state.layout.isMissionPlanScreenHidden,\r\n        dronePositionOffset: state.map.dronePositionOffset,\r\n    }\r\n};\r\n\r\nconst mapDispachToProps = (dispatch) => {\r\n    return {\r\n        setMapCoreSDKLoadedFlag: () => dispatch({ type: actionTypes.SET_MAPCORE_SDK_LOADED_FLAG }),\r\n        setMapToShow: groupNode => dispatch({ type: actionTypes.SET_MAP_TO_SHOW, payload: groupNode }),\r\n        showContextMenu: (x, y, items) => dispatch({ type: actionTypes.SHOW_CONTEXT_MENU, payload: { x, y, items } }),\r\n        showMissionPlannerScreen: () => dispatch({ type: actionTypes.SHOW_MISSION_PLANNER_SCREEN }),\r\n    };\r\n};\r\n\r\nexport default withRouter(connect(mapStateToProps, mapDispachToProps)(App));\r\n\r\n//export default connect(mapStateToProps, mapDispachToProps)(App);\r\n","import actionTypes from '../actions/actionTypes';\r\nimport * as geoCalculations from '../../utils/geoCalculations';\r\n\r\nconst initialState = {\r\n    isMapCoreSDKLoaded: false,\r\n    mapToShow: null,\r\n    droneMoveOffset: [],\r\n    lastPosition: {},\r\n    workingOrigin: null,\r\n    enemyPositionOffset: null\r\n};\r\n\r\nconst mapReducer = (state = initialState, action) => {\r\n    switch (action.type) {\r\n        case actionTypes.SET_MAPCORE_SDK_LOADED_FLAG:\r\n            return {\r\n                ...state,\r\n                isMapCoreSDKLoaded: true\r\n            }\r\n        case actionTypes.SET_MAP_TO_SHOW:\r\n            return {\r\n                ...state,\r\n                mapToShow: action.payload\r\n            }\r\n        case actionTypes.GET_DRONE_POSITION_OFFSET:\r\n            const angle =  geoCalculations.quaternionToYaw(action.payload.droneRotationQuaternion);\r\n            return {\r\n                ...state,\r\n                dronePositionOffset : { ...action.payload.dronePositionOffset, angle }\r\n            }\r\n        case actionTypes.GET_ENEMY_POSITION:\r\n            return {\r\n                ...state,\r\n                enemyPositionOffset: action.payload.enemyPosition\r\n            }\r\n        case actionTypes.SAVE_DRONE_LAST_POSITION:\r\n            return {\r\n                ...state,\r\n                lastPosition: action.payload.lastPosition\r\n            }\r\n        case actionTypes.SAVE_ORIGIN_COORDINATE:\r\n            return {\r\n                ...state,\r\n                workingOrigin: {\r\n                    coordinate: action.payload.coordinate,\r\n                    angle: action.payload.angle\r\n                }\r\n            }\r\n\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default mapReducer;","import actionTypes from '../actions/actionTypes';\n\nconst initialState = {        \n    isPaused: false\n};\n\nconst videoReducer = (state = initialState, action ) => {\n    switch (action.type) {\n        case actionTypes.PAUSE_VIDEO:\n            return {\n                ...state,\n                isPaused: true\n            }\n        case actionTypes.RESUME_VIDEO:\n            return {\n                ...state,\n                isPaused: false\n            }\n        default:\n            return state;\n    }\n};\n\nexport default videoReducer;","import actionTypes from '../actions/actionTypes';\r\n\r\nconst initialState = {\r\n    skeletonRange: 'N/A',\r\n    weaponDetected: false,\r\n    indoorExplorationFlag: false,\r\n    missionState: ''\r\n};\r\n\r\nconst outputReducer = (state = initialState, action) => {\r\n    switch (action.type) {\r\n        case actionTypes.TOGGLE_SIDE_BAR: {\r\n            return {\r\n                ...state,\r\n                toasts: state.toasts.filter(t => !t.alwaysOnTop)\r\n            }\r\n        }\r\n        case actionTypes.UPDATE_SKELETON_RANGE:\r\n            return {\r\n                ...state,\r\n                skeletonRange: action.payload.skeletonRange\r\n            }\r\n        case actionTypes.SET_WEAPON_DETECTION:\r\n            return {\r\n                ...state,\r\n                weaponDetected: action.payload.weaponDetected\r\n            }\r\n        case actionTypes.SET_INDOOR_EXPLORATION_FLAG:\r\n            return {\r\n                ...state,\r\n                indoorExplorationFlag: true\r\n            }\r\n        case actionTypes.REMOVE_INDOOR_EXPLORATION_FLAG:\r\n            return {\r\n                ...state,\r\n                indoorExplorationFlag: false\r\n            }\r\n        case actionTypes.SET_MISSION_STATE:\r\n            return {\r\n                ...state,\r\n                missionState: action.payload.missionState\r\n            }\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default outputReducer;","import actionTypes from '../actions/actionTypes';\r\n\r\nconst initialState = {\r\n    appGlobalMessage: null,\r\n    isRosWebsocketConncted: false,\r\n    contextMenu: null,    //{x,y,menuItems}\r\n    popupDetails: null,\r\n    imageSentToDroneData: null,\r\n    isMissionPlanScreenHidden: true,\r\n    isPointSelectionMode: false\r\n};\r\n\r\nconst layoutReducer = (state = initialState, action) => {\r\n    switch (action.type) {\r\n        case actionTypes.SHOW_GLOBAL_MESSAGE:\r\n            return {\r\n                ...state,\r\n                appGlobalMessage: { text: action.payload.text, type: action.payload.type }\r\n            }\r\n        case actionTypes.REMOVE_GLOBAL_MESSAGE:\r\n            return {\r\n                ...state,\r\n                appGlobalMessage: null\r\n            }\r\n        case actionTypes.ROSS_WEBSOCKET_CONNECTION_SUCCESS: {\r\n            return {\r\n                ...state,\r\n                isRosWebsocketConncted: true\r\n            }\r\n        }\r\n        case actionTypes.ROSS_WEBSOCKET_CONNECTION_FAILED: {\r\n            return {\r\n                ...state,\r\n                isRosWebsocketConncted: false\r\n            }\r\n        }\r\n        case actionTypes.ROSS_WEBSOCKET_CONNECTION_CLOSED: {\r\n            return {\r\n                ...state,\r\n                isRosWebsocketConncted: false\r\n            }\r\n        }\r\n        case actionTypes.SHOW_CONTEXT_MENU: {\r\n            const contextMenu = {\r\n                x: action.payload.x,\r\n                y: action.payload.y,\r\n                options: action.payload.options,\r\n                items: action.payload.items\r\n            };\r\n            return {\r\n                ...state,\r\n                contextMenu\r\n            }\r\n        }\r\n        case actionTypes.CLOSE_CONTEXT_MENU: {\r\n            return {\r\n                ...state,\r\n                contextMenu: null\r\n            }\r\n        }\r\n        case actionTypes.SHOW_POPUP: {\r\n            return {\r\n                ...state,\r\n                popupDetails: { ...action.payload }\r\n            }\r\n        }\r\n        case actionTypes.HIDE_POPUP: {\r\n            return {\r\n                ...state,\r\n                popupDetails: null\r\n            }\r\n        }\r\n        case actionTypes.SELECT_POINT_FROM_MAP: {\r\n            let popupDetails = {...state.popupDetails};\r\n            popupDetails.modalChildProps.pointFromMap = action.payload.pointFromMap;\r\n            return {\r\n                ...state,\r\n                popupDetails\r\n            }\r\n        }\r\n        case actionTypes.TOGGLE_POINT_SELECTION_MODE: {\r\n            return {\r\n                ...state,\r\n                isPointSelectionMode: !state.isPointSelectionMode\r\n            }\r\n        }\r\n        case actionTypes.IMAGE_SENT_TO_DRONE: {\r\n            return {\r\n                ...state,\r\n                imageSentToDroneData: action.payload\r\n            }\r\n        }\r\n        case actionTypes.SHOW_MISSION_PLANNER_SCREEN: {\r\n            return {\r\n                ...state,\r\n                isMissionPlanScreenHidden: false\r\n            }\r\n        }\r\n        case actionTypes.HIDE_MISSION_PLANNER_SCREEN: {\r\n            return {\r\n                ...state,\r\n                isMissionPlanScreenHidden: true\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default layoutReducer;","import {combineReducers} from 'redux';\r\n\r\nimport mapReducer from './mapReducer';\r\nimport videoReducer from './videoReducer';\r\nimport outputReducer from './outputReducer';\r\nimport layoutReducer from './layoutReducer';\r\nimport plannerReducer from './plannerReducer';\r\n\r\nconst rootReducer = combineReducers({\r\n\tmap: mapReducer,\r\n    output: outputReducer,\r\n    video: videoReducer,\r\n    layout: layoutReducer,\r\n    planner: plannerReducer,\r\n});\r\n\r\nexport default rootReducer;\r\n","import axios from 'axios';\n\nconst initInterceptor = store => {\n\taxios.interceptors.response.use(\n\t\tresponse => response,\n\t\terr => {\n\t\t\tif (axios.isCancel(err)) return Promise.reject(err);\n\t\t\t\n\t\t\tlet errorMessage = (err.response && err.response.data && err.response.data.errMsg) || 'Unknown Error';\n\t\t\t// store.dispatch(logError(errorMessage));\n\t\t\t/*if (!err.response) {\n\t\t\t\tconst payload = {\n\t\t\t\t\ttitle: 'Connection Error',\n\t\t\t\t\tmessage: 'It looks like the server is down!'\n\t\t\t\t};\n\t\t\t\tstore.dispatch({type: actionTypes.SHOW_POPUP, payload});\n\t\t\t}*/\n\t\t\tconsole.error(errorMessage);\n\t\t\treturn Promise.reject(err);\n\t\t}\n\t);\n};\n\nexport default initInterceptor;\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport 'typeface-roboto';\r\nimport { createStore, applyMiddleware, compose } from 'redux';\r\nimport { Provider } from 'react-redux';\r\nimport reduxThunk from 'redux-thunk';\r\nimport rootReducer from './store/reducers';\r\nimport initInterceptor from './store/interceptor';\r\nimport rosWebsocketInstance from './rosWebsocket';\r\nimport externalConfig from './ExternalConfigurationHandler';\r\nimport Loader from './components/LoaderAlt/LoaderAlt';\r\nimport axios from 'axios';\r\nimport config from './config';\r\nimport {BrowserRouter} from 'react-router-dom';\r\n\r\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\nexport const store = createStore(rootReducer, composeEnhancers(applyMiddleware(reduxThunk)));\r\n\r\n\r\n\r\nReactDOM.render(\r\n    <React.StrictMode>\r\n        <Loader loadingMessage={'initializing...'} />\r\n    </React.StrictMode>,\r\n    document.getElementById('root')\r\n);\r\n\r\naxios.get(config.urls.configuration)\r\n      .then((res) => {\r\n        externalConfig.setConfiguration(res.data);\r\n        renderAplication();\r\n      })\r\n      .catch((e) => {\r\n        console.error('error when trying to retreive configuration.json', e);\r\n      });\r\n\r\nfunction renderAplication() {\r\n    \r\n    initInterceptor(store);\r\n    rosWebsocketInstance.register(store);\r\n\r\n    ReactDOM.render(\r\n        <React.StrictMode>\r\n            <Provider store={store}>\r\n                <BrowserRouter>\r\n                    <App />\r\n                </BrowserRouter>\r\n            </Provider>\r\n        </React.StrictMode>,\r\n        document.getElementById('root')\r\n    );\r\n  \r\n\r\n}\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Wrapper\":\"MapContainer_Wrapper__OE-Im\",\"LoadingMessage\":\"MapContainer_LoadingMessage__14yuN\",\"CanvasContainer\":\"MapContainer_CanvasContainer__2i1ed\",\"MapWrapper\":\"MapContainer_MapWrapper__1a3eP\",\"MapToolbox\":\"MapContainer_MapToolbox__3AsXy\",\"Active\":\"MapContainer_Active__2Kp4d\",\"DescRow\":\"MapContainer_DescRow__35Gf1\",\"DescValue\":\"MapContainer_DescValue__1tdjU\",\"DescLabel\":\"MapContainer_DescLabel__duL4Q\",\"Description\":\"MapContainer_Description__3BpZx\",\"MoreActionsBtn\":\"MapContainer_MoreActionsBtn__183NH\",\"SwitchMapForm\":\"MapContainer_SwitchMapForm__qSukR\",\"Open\":\"MapContainer_Open__13Vdu\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Overlay\":\"LoaderAlt_Overlay__Twbr9\",\"loader\":\"LoaderAlt_loader__3-NdK\",\"circle\":\"LoaderAlt_circle__1n77p\",\"orbit\":\"LoaderAlt_orbit__3PjiK\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Wrapper\":\"AddMissionPlanStageForm_Wrapper__20O_N\",\"InputWrapper\":\"AddMissionPlanStageForm_InputWrapper__3iDw0\",\"Row\":\"AddMissionPlanStageForm_Row__2yBin\",\"InnerInputWrapper\":\"AddMissionPlanStageForm_InnerInputWrapper__aFAh3\",\"Label\":\"AddMissionPlanStageForm_Label__1FCH0\",\"Icon\":\"AddMissionPlanStageForm_Icon__1D59S\",\"PositionIcon\":\"AddMissionPlanStageForm_PositionIcon__3ZJZJ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"contextMenu\":\"ContextMenu_contextMenu__kMy1O\",\"contextMenuUL\":\"ContextMenu_contextMenuUL__2On5z\",\"Close\":\"ContextMenu_Close__2i3AY\",\"right\":\"ContextMenu_right__22SMg\",\"menuItem\":\"ContextMenu_menuItem__1KEdH\",\"ContextMenuIcon\":\"ContextMenu_ContextMenuIcon__1Oi0m\",\"Map\":\"ContextMenu_Map__N8IQQ\",\"DTM\":\"ContextMenu_DTM__unuvg\",\"ThreeD\":\"ContextMenu_ThreeD__28TFS\",\"AddMapLocation\":\"ContextMenu_AddMapLocation__2GsU4\",\"DeleteIcon\":\"ContextMenu_DeleteIcon__2vgJ3\",\"EditIcon\":\"ContextMenu_EditIcon__2q0O9\",\"ArrowUpIcon\":\"ContextMenu_ArrowUpIcon__btO7H\",\"ArrowDownIcon\":\"ContextMenu_ArrowDownIcon__21AM7\",\"MissionPlannerIcon\":\"ContextMenu_MissionPlannerIcon__1UHr_\",\"PcIcon\":\"ContextMenu_PcIcon__2usAK\",\"DroneIcon\":\"ContextMenu_DroneIcon__1Gkp4\",\"menuName\":\"ContextMenu_menuName__3J6AG\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"MainContentWrapper\":\"Main_MainContentWrapper__2IfBe\",\"Hidden\":\"Main_Hidden__3IoL-\",\"RightPaneWrapper\":\"Main_RightPaneWrapper__HS99V\",\"RightPaneWrapperItem\":\"Main_RightPaneWrapperItem__5g7g7\",\"Split\":\"Main_Split__1dRIF\",\"Left\":\"Main_Left__1Sd8A\",\"Right\":\"Main_Right__3Vo95\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Wrapper\":\"SwitchMapForm_Wrapper__rz1O6\",\"Shown\":\"SwitchMapForm_Shown__3-jAd\",\"Header\":\"SwitchMapForm_Header__3ycga\",\"Button\":\"SwitchMapForm_Button__1haAL\",\"Body\":\"SwitchMapForm_Body__nA-nK\",\"Apply\":\"SwitchMapForm_Apply__lU8hh\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"sliderWrapper\":\"Slider_sliderWrapper__2GW61\",\"mapslider\":\"Slider_mapslider__1YAs1\",\"dragline\":\"Slider_dragline__2GvE_\",\"line\":\"Slider_line__1NBjj\",\"draggablebutton\":\"Slider_draggablebutton__I3ho1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Wrapper\":\"FlightTelemetry_Wrapper__3ATH4\",\"TelemetryWrapper\":\"FlightTelemetry_TelemetryWrapper__4DCz_\",\"Units\":\"FlightTelemetry_Units__28uQr\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ComboLabel\":\"Select_ComboLabel__re1Pw\",\"Mandatory\":\"Select_Mandatory__1vP6C\",\"DropDownWrapper\":\"Select_DropDownWrapper__11AI_\",\"DropDownArrow\":\"Select_DropDownArrow__1O0O6\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Wrapper\":\"GlobalMessage_Wrapper__YEmXz\",\"MissionPlannerOpen\":\"GlobalMessage_MissionPlannerOpen__1ZlDW\",\"Icon\":\"GlobalMessage_Icon__3REUV\",\"Text\":\"GlobalMessage_Text__3-_ED\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"radio\":\"Radio_radio__2RbZJ\",\"radio__input\":\"Radio_radio__input__24quD\",\"radio__radio\":\"Radio_radio__radio__JZlZx\",\"Label\":\"Radio_Label__39gbm\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Wrapper\":\"RadioGroup_Wrapper__vHYmQ\",\"Label\":\"RadioGroup_Label__1gBMn\",\"RadioGroupValuesWrapper\":\"RadioGroup_RadioGroupValuesWrapper__3OoRR\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"DateTime\":\"Clock_DateTime__2sjt8\",\"Hour\":\"Clock_Hour__1hO_o\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Wrapper\":\"Error_Wrapper__2GS-R\"};","import React, { PureComponent, Component } from 'react';\r\nimport cn from './MapContainer.module.css';\r\nimport axios from 'axios';\r\nimport config from '../../config';\r\nimport { connect } from 'react-redux';\r\nimport externalConfig from '../../ExternalConfigurationHandler';\r\nimport actionTypes from '../../store/actions/actionTypes';\r\nimport actions from '../../store/actions';\r\nimport SwitchMapForm from '../SwitchMapForm/SwitchMapForm';\r\nimport * as geoCalculations from '../../utils/geoCalculations';\r\n\r\nclass SLayerGroup {\r\n    constructor(coordSystemString, bShowGeoInMetricProportion, bSetTerrainBoxByStaticLayerOnly, InitialScale2D) {\r\n        this.aLayerCreateStrings = [];\r\n        this.coordSystemString = coordSystemString;\r\n        this.bShowGeoInMetricProportion = bShowGeoInMetricProportion;\r\n        this.bSetTerrainBoxByStaticLayerOnly = bSetTerrainBoxByStaticLayerOnly;\r\n        this.InitialScale2D = InitialScale2D;\r\n    }\r\n}\r\n\r\nclass SViewportData {\r\n    constructor(_viewport, _editMode) {\r\n        this.viewport = _viewport;\r\n        this.editMode = _editMode;\r\n        this.canvas = _viewport.GetWindowHandle();\r\n        let aViewportTerrains = _viewport.GetTerrains();\r\n        this.aLayers = (aViewportTerrains != null && aViewportTerrains.length > 0 ? aViewportTerrains[0].GetLayers() : null);\r\n        this.terrainBox = null;\r\n        this.terrainCenter = null;\r\n        this.rotationCenter = null;\r\n        this.bCameraPositionSet = false;\r\n        this.bSetTerrainBoxByStaticLayerOnly = false;\r\n    }\r\n}\r\n\r\nclass MapContainer extends PureComponent {\r\n\r\n    state = {\r\n        mapLayerGroups: new Map(),\r\n        lastTerrainConfiguration: null,\r\n        lastViewportConfiguration: null /*  2D/3D, 3D/2D, 2D, 3D */,\r\n        bSameCanvas: true,\r\n        isDTMClicked: false,\r\n        is3DClicked: false,\r\n        isSwitchMapFormOpen: false,\r\n        workingOriginSelected: false\r\n    }\r\n\r\n    mapTerrains = new Map;\r\n    device = null\r\n    //callbacks classes from mapCore\r\n    CLayerReadCallback;\r\n    CCameraUpdateCallback;\r\n    CAsyncQueryCallback;\r\n    viewportData = null;\r\n    uCameraUpdateCounter = 0;\r\n    aLastTerrainLayers = [];\r\n    lastCoordSys = null;\r\n    overlayManager = null;\r\n    activeViewport = -1;\r\n    aViewports = [];\r\n    viewport;\r\n    editMode;\r\n    lastRenderTime = (new Date).getTime();\r\n    lastMemUsageLogTime = (new Date).getTime();\r\n    uMemUsageLoggingFrequency = 0;\r\n    nMousePrevX = 0;\r\n    nMousePrevY = 0;\r\n    mouseDownButtons = 0;\r\n    bEdit = false;\r\n    layerCallback = null;\r\n    requestAnimationFrameId = -1;\r\n    aPositions = [];\r\n    aObjects = [];\r\n    droneScheme = null;\r\n    lineScheme = null;\r\n    textScheme = null;\r\n    locationScheme = null;\r\n    pinPointScheme = null;\r\n\r\n    WorldPictureScheme = null;\r\n    ScreenPictureScheme = null;\r\n\r\n    TempOriginAngle = 0;\r\n    WorkingOrigin = null;\r\n    DroneRouteCoordinates = [];\r\n    DroneObject = null;\r\n    DroneRouteObject = null;\r\n    SelectedMissionPointObject = null;\r\n    MissionPointsObjects = [];\r\n    MapObjectType = Object.freeze({ \"ORIGIN\": 1, \"MISSION\": 2, \"ENEMY\": 3 });\r\n\r\n    componentDidMount() {\r\n        window.addEventListener('resize', this.resizeCanvases);\r\n        //this.callGetCapabilitiesApi();\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        //Todo -> un-register events and all the map core object\r\n        window.removeEventListener('resize', this.resizeCanvases);\r\n        cancelAnimationFrame(this.requestAnimationFrameId);\r\n        this.requestAnimationFrameId = null;\r\n    }\r\n\r\n    componentDidUpdate(prevProps) {\r\n        // first time map load or channing from map a to map b\r\n        if ((!prevProps.isMapCoreSDKLoaded && this.props.isMapCoreSDKLoaded) ||\r\n            (this.props.isMapCoreSDKLoaded && prevProps.mapToShow !== this.props.mapToShow)) {\r\n            this.openMap(this.props.mapToShow.groupName, false);\r\n            console.log('mapCore version: ', window.MapCore.IMcMapDevice.GetVersion());\r\n            this.CreateMapcoreObjects();\r\n            this.RemoveDroneData();\r\n        }\r\n        if (this.state.workingOriginSelected &&\r\n            this.props.dronePositionOffset &&\r\n            (prevProps.dronePositionOffset != this.props.dronePositionOffset)) {\r\n            this.MoveDrone();\r\n        }\r\n\r\n        if (this.props.isPointSelectionMode && !prevProps.isPointSelectionMode && !this.SelectedMissionPointObject) {\r\n            this.selectMissionPointFromMap();\r\n        }\r\n\r\n        if (this.props.enemyPositionOffset && this.props.enemyPositionOffset != prevProps.enemyPositionOffset) {\r\n            this.UpdateEnemyPosition();\r\n        }\r\n\r\n    }\r\n\r\n    RemoveDroneData = () => {\r\n        if (this.WorkingOrigin) {\r\n            this.WorkingOrigin.Remove();\r\n            this.WorkingOrigin = null;\r\n            this.props.saveOriginCoordinate(null);\r\n        }\r\n        if (this.DroneObject) {\r\n            this.DroneObject.Remove();\r\n            this.DroneObject = null;\r\n        }\r\n        if (this.DroneRouteObject) {\r\n            this.DroneRouteObject.Remove();\r\n            this.DroneRouteObject = null;\r\n        }\r\n        this.DroneRouteCoordinates = [];\r\n    }\r\n\r\n    CreateMapcoreObjects = () => {\r\n        this.LoadMapcoreObject(\"lineScheme\", \"LineScheme.m\");\r\n        this.LoadMapcoreObject(\"droneScheme\", \"Drone.m\");\r\n        this.LoadMapcoreObject(\"locationScheme\", \"Location.m\");\r\n        this.LoadMapcoreObject(\"pinPointScheme\", \"PinPoint.m\");\r\n        this.LoadMapcoreObject(\"ScreenPictureScheme\", \"ScreenPicture2.json\");\r\n        this.LoadMapcoreObject(\"WorldPictureScheme\", \"WorldPicture2.json\");\r\n        this.LoadMapcoreObject(\"textScheme\", \"TextScheme.m\");\r\n    }\r\n\r\n    LoadMapcoreObject(objectName, schemeName) {\r\n        if (this[objectName] == null) {\r\n            this.FetchFileToByteArray(\"http:ObjectWorld/Schemes/\" + schemeName).then(\r\n                bytes => {\r\n                    if (bytes != null) {\r\n                        this[objectName] = this.overlayManager.LoadObjectSchemes(bytes)[0];\r\n                        this[objectName].AddRef();\r\n                    }\r\n                }\r\n            );\r\n        }\r\n    }\r\n\r\n    StartEditMode = (ID) => {\r\n        if (this.ScreenPictureScheme != null) {\r\n            // find item marked for editing (e.g. by setting ID = 1000)\r\n            let pItem = this.ScreenPictureScheme.GetNodeByID(1000);\r\n            if (pItem == null) {\r\n                alert(\"There is no item marked for editing (with ID = 1000)\");\r\n                return null;\r\n            }\r\n            // create object\r\n            let pObject = window.MapCore.IMcObject.Create(this.overlay, this.ScreenPictureScheme);\r\n            ID && pObject.SetID(ID);\r\n            // start EditMode action\r\n            this.editMode.StartInitObject(pObject, pItem);\r\n\r\n            return pObject;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    selectMissionPointFromMap = () => {\r\n        this.SelectedMissionPointObject = this.StartEditMode(this.MissionPointsObjects.length + 1);\r\n    }\r\n\r\n    SetWorkingOrigin = () => {\r\n        this.RemoveDroneData();\r\n        this.WorkingOrigin = this.StartEditMode(0);\r\n    }\r\n\r\n    UpdateEnemyPosition() {\r\n        const coordinateWithOffset = geoCalculations.getMapCoordinate(this.props.workingOrigin, this.props.enemyPositionOffset);\r\n        this.EnemyObject = window.MapCore.IMcObject.Create(this.overlay, this.ScreenPictureScheme, [coordinateWithOffset]);\r\n        this.EnemyObject.SetTextureProperty(1, window.MapCore.IMcImageFileTexture.Create(window.MapCore.SMcFileSource(\"http:ObjectWorld/Images/enemy.png\", false), false));\r\n        this.EnemyObject.SetFloatProperty(2, 0.5);\r\n    }\r\n\r\n    DrawDroneObjects() {\r\n        const originCoordinate = this.props.workingOrigin.coordinate;\r\n        this.DroneRouteCoordinates.push(originCoordinate);\r\n        this.DroneObject = window.MapCore.IMcObject.Create(this.overlay, this.ScreenPictureScheme, [originCoordinate]);\r\n        this.DroneObject.SetTextureProperty(1, window.MapCore.IMcImageFileTexture.Create(window.MapCore.SMcFileSource(\"http:ObjectWorld/Images/droneNew.png\", false), false));\r\n        this.DroneObject.SetFloatProperty(2, 0.9);\r\n        this.DroneObject.SetFloatProperty(4, 360 - this.props.workingOrigin.angle);\r\n        this.DroneRouteObject = window.MapCore.IMcObject.Create(this.overlay, this.lineScheme, [originCoordinate]);\r\n        this.DroneRouteObject.SetState([2])\r\n    }\r\n    // getMapCoordinate = (offset) => {\r\n    //     const offsetWithAngle = geoCalculations.calculateOffsetWithAngle(offset,  this.props.workingOrigin.angle);\r\n    //     const mapOffset = geoCalculations.convertMapOffsetToDroneOffset(offsetWithAngle);\r\n    //     return geoCalculations.addCoordinates(this.props.workingOrigin.coordinate, mapOffset);\r\n    // }\r\n\r\n    MoveDrone = () => {\r\n\r\n        if (!this.WorkingOrigin || !this.state.workingOriginSelected) {\r\n            console.log(\"No Working Origin Selected!!\");\r\n            return;\r\n        }\r\n        if (!this.DroneObject || !this.DroneRouteObject) {\r\n            this.DrawDroneObjects();\r\n            return;\r\n        }\r\n\r\n        const coordinateWithOffset = geoCalculations.getMapCoordinate(this.props.workingOrigin, this.props.dronePositionOffset);\r\n\r\n        if (this.DroneRouteCoordinates.length > 0) {\r\n            let prevCoordinate = this.DroneRouteCoordinates[this.DroneRouteCoordinates.length - 1];\r\n            if (geoCalculations.calculateDistanceBetween2Points(prevCoordinate, coordinateWithOffset) < config.MIN_DRONE_DISTANCE_MOVE) { //too small distance , not importent\r\n                return;\r\n            }\r\n        }\r\n\r\n        this.DroneRouteCoordinates.push(coordinateWithOffset);\r\n        this.DroneObject.UpdateLocationPoints([coordinateWithOffset]);\r\n        this.DroneObject.SetFloatProperty(4, this.props.workingOrigin.angle - this.props.dronePositionOffset.angle);\r\n        this.DroneRouteObject.SetLocationPoints(this.DroneRouteCoordinates);\r\n        this.props.saveDroneLastCoordinate(coordinateWithOffset);\r\n    }\r\n\r\n\r\n    // function fetching a file from server to byte-array\r\n    FetchFileToByteArray(uri) {\r\n        return fetch(uri)\r\n            .then(response => (response.ok ? response.arrayBuffer() : null))\r\n            .then(\r\n                arrayBuffer => {\r\n                    if (arrayBuffer != null) {\r\n                        return new Uint8Array(arrayBuffer);\r\n                    }\r\n                    else {\r\n                        alert(\"Cannot fetch \" + uri);\r\n                        return null;\r\n                    }\r\n                },\r\n                error => {\r\n                    alert(\"Network error in fetching \" + uri);\r\n                    return null;\r\n                }\r\n            );\r\n    }\r\n\r\n    OnEditClickWorkingOrigin = () => {\r\n        if (this.WorkingOrigin && this.WorkingOrigin.GetLocationPoints().length > 0) {\r\n            this.setState({ workingOriginSelected: true })\r\n            this.WorkingOrigin.SetTextureProperty(1, window.MapCore.IMcImageFileTexture.Create(window.MapCore.SMcFileSource(\"http:ObjectWorld/Images/location4.png\", false), false));\r\n            //    this.WorkingOrigin.SetFloatProperty(2, 1);\r\n            const originCoordinate = geoCalculations.roundCoordinate(this.WorkingOrigin.GetLocationPoints()[0], config.COORDINATE_DECIMALS_PRECISION);\r\n            this.props.saveOriginCoordinate(originCoordinate, 360 - this.TempOriginAngle);\r\n            this.props.saveDroneLastCoordinate(originCoordinate);\r\n        }\r\n    }\r\n    OnEditClickMissionPoint = () => {\r\n        if (this.SelectedMissionPointObject && this.SelectedMissionPointObject.GetLocationPoints().length > 0) {\r\n            this.props.togglePointSelectionMode();\r\n            this.SelectedMissionPointObject.SetTextureProperty(1, window.MapCore.IMcImageFileTexture.Create(window.MapCore.SMcFileSource(\"http:ObjectWorld/Images/pinPoint.png\", false), false));\r\n            //this.SelectedMissionPointObject.SetFloatProperty(2, 0.8);\r\n            let locationPoints = this.SelectedMissionPointObject.GetLocationPoints()[0];\r\n            locationPoints.z = config.DEFAULT_MISSION_POINT_HEIGHT;\r\n            this.props.selectPointFromMap(geoCalculations.roundCoordinate(locationPoints, config.COORDINATE_DECIMALS_PRECISION));\r\n            this.MissionPointsObjects.push(this.SelectedMissionPointObject);\r\n        }\r\n\r\n        this.SelectedMissionPointObject = null;\r\n    }\r\n\r\n\r\n    parseLayersConfiguration(jsonLayerGroups) {\r\n        try {\r\n            for (let jsonGroup of jsonLayerGroups) {\r\n                // coordinate system creation string: MapCore.IMcGridCoordSystemGeographic.Create(MapCore.IMcGridCoordinateSystem.EDatumType.EDT_WGS84) etc.\r\n                let coordSystemString = \"MapCore.\" + jsonGroup.coordSystemType + \".Create(\" + jsonGroup.coordSystemParams + \")\";\r\n                let layerGroup = new SLayerGroup(coordSystemString, jsonGroup.showGeoInMetricProportion, jsonGroup.centerByStaticObjectsLayerOnly, jsonGroup.InitialScale2D);\r\n\r\n                if (jsonGroup.layers) {\r\n                    for (let layer of jsonGroup.layers) {\r\n                        let layerCreateString = null;\r\n                        const protocol = window.location.protocol;\r\n                        switch (layer.type) {\r\n                            case \"WMSRaster\":\r\n                                // WMS raster layer creation string: CreateWMSRasterLayer('http://wmtsserver/wmts?request=GetCapabilities', 'layer', 'EPSG:4326', 'jpeg') etc.\r\n                                layerCreateString = \"Create\" + layer.type + \"Layer('\" + layer.path + \"'\" + (layer.params ? \", \" + layer.params : \"\") + \")\";\r\n                                break;\r\n                            case \"IMcNativeRasterMapLayer\":\r\n                                layerCreateString = \"MapCore.IMcNativeRasterMapLayer.Create('\" + protocol + layer.path + \"', \" + (layer.params ? layer.params : \"MapCore.UINT_MAX, false, 0, false\") + \", this.layerCallback)\";\r\n                                break;\r\n                            case \"IMcNativeDtmMapLayer\":\r\n                                layerCreateString = \"MapCore.IMcNativeDtmMapLayer.Create('\" + protocol + layer.path + \"', \" + (layer.params ? layer.params : \"0\") + \", this.layerCallback)\";\r\n                                break;\r\n                            case \"IMcNativeVectorMapLayer\":\r\n                                layerCreateString = \"MapCore.IMcNativeVectorMapLayer.Create('\" + protocol + layer.path + \"', \" + (layer.params ? layer.params : \"\") + \"this.layerCallback)\";\r\n                                break;\r\n                            case \"IMcNative3DModelMapLayer\":\r\n                                layerCreateString = \"MapCore.IMcNative3DModelMapLayer.Create('\" + protocol + layer.path + \"', \" + (layer.params ? layer.params : \"0\") + \", this.layerCallback)\";\r\n                                break;\r\n                            case \"IMcNativeVector3DExtrusionMapLayer\":\r\n                                layerCreateString = \"MapCore.IMcNativeVector3DExtrusionMapLayer.Create('\" + protocol + layer.path + \"', \" + (layer.params ? layer.params : \"0, 10\") + \", this.layerCallback)\";\r\n                                break;\r\n                            default:\r\n                                alert(\"Invalid type of server layer\");\r\n                                return;\r\n                        }\r\n                        layerGroup.aLayerCreateStrings.push(layerCreateString);\r\n                    }\r\n                }\r\n                if (jsonGroup.groupName != undefined) {\r\n\r\n                    this.setState({ mapLayerGroups: new Map(this.state.mapLayerGroups.set(jsonGroup.groupName, layerGroup)) });\r\n\r\n                }\r\n                // we should not get here...\r\n                else if (jsonGroup.wmtsServerURL != undefined) {\r\n\r\n                    // layerGroup.wmtsServerURL = jsonGroup.wmtsServerURL;\r\n                    // if (jsonGroup.tileMatrixSetFilter != undefined) {\r\n\r\n                    //     layerGroup.tileMatrixSetFilter = jsonGroup.tileMatrixSetFilter;\r\n                    // }\r\n                    // aWmtsAdditionalLayerGroups.push(layerGroup);\r\n                }\r\n            }\r\n        }\r\n        catch (e) {\r\n            alert(\"Invalid configuration JSON file\");\r\n        }\r\n    }\r\n\r\n    parseCapabilitiesXML(xmlDoc, capabilitiesURL, bMapCoreLayerServer = true, wmtsAdditionalLayerGroup) {\r\n        class CXmlNode {\r\n            constructor(node) {\r\n                this.node = node;\r\n            }\r\n            GetFirstChild(tagName) {\r\n                let children = this.node.getElementsByTagName(tagName);\r\n                for (let child of children) {\r\n                    if (child.parentNode == this.node) {\r\n                        return new CXmlNode(child);\r\n                    }\r\n                }\r\n                return null;\r\n            }\r\n            GetFirstChildText(tagName) {\r\n                let children = this.node.getElementsByTagName(tagName);\r\n                for (let child of children) {\r\n                    if (child.parentNode == this.node) {\r\n                        return child.textContent;\r\n                    }\r\n                }\r\n                return null;\r\n            }\r\n            GetFirstChildAttribute(tagName, attributeName) {\r\n                let children = this.node.getElementsByTagName(tagName);\r\n                for (let child of children) {\r\n                    if (child.parentNode == this.node) {\r\n                        return child.attributes.getNamedItem(attributeName).value;\r\n                    }\r\n                }\r\n                return null;\r\n            }\r\n            GetChildren(tagName) {\r\n                let children = this.node.getElementsByTagName(tagName);\r\n                let aNodes = [];\r\n                for (let child of children) {\r\n                    if (child.parentNode == this.node) {\r\n                        aNodes.push(new CXmlNode(child));\r\n                    }\r\n                }\r\n                return aNodes;\r\n            }\r\n            GetChildrenTexts(tagName) {\r\n                let children = this.node.getElementsByTagName(tagName);\r\n                let aTexts = [];\r\n                for (let child of children) {\r\n                    if (child.parentNode == this.node) {\r\n                        aTexts.push(child.textContent);\r\n                    }\r\n                }\r\n                return aTexts;\r\n            }\r\n        }\r\n\r\n        if (xmlDoc != null) {\r\n            try {\r\n                let capabilities = new CXmlNode(xmlDoc).GetFirstChild(\"Capabilities\");\r\n                let MapLayerServerURL = capabilities.GetFirstChildAttribute(\"ServiceMetadataURL\", \"xlink:href\");\r\n                if (MapLayerServerURL == null || MapLayerServerURL == \"\") {\r\n                    MapLayerServerURL = capabilitiesURL;\r\n                }\r\n                let lastSlashIndex = MapLayerServerURL.lastIndexOf(\"?\");\r\n                if (lastSlashIndex < 0) {\r\n                    lastSlashIndex = MapLayerServerURL.lastIndexOf(\"/\");\r\n                }\r\n                if (lastSlashIndex < 0) {\r\n                    alert(\"Invalid Capabilities file\");\r\n                    return;\r\n                }\r\n                let TrimmedMapLayerServerURL = MapLayerServerURL.substring(0, lastSlashIndex);\r\n\r\n                let contents = capabilities.GetFirstChild(\"Contents\");\r\n                let aTileMatrixSets = contents.GetChildren(\"TileMatrixSet\");\r\n                let mapTileMatrixSets = new Map();\r\n                for (let matrixSet of aTileMatrixSets) {\r\n                    let id = matrixSet.GetFirstChildText(\"ows:Identifier\");\r\n                    let crs = matrixSet.GetFirstChildText(\"ows:SupportedCRS\");\r\n                    if (id != null && crs != null) {\r\n                        mapTileMatrixSets.set(matrixSet.GetFirstChildText(\"ows:Identifier\"), { coordSystem: crs, tileMatrixSet: id });\r\n                    }\r\n                }\r\n\r\n                let aLayers = contents.GetChildren(\"Layer\");\r\n                for (let layer of aLayers) {\r\n                    // check here if its single layer preview. if yes put only this layer in the hashMap                    \r\n                    let layerID = layer.GetFirstChildText(\"ows:Identifier\");\r\n                    if (this.context.mapToPreview.type === config.nodesLevel.layer &&\r\n                        (this.context.mapToPreview.data.LayerId !== layerID && this.context.mapToPreview.dtmLayerId !== layerID))\r\n                        continue;\r\n\r\n                    let aFormats = layer.GetChildrenTexts(\"Format\");\r\n                    let aTileMatrixSetLinks = layer.GetChildren(\"TileMatrixSetLink\");\r\n                    if (aTileMatrixSetLinks.length == 0) {\r\n                        aTileMatrixSetLinks.push(null);\r\n                    }\r\n\r\n                    for (let tileMatrixSetLink of aTileMatrixSetLinks) {\r\n                        let coordSystem = null;\r\n                        let tileMatrixSet = null;\r\n                        if (tileMatrixSetLink != null) {\r\n                            let tileMatrixSetParams = mapTileMatrixSets.get(tileMatrixSetLink.GetFirstChildText(\"TileMatrixSet\"));\r\n                            coordSystem = tileMatrixSetParams.coordSystem;\r\n                            tileMatrixSet = tileMatrixSetParams.tileMatrixSet;\r\n                            if (wmtsAdditionalLayerGroup && wmtsAdditionalLayerGroup.tileMatrixSetFilter && tileMatrixSet != wmtsAdditionalLayerGroup.tileMatrixSetFilter) {\r\n                                continue;\r\n                            }\r\n                        }\r\n                        if (coordSystem == null) {\r\n                            let boundingBox = layer.GetFirstChild(\"ows:BoundingBox\");\r\n                            if (boundingBox) {\r\n                                coordSystem = boundingBox.GetFirstChildText(\"ows:crs\");\r\n                            }\r\n                        }\r\n                        let prefix = \"urn:ogc:def:crs:\";\r\n                        if (coordSystem.indexOf(prefix) == 0) {\r\n                            coordSystem = coordSystem.substring(prefix.length).replace(\"::\", \":\");\r\n                            let aGroups = [];\r\n                            if (bMapCoreLayerServer) {\r\n                                aGroups = layer.GetFirstChildText(\"Group\").split(\",\");\r\n                                for (let i = 0; i < aGroups.length; ++i) {\r\n                                    aGroups[i] = aGroups[i] + \" (server \" + coordSystem + \")\";\r\n                                }\r\n                            }\r\n                            else {\r\n                                let groupName = layer.GetFirstChildText(\"ows:Title\");\r\n                                if (groupName == null) {\r\n                                    groupName = layerID;\r\n                                }\r\n\r\n                                for (let i = 0; i < aFormats.length; ++i) {\r\n                                    aFormats[i] = aFormats[i].replace(\"image/\", \"\");\r\n                                    aGroups[i] = groupName + \" (WMTS \" + aFormats[i] + \" \" + tileMatrixSet + \")\";\r\n                                }\r\n                            }\r\n                            for (let i = 0; i < aGroups.length; ++i) {\r\n                                let group = aGroups[i];\r\n\r\n                                // coordinate system creation string: MapCore.IMcGridGeneric.Create('EPSG:4326') etc.\r\n                                let coordSystemString = \"MapCore.IMcGridGeneric.Create('\" + coordSystem + \"')\";\r\n                                let layerGroup = this.state.mapLayerGroups.get(group);\r\n                                if (layerGroup == undefined) {\r\n                                    layerGroup = new SLayerGroup(coordSystemString, true); // for MapCoreLayerServer only: bShowGeoInMetricProportion is true\r\n                                    this.setState({ mapLayerGroups: new Map(this.state.mapLayerGroups.set(group, layerGroup)) });\r\n                                }\r\n                                else if (coordSystemString != layerGroup.coordSystemString) {\r\n                                    alert(\"Layers' coordinate systems do not match\");\r\n                                    return;\r\n                                }\r\n                                let layerCreateString;\r\n                                if (bMapCoreLayerServer) {\r\n                                    layerCreateString = aFormats[0].replace(\"MapCore\", \"MapCore.IMcNative\").replace(\"DTM\", \"Dtm\") + \"MapLayer\" + \".Create('\" + TrimmedMapLayerServerURL + \"/\" + layerID + \"')\";\r\n                                    layerGroup.aLayerCreateStrings.push(layerCreateString);\r\n                                }\r\n                                else {\r\n                                    // WMTS raster layer creation string: CreateWMTSRasterLayer('http://wmtsserver/wmts?request=GetCapabilities', 'layer', 'EPSG:4326', 'jpeg') etc.\r\n                                    layerCreateString = \"CreateWMTSRasterLayer('\" + capabilitiesURL + \"', '\" + layerID + \"', '\" + tileMatrixSet + \"', '\" + aFormats[i] + \"')\";\r\n                                    layerGroup.aLayerCreateStrings.push(layerCreateString);\r\n                                    if (wmtsAdditionalLayerGroup) {\r\n                                        layerGroup.aLayerCreateStrings = layerGroup.aLayerCreateStrings.concat(wmtsAdditionalLayerGroup.aLayerCreateStrings);\r\n                                        layerGroup.bSetTerrainBoxByStaticLayerOnly = wmtsAdditionalLayerGroup.bSetTerrainBoxByStaticLayerOnly;\r\n                                        layerGroup.bShowGeoInMetricProportion = wmtsAdditionalLayerGroup.bShowGeoInMetricProportion;\r\n                                        layerGroup.InitialScale2D = wmtsAdditionalLayerGroup.InitialScale2D;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            catch (e) {\r\n                alert(\"Invalid Capabilities file\");\r\n            }\r\n        }\r\n    }\r\n\r\n    createCallbackClasses() {\r\n        this.CLayerReadCallback = window.MapCore.IMcMapLayer.IReadCallback.extend(\"IMcMapLayer.IReadCallback\", {\r\n            // mandatory\r\n            OnInitialized: function (pLayer, eStatus, strAdditionalDataString) {\r\n                if (eStatus == window.MapCore.IMcErrors.ECode.SUCCESS) {\r\n                    //this.trySetTerainBox();\r\n                    // if (pLayer.GetLayerType() ==  window.MapCore.IMcNativeStaticObjectsMapLayer.LAYER_TYPE && !pLayer.IsBuiltOfContoursExtrusion())\r\n                    // {\r\n                    //     pLayer.SetDisplayingItemsAttachedToTerrain(true);\r\n                    //     pLayer.SetDisplayingDtmVisualization(true);\r\n                    // }\r\n                }\r\n                else if (eStatus != window.MapCore.IMcErrors.ECode.NATIVE_SERVER_LAYER_NOT_VALID) {\r\n                    alert(\"Layer initialization: \" + window.MapCore.IMcErrors.ErrorCodeToString(eStatus) + \" (\" + strAdditionalDataString + \")\");\r\n                }\r\n            },\r\n            // mandatory\r\n            OnReadError: function (pLayer, eErrorCode, strAdditionalDataString) {\r\n                alert(\"Layer read error: \" + window.MapCore.IMcErrors.ErrorCodeToString(eErrorCode) + \" (\" + strAdditionalDataString + \")\");\r\n            },\r\n            // mandatory\r\n            OnNativeServerLayerNotValid: function (pLayer, bLayerVersionUpdated) {/*TBD*/ },\r\n            // optional, needed if to be deleted by MapCore when no longer used\r\n            // optional\r\n            OnRemoved(pLayer, eStatus, strAdditionalDataString) {\r\n                alert(\"Map layer has been removed\");\r\n            },\r\n\r\n            // optional\r\n            OnReplaced(pOldLayer, pNewLayer, eStatus, strAdditionalDataString) {\r\n                alert(\"Map layer has been replaced\");\r\n            },\r\n            Release: function () { this.delete(); },\r\n        });\r\n\r\n        this.CCameraUpdateCallback = window.MapCore.IMcMapViewport.ICameraUpdateCallback.extend(\"IMcMapViewport.ICameraUpdateCallback\", {\r\n            // mandatory\r\n            OnActiveCameraUpdated: function (pViewport) {\r\n                ++this.uCameraUpdateCounter\r\n            },\r\n            // optional\r\n            Release: function () {\r\n                this.delete()\r\n            }\r\n        });\r\n\r\n        this.CAsyncQueryCallback = window.MapCore.IMcSpatialQueries.IAsyncQueryCallback.extend(\"IMcSpatialQueries.IAsyncQueryCallback\", {\r\n            // optional\r\n            __construct: function (viewportData) {\r\n                this.__parent.__construct.call(this);\r\n                this.viewportData = viewportData;\r\n            },\r\n\r\n            OnTerrainHeightResults: function (bHeightFound, height, normal) {\r\n                if (this.viewportData.viewport != null) {\r\n                    this.viewportData.terrainCenter.z = height + 20;\r\n                    if (this.viewportData.viewport.GetMapType() == window.MapCore.IMcMapCamera.EMapType.EMT_3D) {\r\n                        this.viewportData.viewport.SetCameraPosition(this.viewportData.terrainCenter);\r\n                    }\r\n                }\r\n                this.delete();\r\n            },\r\n            OnTerrainHeightMatrixResults: function (uNumHorizontalPoints, uNumVerticalPoints, adHeightMatrix) { },\r\n            OnTerrainHeightsAlongLineResults: function (aPointsWithHeights, aSlopes, pSlopesData) { },\r\n            OnExtremeHeightPointsInPolygonResults: function (bPointsFound, pHighestPoint, pLowestPoint) { },\r\n            OnTerrainAnglesResults: function (dPitch, dRoll) { },\r\n\r\n            // OnRayIntersectionResults\r\n            OnLineOfSightResults: function (aPoints, dCrestClearanceAngle, dCrestClearanceDistance) { },\r\n            OnPointVisibilityResults: function (bIsTargetVisible, pdMinimalTargetHeightForVisibility, pdMinimalScouterHeightForVisibility) { },\r\n            OnAreaOfSightResults: function (pAreaOfSight, aLinesOfSight, pSeenPolygons, pUnseenPolygons, aSeenStaticObjects) { },\r\n            OnLocationFromTwoDistancesAndAzimuthResults: function (Target) { },\r\n\r\n            // mandatory\r\n            OnError: function (eErrorCode) {\r\n                alert('error ' + eErrorCode);\r\n                this.delete();\r\n            },\r\n        });\r\n\r\n        let CUserData = window.MapCore.IMcUserData.extend(\"IMcUserData\", {\r\n            // optional\r\n            __construct: function (bToBeDeleted) {\r\n                this.__parent.__construct.call(this);\r\n                this.bToBeDeleted = bToBeDeleted;\r\n                // ...\r\n            },\r\n\r\n            // optional\r\n            __destruct: function () {\r\n                this.__parent.__destruct.call(this);\r\n                // ...\r\n            },\r\n\r\n            // mandatory\r\n            Release: function () {\r\n                if (this.bToBeDeleted) {\r\n                    this.delete();\r\n                }\r\n            },\r\n\r\n            // optional\r\n            Clone: function () {\r\n                if (this.bToBeDeleted) {\r\n                    return new CUserData(this.bToBeDeleted);\r\n                }\r\n                return this;\r\n            },\r\n        });\r\n        this.layerCallback = new this.CLayerReadCallback();\r\n    }\r\n\r\n    renderMapContinuously = () => {\r\n        if (!this.requestAnimationFrameId) return;\r\n        this.trySetTerainBox();\r\n        let currtRenderTime = (new Date).getTime();\r\n\r\n        // render viewport(s)\r\n        if (!this.state.bSameCanvas) {\r\n            window.MapCore.IMcMapViewport.RenderAll();\r\n        } else if (this.viewport != null) {\r\n            this.viewport.Render();\r\n        }\r\n\r\n        // move objects if they exist\r\n        this.lastRenderTime = currtRenderTime;\r\n\r\n        // log memory usage and heap size\r\n        if (this.uMemUsageLoggingFrequency != 0 && currtRenderTime >= this.lastMemUsageLogTime + this.uMemUsageLoggingFrequency * 1000) {\r\n            let usage = window.MapCore.IMcMapDevice.GetMaxMemoryUsage();\r\n            console.log(\"Max mem = \" + window.MapCore.IMcMapDevice.GetMaxMemoryUsage().toLocaleString() + \", heap = \" + window.MapCore.IMcMapDevice.GetHeapSize().toLocaleString() + \" B\");\r\n            this.lastMemUsageLogTime = currtRenderTime;\r\n        }\r\n\r\n        // ask the browser to render again\r\n        this.requestAnimationFrameId = requestAnimationFrame(this.renderMapContinuously);\r\n    }\r\n\r\n    trySetTerainBox = () => {\r\n        for (let j = 0; j < this.aViewports.length; j++) {\r\n            if (this.aViewports[j].terrainBox == null) {\r\n                let aViewportLayers = this.aViewports[j].aLayers;\r\n                if (aViewportLayers.length != 0) {\r\n                    this.aViewports[j].terrainBox = new window.MapCore.SMcBox(-window.MapCore.DBL_MAX, -window.MapCore.DBL_MAX, 0, window.MapCore.DBL_MAX, window.MapCore.DBL_MAX, 0);\r\n                    for (let i = 0; i < aViewportLayers.length; ++i) {\r\n                        if (this.aViewports[j].bSetTerrainBoxByStaticLayerOnly && aViewportLayers[i].GetLayerType() != window.MapCore.IMcNativeStaticObjectsMapLayer.LAYER_TYPE) {\r\n                            continue;\r\n                        }\r\n\r\n                        if (!aViewportLayers[i].IsInitialized()) {\r\n                            this.aViewports[j].terrainBox = null;\r\n                            return;\r\n                        }\r\n\r\n                        let layerBox = aViewportLayers[i].GetBoundingBox();\r\n                        if (layerBox.MinVertex.x > this.aViewports[j].terrainBox.MinVertex.x) {\r\n                            this.aViewports[j].terrainBox.MinVertex.x = layerBox.MinVertex.x;\r\n                        }\r\n                        if (layerBox.MaxVertex.x < this.aViewports[j].terrainBox.MaxVertex.x) {\r\n                            this.aViewports[j].terrainBox.MaxVertex.x = layerBox.MaxVertex.x;\r\n                        }\r\n                        if (layerBox.MinVertex.y > this.aViewports[j].terrainBox.MinVertex.y) {\r\n                            this.aViewports[j].terrainBox.MinVertex.y = layerBox.MinVertex.y;\r\n                        }\r\n                        if (layerBox.MaxVertex.y < this.aViewports[j].terrainBox.MaxVertex.y) {\r\n                            this.aViewports[j].terrainBox.MaxVertex.y = layerBox.MaxVertex.y;\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    this.aViewports[j].terrainBox = new window.MapCore.SMcBox(0, 0, 0, 0, 0, 0);\r\n                }\r\n\r\n                this.aViewports[j].terrainCenter = window.MapCore.SMcVector3D((this.aViewports[j].terrainBox.MinVertex.x + this.aViewports[j].terrainBox.MaxVertex.x) / 2, (this.aViewports[j].terrainBox.MinVertex.y + this.aViewports[j].terrainBox.MaxVertex.y) / 2, 0);\r\n                this.aViewports[j].terrainCenter.z = 10000;\r\n            }\r\n\r\n            if (!this.aViewports[j].bCameraPositionSet) {\r\n                if (this.aViewports[j].viewport.GetMapType() == window.MapCore.IMcMapCamera.EMapType.EMT_2D) {\r\n                    this.aViewports[j].viewport.SetCameraPosition(this.aViewports[j].terrainCenter);\r\n                    this.aViewports[j].bCameraPositionSet = true;\r\n                }\r\n                else // 3D\r\n                {\r\n                    let height = {};\r\n                    this.aViewports[j].terrainCenter.z = 100;\r\n                    this.aViewports[j].viewport.SetCameraPosition(this.aViewports[j].terrainCenter);\r\n                    let params = new window.MapCore.IMcSpatialQueries.SQueryParams();\r\n                    params.eTerrainPrecision = window.MapCore.IMcSpatialQueries.EQueryPrecision.EQP_HIGH;\r\n                    this.aViewports[j].bCameraPositionSet = true;\r\n                    params.pAsyncQueryCallback = new this.CAsyncQueryCallback(this.aViewports[j]);\r\n                    this.aViewports[j].viewport.GetTerrainHeight(this.aViewports[j].terrainCenter, height, null, params); // async, wait for OnTerrainHeightResults()\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    resizeCanvases = () => {\r\n        if (this.aViewports.length == 0) {\r\n            return;\r\n        }\r\n\r\n        let CanvasesInRow, CanvasesInColumn;\r\n        if (!this.state.bSameCanvas) {\r\n            CanvasesInRow = Math.ceil(Math.sqrt(this.aViewports.length));\r\n            CanvasesInColumn = Math.ceil(this.aViewports.length / CanvasesInRow);\r\n        }\r\n        else {\r\n            CanvasesInRow = 1;\r\n            CanvasesInColumn = 1;\r\n        }\r\n        //todo: use this instead: document.getElementById('id').getBoundingClientRect()\r\n        //    let width =  (window.innerWidth - 40) / CanvasesInRow - 10;\r\n        //    let height = (window.innerHeight - 80) / CanvasesInColumn - 15;\r\n        let width = document.getElementById('canvasesContainer').getBoundingClientRect().width;\r\n        let height = document.getElementById('canvasesContainer').getBoundingClientRect().height;\r\n\r\n        for (let i = 0; i < this.aViewports.length; i++) {\r\n            this.aViewports[i].canvas.width = width;\r\n            this.aViewports[i].canvas.height = height;\r\n            this.aViewports[i].viewport.ViewportResized();\r\n        }\r\n    }\r\n\r\n    calcMinMaxHeights() {\r\n        let minHeight = 0;\r\n        let maxHeight = 700;\r\n        let fp = this.viewport.GetCameraFootprint();\r\n\r\n        if (fp.bUpperLeftFound && fp.bUpperRightFound && fp.bLowerRightFound && fp.bLowerLeftFound) {\r\n            let minPoint = {}, maxPoint = {};\r\n            if (this.viewport.GetExtremeHeightPointsInPolygon([fp.UpperLeft, fp.UpperRight, fp.LowerRight, fp.LowerLeft], maxPoint, minPoint)) {\r\n                minHeight = minPoint.Value.z;\r\n                maxHeight = maxPoint.Value.z;\r\n            }\r\n        }\r\n        return { minHeight, maxHeight };\r\n    }\r\n\r\n    // function switching DTM-visualization (height map) on/off\r\n    doDtmVisualization = () => {\r\n        if (!this.viewport.GetDtmVisualization()) {\r\n            let result = this.calcMinMaxHeights();\r\n            let DtmVisualization = new window.MapCore.IMcMapViewport.SDtmVisualizationParams();\r\n            window.MapCore.IMcMapViewport.SDtmVisualizationParams.SetDefaultHeightColors(DtmVisualization, result.minHeight, result.maxHeight);\r\n            DtmVisualization.bDtmVisualizationAboveRaster = true;\r\n            DtmVisualization.uHeightColorsTransparency = 120;\r\n            DtmVisualization.uShadingTransparency = 255;\r\n            this.viewport.SetDtmVisualization(true, DtmVisualization);\r\n        } else {\r\n            this.viewport.SetDtmVisualization(false);\r\n        }\r\n    }\r\n\r\n    mouseWheelHandler = e => {\r\n        let bHandled = {};\r\n        let eCursor = {};\r\n        let wheelDelta = - e.deltaY;\r\n        this.editMode.OnMouseEvent(window.MapCore.IMcEditMode.EMouseEvent.EME_MOUSE_WHEEL, window.MapCore.SMcPoint(0, 0), e.ctrlKey, wheelDelta, bHandled, eCursor);\r\n        if (bHandled.Value) {\r\n            return;\r\n        }\r\n\r\n        let factor = (e.shiftKey ? 10 : 1);\r\n\r\n        if (this.viewport.GetMapType() == window.MapCore.IMcMapCamera.EMapType.EMT_3D) {\r\n            this.viewport.MoveCameraRelativeToOrientation(window.MapCore.SMcVector3D(0, 0, wheelDelta / 8.0 * factor), true);\r\n        } else {\r\n            let fScale = this.viewport.GetCameraScale();\r\n            if (wheelDelta > 0) {\r\n                this.viewport.SetCameraScale(fScale / 1.25);\r\n            } else {\r\n                this.viewport.SetCameraScale(fScale * 1.25);\r\n            }\r\n\r\n            if (this.viewport.GetDtmVisualization()) {\r\n                this.doDtmVisualization();\r\n                this.doDtmVisualization();\r\n            }\r\n        }\r\n\r\n        e.preventDefault();\r\n        e.cancelBubble = true;\r\n        if (e.stopPropagation) e.stopPropagation();\r\n    }\r\n\r\n\r\n    mouseMoveHandler = (e, isTouch = false) => {\r\n        if (this.viewport.GetWindowHandle() != e.target) {\r\n            return;\r\n        }\r\n\r\n        let EventPixel = null;\r\n        if (isTouch) {\r\n            const rect = e.target.getBoundingClientRect();\r\n            const offsetX = e.targetTouches[0].pageX - rect.left;\r\n            const offsetY = e.targetTouches[0].pageY - rect.top;\r\n            EventPixel = window.MapCore.SMcPoint(offsetX, offsetY);\r\n        } else {\r\n            EventPixel = window.MapCore.SMcPoint(e.offsetX, e.offsetY);\r\n        }\r\n\r\n        if (e.buttons <= 1) {\r\n            let bHandled = {};\r\n            let eCursor = {};\r\n            this.editMode.OnMouseEvent((e.buttons == 1 || isTouch) ?\r\n                window.MapCore.IMcEditMode.EMouseEvent.EME_MOUSE_MOVED_BUTTON_DOWN :\r\n                window.MapCore.IMcEditMode.EMouseEvent.EME_MOUSE_MOVED_BUTTON_UP,\r\n                EventPixel,\r\n                e.ctrlKey,\r\n                0,\r\n                bHandled,\r\n                eCursor\r\n            );\r\n            if (bHandled.Value) {\r\n                e.preventDefault();\r\n                e.cancelBubble = true;\r\n                if (e.stopPropagation) e.stopPropagation();\r\n                return;\r\n            }\r\n        }\r\n\r\n        if (e.buttons == 1 || isTouch) {\r\n            if (this.nMousePrevX != 0) {\r\n                let factor = (e.shiftKey ? 10 : 1);\r\n                if (this.viewport.GetMapType() == window.MapCore.IMcMapCamera.EMapType.EMT_3D) {\r\n                    if (e.ctrlKey) {\r\n                        this.viewport.MoveCameraRelativeToOrientation(window.MapCore.SMcVector3D((this.nMousePrevX - EventPixel.x) / 2.0 * factor, - (this.nMousePrevY - EventPixel.y) / 2.0 * factor, 0), false);\r\n                    }\r\n                    else {\r\n                        this.viewport.RotateCameraRelativeToOrientation((this.nMousePrevX - EventPixel.x) / 2.0, - (this.nMousePrevY - EventPixel.y) / 2.0, 0);\r\n                    }\r\n                } else {\r\n                    if (e.ctrlKey) {\r\n                        this.viewport.SetCameraOrientation((this.nMousePrevX - EventPixel.x) / 2.0, window.MapCore.FLT_MAX, window.MapCore.FLT_MAX, true);\r\n                    }\r\n                    else {\r\n                        this.viewport.ScrollCamera((this.nMousePrevX - EventPixel.x) * factor, (this.nMousePrevY - EventPixel.y) * factor);\r\n                    }\r\n                }\r\n\r\n                e.preventDefault();\r\n                e.cancelBubble = true;\r\n                if (e.stopPropagation) e.stopPropagation();\r\n            }\r\n        }\r\n\r\n        this.nMousePrevX = EventPixel.x;\r\n        this.nMousePrevY = EventPixel.y;\r\n    }\r\n\r\n\r\n\r\n\r\n    mouseDownHandler = e => {\r\n        if (this.editMode.IsEditingActive()) {\r\n            // EditMode is active: don't change active viewport, but ignore click on non-active one\r\n            if (this.viewport.GetWindowHandle() != e.target) {\r\n                return;\r\n            }\r\n        } else if (!this.state.bSameCanvas) {\r\n            for (let i = 0; i < this.aViewports.length; i++) {\r\n                if (e.target == this.aViewports[i].viewport.GetWindowHandle()) {\r\n                    this.activeViewport = i;\r\n                    this.updateActiveViewport();\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        const rect = e.target.getBoundingClientRect();\r\n        let EventPixel = e.type == 'touchend' ?\r\n            window.MapCore.SMcPoint(e.changedTouches[0].pageX - rect.left, e.changedTouches[0].pageY - rect.top) :\r\n            window.MapCore.SMcPoint(e.offsetX, e.offsetY);\r\n\r\n        this.mouseDownButtons = e.buttons;\r\n        if (e.type == 'touchend' || e.buttons == 1) {\r\n            let bHandled = {};\r\n            let eCursor = {};\r\n            this.editMode.OnMouseEvent(window.MapCore.IMcEditMode.EMouseEvent.EME_BUTTON_PRESSED, EventPixel, e.ctrlKey, 0, bHandled, eCursor);\r\n\r\n            if (this.props.isPointSelectionMode) {\r\n                this.OnEditClickMissionPoint();\r\n            }\r\n            else if (!this.props.workingOrigin || !this.props.workingOrigin.coordinate) {\r\n                this.OnEditClickWorkingOrigin();\r\n            }\r\n\r\n\r\n            if (bHandled.Value) {\r\n                e.preventDefault();\r\n                e.cancelBubble = true;\r\n                if (e.stopPropagation) e.stopPropagation();\r\n                return;\r\n            }\r\n\r\n            this.nMousePrevX = EventPixel.x;\r\n            this.nMousePrevY = EventPixel.y;\r\n        }\r\n\r\n\r\n        e.preventDefault();\r\n        e.cancelBubble = true;\r\n        if (e.stopPropagation) e.stopPropagation();\r\n    }\r\n    mouseUpHandler = e => {\r\n        this.props.closeContextMenu();\r\n        if (this.viewport.GetWindowHandle() != e.target) {\r\n            return;\r\n        }\r\n\r\n        let EventPixel = window.MapCore.SMcPoint(e.offsetX, e.offsetY);\r\n        let buttons = this.mouseDownButtons & ~e.buttons;\r\n        if (buttons == 1) {\r\n            let bHandled = {};\r\n            let eCursor = {};\r\n            this.editMode.OnMouseEvent(window.MapCore.IMcEditMode.EMouseEvent.EME_BUTTON_RELEASED, EventPixel, e.ctrlKey, 0, bHandled, eCursor);\r\n            if (bHandled.Value) {\r\n                e.preventDefault();\r\n                e.cancelBubble = true;\r\n                if (e.stopPropagation) e.stopPropagation();\r\n                return;\r\n            }\r\n        }\r\n\r\n\r\n\r\n    }\r\n    mouseDblClickHandler = e => {\r\n        if (this.viewport.GetWindowHandle() != e.target) {\r\n            return;\r\n        }\r\n        let EventPixel = window.MapCore.SMcPoint(e.offsetX, e.offsetY);\r\n        let buttons = this.mouseDownButtons & ~e.buttons;\r\n        let aTargets = this.viewport.ScanInGeometry(new window.MapCore.SMcScanPointGeometry(window.MapCore.EMcPointCoordSystem.EPCS_SCREEN, window.MapCore.SMcVector3D(EventPixel.x, EventPixel.y, 0), 20), false);\r\n\r\n        if (this.bEdit) {\r\n            for (let i = 0; i < aTargets.length; ++i) {\r\n                if (aTargets[i].eTargetType == window.MapCore.IMcSpatialQueries.EIntersectionTargetType.EITT_OVERLAY_MANAGER_OBJECT) {\r\n                    if (this.bEdit) {\r\n                        this.editMode.StartEditObject(aTargets[i].ObjectItemData.pObject, aTargets[i].ObjectItemData.pItem);\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n            this.bEdit = false;\r\n            e.preventDefault();\r\n            e.cancelBubble = true;\r\n            if (e.stopPropagation) e.stopPropagation();\r\n            return;\r\n        }\r\n\r\n        if (buttons == 1) {\r\n            let bHandled = {};\r\n            let eCursor = {};\r\n            this.editMode.OnMouseEvent(window.MapCore.IMcEditMode.EMouseEvent.EME_BUTTON_DOUBLE_CLICK, EventPixel, e.ctrlKey, 0, bHandled, eCursor);\r\n            if (bHandled.Value) {\r\n                e.preventDefault();\r\n                e.cancelBubble = true;\r\n                if (e.stopPropagation) e.stopPropagation();\r\n                return;\r\n            }\r\n        }\r\n        for (let i = 0; i < aTargets.length; ++i) {\r\n            if (aTargets[i].eTargetType == window.MapCore.IMcSpatialQueries.EIntersectionTargetType.EITT_OVERLAY_MANAGER_OBJECT) {\r\n                const ID = aTargets[i].ObjectItemData.pObject.getID();\r\n                ID && this.props.showContextMenu(EventPixel.x + 5, EventPixel.y + 5, [{ name: ID == 0 ? \"Working Origin\" : \"WayPoint\" + ID }]);\r\n                break;\r\n            }\r\n        }\r\n\r\n\r\n    }\r\n\r\n    stopEvent = (e) => {\r\n        e.preventDefault();\r\n        e.cancelBubble = true;\r\n        e.stopPropagation && e.stopPropagation();\r\n    }\r\n\r\n    touchStartHandler = (e) => {\r\n        const rect = e.target.getBoundingClientRect();\r\n        this.nMousePrevX = this._onMouseDownX = e.targetTouches[0].pageX - rect.left;\r\n        this.nMousePrevY = this._onMouseDownY = e.targetTouches[0].pageY - rect.top;\r\n        //this.stopEvent(e);        \r\n    }\r\n\r\n    screenToWorld = (x, y, options) => {\r\n        const screenPoint = new window.MapCore.SMcVector3D(x, y, 0);\r\n        const worldPoint = {};\r\n        if (!this.viewport.ScreenToWorldOnTerrain(screenPoint, worldPoint)) {\r\n            this.viewport.ScreenToWorldOnPlane(screenPoint, worldPoint);\r\n        }\r\n        let ret = worldPoint;\r\n        if (!options || !options.withoutConvert) {\r\n            //   const worldPointGeo = this.gridConverter.ConvertAtoB(worldPoint.Value);\r\n            //   const worldPointGeoConverted = ConvertGEOPartial.geoPartialCoordsToGeoPartial(new geo.coordinate(worldPointGeo.x / DEG_TO_MC, worldPointGeo.y / DEG_TO_MC, worldPointGeo.z));\r\n            //   const worldPointGrid = worldPoint.Value;\r\n            //   ret = {worldPointGeo, worldPointGeoConverted, worldPointGrid};\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    worldToScreen = (coordinate, options) => {\r\n        let srcCoords = coordinate;\r\n        if (!options || !options.native) {\r\n            //srcCoords = this._transformCoordinateToNative(coordinate);\r\n        }\r\n        const screenPoint = this.viewport.WorldToScreen(srcCoords);\r\n        let inScreen = true;\r\n        if (screenPoint.x < 0 || screenPoint.x > this._canvas.width ||\r\n            screenPoint.y < 0 || screenPoint.y > this._canvas.height) {\r\n            inScreen = false;\r\n        }\r\n        return { x: screenPoint.x, y: screenPoint.y, inScreen };\r\n    }\r\n\r\n    moveCameraRelativeToOrientation = (moveX, moveY, ignorePitch = true, useHeightFactor = false) => {\r\n        let factor = 1;\r\n        if (useHeightFactor) {\r\n            const currentPosition = this.viewport.GetCameraPosition();\r\n            let height = {};\r\n            let heightDiff = Math.abs(currentPosition.z);\r\n            if (this.viewport.GetTerrainHeight(currentPosition, height)) {\r\n                heightDiff = currentPosition.z - height.Value;\r\n            }\r\n\r\n            //   if (this.moveCameraRelativeToOrientationFactor) {\r\n            //     const heightFactorNameToUse = useHeightFactor ? useHeightFactor : 'other';\r\n            //     const heightFactorToUse = this.moveCameraRelativeToOrientationFactor[heightFactorNameToUse];\r\n            //     if (heightFactorToUse) {              \r\n            //       for (let i = 0; i < heightFactorToUse.length; i++) {\r\n            //         if (!heightFactorToUse[i].max) {\r\n            //           factor = heightFactorToUse[i].factor;\r\n            //         }\r\n            //         if (heightDiff < heightFactorToUse[i].max) {\r\n            //           factor = heightFactorToUse[i].factor;\r\n            //           break;\r\n            //         }\r\n            //       }\r\n            //     }\r\n            //   }\r\n            // }\r\n\r\n            if (useHeightFactor === 'mouse') {\r\n                factor = 600;\r\n                if (heightDiff < 10) {\r\n                    factor = 1;\r\n                } else if (heightDiff < 30) {\r\n                    factor = 3;\r\n                } else if (heightDiff < 100) {\r\n                    factor = 6;\r\n                } else if (heightDiff < 200) {\r\n                    factor = 12;\r\n                } else if (heightDiff < 300) {\r\n                    factor = 20;\r\n                } else if (heightDiff < 500) {\r\n                    factor = 35;\r\n                } else if (heightDiff < 1000) {\r\n                    factor = 100;\r\n                } else if (heightDiff < 2000) {\r\n                    factor = 200;\r\n                } else if (heightDiff < 5000) {\r\n                    factor = 400;\r\n                }\r\n            } else if (useHeightFactor === 'touch') {\r\n                factor = 600;\r\n                if (heightDiff < 10) {\r\n                    factor = 2;\r\n                } else if (heightDiff < 30) {\r\n                    factor = 6;\r\n                } else if (heightDiff < 100) {\r\n                    factor = 9;\r\n                } else if (heightDiff < 200) {\r\n                    factor = 12;\r\n                } else if (heightDiff < 300) {\r\n                    factor = 20;\r\n                } else if (heightDiff < 500) {\r\n                    factor = 35;\r\n                } else if (heightDiff < 1000) {\r\n                    factor = 100;\r\n                } else if (heightDiff < 2000) {\r\n                    factor = 200;\r\n                } else if (heightDiff < 5000) {\r\n                    factor = 400;\r\n                }\r\n                factor *= 2;\r\n            } else {\r\n                factor = 150;\r\n                if (heightDiff < 10) {\r\n                    factor = 1;\r\n                } else if (heightDiff < 30) {\r\n                    factor = 4;\r\n                } else if (heightDiff < 100) {\r\n                    factor = 8;\r\n                } else if (heightDiff < 200) {\r\n                    factor = 12;\r\n                } else if (heightDiff < 300) {\r\n                    factor = 30;\r\n                } else if (heightDiff < 500) {\r\n                    factor = 50;\r\n                } else if (heightDiff < 1000) {\r\n                    factor = 100;\r\n                }\r\n            }\r\n        }\r\n        this.viewport.MoveCameraRelativeToOrientation(window.MapCore.SMcVector3D(moveX * factor, moveY * factor, 0), ignorePitch);\r\n    }\r\n\r\n    getCameraOrientation = () => {\r\n        let ret = { azimuth: 0, pitch: 0 };\r\n        const azimuthOrientation = {};\r\n        const pitchOrientation = {};\r\n        this.viewport.GetCameraOrientation(azimuthOrientation, pitchOrientation, null);\r\n        if (azimuthOrientation) {\r\n            ret.azimuth = azimuthOrientation.Value;\r\n        }\r\n        if (pitchOrientation) {\r\n            ret.pitch = pitchOrientation.Value;\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    setCameraOrientation = (cameraOrientationAzimuth, cameraOrientationPitch, stopDrag = true) => {\r\n        const azimuthOrientation = {};\r\n        const pitchOrientation = {};\r\n        const rollOrientation = {};\r\n        this.viewport.GetCameraOrientation(azimuthOrientation, pitchOrientation, rollOrientation);\r\n        const azimuthToSet = cameraOrientationAzimuth !== undefined ? cameraOrientationAzimuth : azimuthOrientation.Value;\r\n        const pitchToSet = cameraOrientationPitch !== undefined ? cameraOrientationPitch : pitchOrientation.Value;\r\n        this.viewport.SetCameraOrientation(azimuthToSet, pitchToSet, 0);\r\n    }\r\n\r\n    isGeoCoordValid = (coord, isNative = true) => {\r\n        const DEG_TO_MC = 100000;\r\n\r\n        let isValid = true;\r\n        const coordFactor = isNative ? DEG_TO_MC : 1;\r\n        if (coord.x < -180 * coordFactor || coord.y < -89.5 * coordFactor || coord.y === 0) {\r\n            isValid = false;\r\n        } else if (coord.x > 180 * coordFactor || coord.y > 89.5 * coordFactor || coord.z > Number.MAX_VALUE) {\r\n            isValid = false;\r\n        }\r\n        return isValid;\r\n    }\r\n\r\n    rotateCameraAroundWorldPoint = (coord, azimuthDelta, azimuthPitch, watchRoll) => {\r\n        const currentAzimuth = {};\r\n        const currentPitch = {};\r\n        const currentRoll = {};\r\n        let currentPosition;\r\n        if (watchRoll) {\r\n            this.viewport.GetCameraOrientation(currentAzimuth, currentPitch, currentRoll);\r\n            currentPosition = this.viewport.GetCameraPosition();\r\n        }\r\n\r\n        this.viewport.RotateCameraAroundWorldPoint(coord, azimuthDelta, azimuthPitch);\r\n\r\n        if (watchRoll) {\r\n            const newAzimuth = {};\r\n            const newPitch = {};\r\n            const newRoll = {};\r\n            this.viewport.GetCameraOrientation(newAzimuth, newPitch, newRoll);\r\n            if (Math.abs(newRoll.Value) === 180) {\r\n                this.viewport.SetCameraOrientation(currentAzimuth.Value, currentPitch.Value, currentRoll.Value, false);\r\n                this.viewport.SetCameraPosition(currentPosition);\r\n            } else {\r\n                //this.mapMngr.notifyGeneralEvent('maporientationchanged', newAzimuth.Value, this.elementId);\r\n            }\r\n        }\r\n    }\r\n\r\n    rotateCameraRelativeToOrientation = (moveX, moveY, factor) => {\r\n        this.viewport.RotateCameraRelativeToOrientation(moveX * factor, moveY * factor, 0);\r\n        const azimuthChange = {};\r\n        this.viewport.GetCameraOrientation(azimuthChange, null, null);\r\n        //this.mapMngr.notifyGeneralEvent('maporientationchanged', azimuthChange.Value, this.elementId);\r\n    }\r\n\r\n    getCameraScale = (convertToMeters = false) => {\r\n        let ret;\r\n        if (!this.state.is3DClicked) {\r\n            ret = this.viewport.GetCameraScale();\r\n            if (convertToMeters) {\r\n                ret /= this.viewport.GetPixelPhysicalHeight();\r\n                ret = (ret * 10).toFixed(2);\r\n                ret = parseInt(ret);\r\n            }\r\n        } else {\r\n            ret = this.viewport.GetCameraPosition().z;\r\n        }\r\n\r\n        return ret;\r\n    }\r\n    setCameraScale = (scale, factorFor3D = 1, notifyFpAndScale) => {\r\n        if (!this.state.is3DClicked) {\r\n            const mapScaleTopLimit = this.mapScaleTopLimit || 200000;\r\n            this.cameraScaleChanged = true;\r\n            const pixelPhysicalHeight = this.viewport.GetPixelPhysicalHeight();\r\n            const ratio = scale / pixelPhysicalHeight;\r\n            if (ratio < 25) {\r\n                scale = pixelPhysicalHeight * 25;\r\n            } else if (ratio > mapScaleTopLimit) {\r\n                scale = pixelPhysicalHeight * mapScaleTopLimit;\r\n            }\r\n            this.viewport.SetCameraScale(scale);\r\n        } else {\r\n            const camPosition = this.viewport.GetCameraPosition();\r\n            let zoomSign = 1;\r\n            if (scale > camPosition.z) {\r\n                zoomSign = -1;\r\n            }\r\n            const factor = factorFor3D * camPosition.z / 100;\r\n            this.viewport.MoveCameraRelativeToOrientation(window.MapCore.SMcVector3D(0, zoomSign * factor, 0), false);\r\n        }\r\n\r\n        // if (notifyFpAndScale) {\r\n        //   let fpToUpdate;\r\n        //   let scaleToUpdate;\r\n        //   if (!this.state.is3DClicked) {\r\n        //     // Notify scale change if needed (only in 2d viewport)\r\n        //     let currentScale = this.viewport.GetCameraScale() / this.viewport.GetPixelPhysicalHeight();\r\n        //     currentScale = (currentScale * 10).toFixed(2);\r\n        //     currentScale = parseInt(currentScale);\r\n\r\n        //     fpToUpdate = this.viewport.GetCameraFootprint();\r\n        //     scaleToUpdate = currentScale;\r\n        //   } else {\r\n        //     const footPrint = this.calculate3DFootPrint();\r\n        //     fpToUpdate = footPrint.fp;\r\n        //     scaleToUpdate = footPrint.scale;\r\n        //   }\r\n        //   if (fpToUpdate && fpToUpdate.bUpperLeftFound && fpToUpdate.bUpperRightFound &&\r\n        //     fpToUpdate.bLowerRightFound && fpToUpdate.bLowerLeftFound) {\r\n\r\n        //     this.notifyCameraMove(fpToUpdate, scaleToUpdate, this.elementId);\r\n        //   }\r\n        // }\r\n    }\r\n\r\n    updatePositionText = (x, y, z, updateHeight = true) => {\r\n        let height;\r\n        try {\r\n            //when updating position height displayed, use default precision\r\n            const heightForQuery = {};\r\n            const lonNew = (Math.abs(x) > 100000) ? x : x * 100000;\r\n            const latNew = (Math.abs(y) > 100000) ? y : y * 100000;\r\n            const positionToCheck = new window.MapCore.SMcVector3D(lonNew, latNew, 0);\r\n            if (this.viewport.GetTerrainHeight(positionToCheck, heightForQuery)) {\r\n                height = heightForQuery.Value;\r\n            }\r\n        } catch (exp) { }\r\n\r\n        // Update context with new height\r\n        if (updateHeight) {\r\n            this.lastUpdatedHeight = height;\r\n            console.log('mapheightchanged', height);\r\n        }\r\n\r\n        // Update context with new position\r\n        // const point = new geo.coordinate(x, y, height);\r\n        // this.lastPositionChanged = point;\r\n        // this.mapMngr.notifyGeneralEvent('mappositionchanged', point, this.elementId);\r\n    }\r\n\r\n    zoomIn = (amount, duration) => {\r\n        const currentScale = this.getCameraScale();\r\n        this.setCameraScale(currentScale / (amount || 1.5));\r\n        if (this.lastClickPos) {\r\n            this.updatePositionText(this.lastClickPos.x, this.lastClickPos.y, this.lastClickPos.z);\r\n        }\r\n    }\r\n\r\n    zoomOut = (amount, duration) => {\r\n        const currentScale = this.getCameraScale();\r\n        this.setCameraScale(currentScale * (amount || 1.5));\r\n        if (this.lastClickPos) {\r\n            this.updatePositionText(this.lastClickPos.x, this.lastClickPos.y, this.lastClickPos.z);\r\n        }\r\n    }\r\n\r\n    handleZoomOrRotate = e => {\r\n\r\n        const xDistance = e.touches[0].screenX - e.touches[1].screenX;\r\n        const yDistance = e.touches[0].screenY - e.touches[1].screenY;\r\n\r\n        const currentDistance = Math.abs((xDistance * xDistance) + (yDistance * yDistance));\r\n\r\n        if (!this.lastTouchDistance) {\r\n            this.lastTouchDistance = currentDistance;\r\n        } else {\r\n            const zoomIn = currentDistance - this.lastTouchDistance > 0;\r\n            const difDistance = Math.abs(currentDistance - this.lastTouchDistance);\r\n\r\n            // Calculate the average position(screen and geo) of the touches\r\n            const rect = e.target.getBoundingClientRect();\r\n\r\n            const firstTouchX = e.targetTouches[0].pageX - rect.left;\r\n            const firstTouchY = e.targetTouches[0].pageY - rect.top;\r\n\r\n            const secondTouchX = e.targetTouches[1].pageX - rect.left;\r\n            const secondTouchY = e.targetTouches[1].pageY - rect.top;\r\n\r\n            const averageX = (firstTouchX + secondTouchX) / 2;\r\n            const averageY = (firstTouchY + secondTouchY) / 2;\r\n\r\n            const averageWorldPosition = this.screenToWorld(averageX, averageY, { withoutConvert: true });\r\n\r\n            let prevAverageX;\r\n            let prevAverageY;\r\n\r\n            if (!this.pinchStatus) {\r\n                this.pinchStatus = { averageX, averageY, averageWorldPosition };\r\n            } else {\r\n                prevAverageX = this.pinchStatus.averageX;\r\n                prevAverageY = this.pinchStatus.averageY;\r\n\r\n                this.pinchStatus.averageX = averageX;\r\n                this.pinchStatus.averageY = averageY;\r\n            }\r\n\r\n            if (!this.state.is3DClicked) {\r\n                if (difDistance > 10000) {\r\n                    //The distance between the touches is big\\small enough for zooming in\\out.\r\n                    if (zoomIn) {\r\n                        this.zoomIn(1.05);\r\n                    } else {\r\n                        this.zoomOut(1.05);\r\n                    }\r\n                    this.lastTouchDistance = currentDistance;\r\n                }\r\n            } else if (!this.pinchStatus.coordToRotateAround3D) {\r\n                if (difDistance > 1000) {\r\n                    //The distance between the touches is big\\small enough for zooming in\\out.\r\n                    const zoomFactor = difDistance / 5000;\r\n                    if (zoomIn) {\r\n                        this.moveCameraRelativeToOrientation(0, zoomFactor, false, true);\r\n                    } else {\r\n                        this.moveCameraRelativeToOrientation(0, -zoomFactor, false, true);\r\n                    }\r\n                    this.lastTouchDistance = currentDistance;\r\n                    prevAverageX = undefined;\r\n                    prevAverageY = undefined;\r\n                    this.pinchStatus.zooming3D = true;\r\n                } else {\r\n                    this.pinchStatus.zooming3D = false;\r\n                }\r\n            }\r\n\r\n            if (!this.state.is3DClicked) {\r\n                // Calculating the angle between the touches for orientation setting\r\n                const currentRotation = Math.atan2(firstTouchY - secondTouchY, firstTouchX - secondTouchX) * 180 / Math.PI;\r\n                let difRotation = 0;\r\n                if (this.lastTouchRotation === undefined) {\r\n                    //first series of rotations\r\n                    this.lastTouchRotation = currentRotation;\r\n                } else {\r\n                    difRotation = Math.abs(currentRotation - this.lastTouchRotation);\r\n                    if (difRotation > 0.5) {\r\n                        const currentCameraOrientation = this.getCameraOrientation().azimuth;\r\n                        this.setCameraOrientation(currentCameraOrientation + this.lastTouchRotation - currentRotation);\r\n                        this.lastTouchRotation = currentRotation;\r\n                    }\r\n                }\r\n\r\n                if (this.pinchStatus) {\r\n                    // After zooming or changing orientation, set the map so the previous screen position with be placed on\r\n                    // the same geo position as it was before.\r\n                    const averageScreenAfterZoom = this.worldToScreen(this.pinchStatus.averageWorldPosition.Value, { native: true });\r\n                    const scrollX = averageScreenAfterZoom.x - this.pinchStatus.averageX;\r\n                    const scrollY = averageScreenAfterZoom.y - this.pinchStatus.averageY;\r\n                    try {\r\n                        this.viewport.ScrollCamera(scrollX, scrollY);\r\n                    } catch (exp) {\r\n                    }\r\n                }\r\n            } else {\r\n                //handle 3d rotating\r\n                if (prevAverageX || prevAverageY) {\r\n                    const currentRotation = Math.atan2(firstTouchY - secondTouchY, firstTouchX - secondTouchX) * 180 / Math.PI;\r\n                    let difRotation = 0;\r\n                    if (this.lastTouchRotation === undefined) {\r\n                        //first series of rotations\r\n                        this.lastTouchRotation = currentRotation;\r\n                    } else {\r\n                        difRotation = Math.abs(currentRotation - this.lastTouchRotation);\r\n                        if (!this.pinchStatus.zooming3D && (difRotation > 2.5 || this.pinchStatus.coordToRotateAround3D)) {\r\n                            this.pinchStatus.coordToRotateAround3D = this.pinchStatus.coordToRotateAround3D || averageWorldPosition.Value;\r\n                            const nativeCoord = this.pinchStatus.coordToRotateAround3D;\r\n                            if (this.isGeoCoordValid(nativeCoord)) {\r\n                                const rotateSign = Math.sign(this.lastTouchRotation - currentRotation);\r\n                                this.rotateCameraAroundWorldPoint(nativeCoord, rotateSign * 2, 0, true);\r\n                            }\r\n                        } else {\r\n                            this.cameraMoved = true;\r\n                            const offsetX = prevAverageX - this.pinchStatus.averageX;\r\n                            const offsetY = this.pinchStatus.averageY - prevAverageY;\r\n                            this.rotateCameraRelativeToOrientation(offsetX, offsetY, 0.1);\r\n                        }\r\n                        this.lastTouchRotation = currentRotation;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    touchMoveHandler = e => {\r\n        const isTouch = true;\r\n        if (e.touches.length === 1) {\r\n            this.mouseMoveHandler(e, isTouch);\r\n        } else {\r\n            this.handleZoomOrRotate(e);\r\n        }\r\n        e.preventDefault();\r\n    }\r\n\r\n    touchEndHandler = (e) => {\r\n        this.isTouch = false;\r\n        this.pinchStatus = undefined;\r\n        if (e.touches && e.touches.length) {\r\n            // Removing only one touch while there is more touches enabled\r\n            this.disableMoveAfterMultiTouches = true;\r\n            setTimeout(() => {\r\n                this.disableMoveAfterMultiTouches = false;\r\n            }, 200);\r\n        }\r\n        if (!e.touches.length) {\r\n            this.isMouseDown = false;\r\n            this.lastTouchDistance = 0;\r\n            this.lastTouchRotation = undefined;\r\n\r\n            // Cancel long click listening\r\n            //clearTimeout(longClick);\r\n            // Not in edit mode\r\n            this.dbclickHandled = true;\r\n\r\n            // canvas.clickCount++;\r\n            // if (canvas.clickCount === 1) {\r\n            //     singleClick = setTimeout(e => {\r\n            //     canvas.clickCount = 0;\r\n            //     this.onLeftClick(e) || this.stopEvent(e);\r\n            //     }, 200, e);\r\n            // } else if (canvas.clickCount === 2) {\r\n            //     clearTimeout(singleClick);\r\n            //     canvas.clickCount = 0;\r\n            //     this.onLeftDoubleClick(e);\r\n            // }\r\n        }\r\n\r\n        // if (this.props.isPointSelectionMode || !this.props.workingOrigin || !this.props.workingOrigin.coordinate) {\r\n        //     this.mouseDownHandler(e);\r\n        // }\r\n        e.preventDefault();\r\n        e.target.focus()\r\n    }\r\n\r\n    touchCancelHandler = (e) => { }\r\n\r\n    createViewport(terrain, eMapTypeToOpen) {\r\n        // create canvas if needed\r\n        let currCanvas;\r\n        if (!this.state.bSameCanvas || this.aViewports.length == 0) {\r\n            // create canvas\r\n            currCanvas = document.createElement('canvas');\r\n            //currCanvas.style.border = \"thick solid #FFFFFF\"; \r\n\r\n            currCanvas.addEventListener(\"wheel\", this.mouseWheelHandler, false);\r\n            currCanvas.addEventListener(\"mousemove\", this.mouseMoveHandler, false);\r\n            currCanvas.addEventListener(\"mousedown\", this.mouseDownHandler, false);\r\n            currCanvas.addEventListener(\"mouseup\", this.mouseUpHandler, false);\r\n            currCanvas.addEventListener(\"dblclick\", this.mouseDblClickHandler, false);\r\n\r\n            currCanvas.addEventListener(\"touchstart\", this.touchStartHandler, false);\r\n            currCanvas.addEventListener(\"touchend\", this.touchEndHandler, false);\r\n            currCanvas.addEventListener(\"touchend\", this.mouseDownHandler, false);\r\n            currCanvas.addEventListener(\"touchmove\", this.touchMoveHandler, false);\r\n            currCanvas.addEventListener(\"touchcancel\", this.touchCancelHandler, false);\r\n        }\r\n        else {\r\n            // use existing canvas\r\n            currCanvas = this.aViewports[0].canvas;\r\n        }\r\n\r\n        // create viewport\r\n        let layerGroup = this.state.mapLayerGroups.get(this.state.lastTerrainConfiguration);\r\n        let vpCreateData = new window.MapCore.IMcMapViewport.SCreateData(eMapTypeToOpen);\r\n        vpCreateData.pDevice = this.device;\r\n        vpCreateData.pCoordinateSystem = (terrain != null ? terrain.GetCoordinateSystem() : this.overlayManager.GetCoordinateSystemDefinition());\r\n        vpCreateData.pOverlayManager = this.overlayManager;\r\n        vpCreateData.hWnd = currCanvas;\r\n        if (layerGroup.bShowGeoInMetricProportion) {\r\n            vpCreateData.bShowGeoInMetricProportion = true;\r\n        }\r\n        this.viewport = window.MapCore.IMcMapViewport.Create(/*Camera*/null, vpCreateData, terrain != null ? [terrain] : null);\r\n        this.editMode = window.MapCore.IMcEditMode.Create(this.viewport);\r\n\r\n        // add camera-update callback\r\n        let callback = new this.CCameraUpdateCallback();\r\n        this.viewport.AddCameraUpdateCallback(callback);\r\n\r\n        if (this.viewport.GetMapType() == window.MapCore.IMcMapCamera.EMapType.EMT_3D) {\r\n            this.viewport.SetScreenSizeTerrainObjectsFactor(1.5);\r\n            this.viewport.SetCameraRelativeHeightLimits(3, 10000, true);\r\n        }\r\n        else {\r\n            this.viewport.SetStaticObjectsVisibilityMaxScale(50);\r\n            if (layerGroup.InitialScale2D) {\r\n                this.viewport.SetCameraScale(layerGroup.InitialScale2D);\r\n            }\r\n        }\r\n\r\n        this.viewport.SetBackgroundColor(window.MapCore.SMcBColor(70, 70, 70, 255));\r\n\r\n        // set object delays for optimazing rendering objects\r\n        this.viewport.SetObjectsDelay(window.MapCore.IMcMapViewport.EObjectDelayType.EODT_VIEWPORT_CHANGE_OBJECT_UPDATE, true, 50);\r\n        this.viewport.SetObjectsDelay(window.MapCore.IMcMapViewport.EObjectDelayType.EODT_VIEWPORT_CHANGE_OBJECT_CONDITION, true, 50);\r\n        this.viewport.SetObjectsDelay(window.MapCore.IMcMapViewport.EObjectDelayType.EODT_VIEWPORT_CHANGE_OBJECT_SIZE, true, 5);\r\n        this.viewport.SetObjectsDelay(window.MapCore.IMcMapViewport.EObjectDelayType.EODT_VIEWPORT_CHANGE_OBJECT_HEIGHT, true, 50);\r\n\r\n        // set objects movement threshold\r\n        this.viewport.SetObjectsMovementThreshold(1);\r\n\r\n        // set terrain cache\r\n        if (terrain != null) {\r\n            this.viewport.SetTerrainNumCacheTiles(terrain, false, 300);\r\n            this.viewport.SetTerrainNumCacheTiles(terrain, true, 300);\r\n        }\r\n\r\n        let viewportData = new SViewportData(this.viewport, this.editMode);\r\n        viewportData.terrain = terrain;\r\n        if (layerGroup.bSetTerrainBoxByStaticLayerOnly) {\r\n            viewportData.bSetTerrainBoxByStaticLayerOnly = true;\r\n        }\r\n\r\n        this.aViewports.push(viewportData);\r\n        const canvasParent = document.getElementById('canvasesContainer')\r\n        canvasParent.appendChild(currCanvas);\r\n        this.activeViewport = this.aViewports.length - 1;\r\n\r\n        this.updateActiveViewport();\r\n        this.resizeCanvases();\r\n        this.trySetTerainBox();\r\n    }\r\n\r\n    // function updating active viewport / Edit Mode and canvas borders\r\n    updateActiveViewport() {\r\n        if (this.activeViewport >= 0) {\r\n            for (let i = 0; i < this.aViewports.length; ++i) {\r\n                if (i == this.activeViewport) {\r\n                    this.viewport = this.aViewports[i].viewport;\r\n                    this.editMode = this.aViewports[i].editMode;\r\n                    if (!this.state.bSameCanvas) {\r\n                        //this.aViewports[i].canvas.style.borderColor = \"blue\";\r\n                    }\r\n                }\r\n                else {\r\n                    //this.aViewports[i].canvas.style.borderColor = \"white\";\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    doPrevViewport() {\r\n        if (this.aViewports.length > 1) {\r\n            this.activeViewport = (this.activeViewport + this.aViewports.length - 1) % this.aViewports.length;\r\n            this.updateActiveViewport();\r\n        }\r\n    }\r\n\r\n    doNextViewport() {\r\n        if (this.aViewports.length > 1) {\r\n            this.activeViewport = (this.activeViewport + 1) % this.aViewports.length;\r\n            this.updateActiveViewport();\r\n        }\r\n    }\r\n\r\n    // function creating terrain overlayManager and viewport, starting rendering\r\n    initializeViewports() {\r\n        let terrain = this.mapTerrains.get(this.state.lastTerrainConfiguration);\r\n        if (terrain == undefined) {\r\n            if (this.aLastTerrainLayers.length > 0) {\r\n                terrain = window.MapCore.IMcMapTerrain.Create(this.lastCoordSys, this.aLastTerrainLayers);\r\n                terrain.AddRef();\r\n            }\r\n            else {\r\n                terrain = null;\r\n            }\r\n            this.mapTerrains.set(this.state.lastTerrainConfiguration, terrain);\r\n        }\r\n\r\n        // create overlay manager\r\n        if (this.overlayManager == null) {\r\n            if (this.lastCoordSys == null) {\r\n                this.lastCoordSys = window.MapCore.IMcGridUTM.Create(36, window.MapCore.IMcGridCoordinateSystem.EDatumType.EDT_ED50_ISRAEL);\r\n                this.lastCoordSys.AddRef();\r\n            }\r\n            this.overlayManager = window.MapCore.IMcOverlayManager.Create(this.lastCoordSys);\r\n            this.overlayManager.AddRef();\r\n\r\n            // create overlay for objects\r\n            this.overlay = window.MapCore.IMcOverlay.Create(this.overlayManager);\r\n\r\n        }\r\n\r\n        // create map viewports\r\n        switch (this.state.lastViewportConfiguration) {\r\n            case \"2D/3D\":\r\n                this.createViewport(terrain, window.MapCore.IMcMapCamera.EMapType.EMT_2D);\r\n                this.createViewport(terrain, window.MapCore.IMcMapCamera.EMapType.EMT_3D);\r\n                this.DoPrevViewport();\r\n                break;\r\n            case \"3D/2D\":\r\n                if (this.state.bSameCanvas) {\r\n                    this.createViewport(terrain, window.MapCore.IMcMapCamera.EMapType.EMT_2D);\r\n                    this.createViewport(terrain, window.MapCore.IMcMapCamera.EMapType.EMT_3D);\r\n                }\r\n                else {\r\n                    this.createViewport(terrain, window.MapCore.IMcMapCamera.EMapType.EMT_3D);\r\n                    this.createViewport(terrain, window.MapCore.IMcMapCamera.EMapType.EMT_2D);\r\n                    this.doPrevViewport();\r\n                }\r\n                break;\r\n            case \"2D\":\r\n                this.createViewport(terrain, window.MapCore.IMcMapCamera.EMapType.EMT_2D);\r\n                break;\r\n            case \"3D\":\r\n                this.createViewport(terrain, window.MapCore.IMcMapCamera.EMapType.EMT_3D);\r\n                break;\r\n        }\r\n\r\n        // example of try-catch MapCoreError\r\n        try {\r\n            // MapCore API function call\r\n        }\r\n        catch (ex) {\r\n            if (ex instanceof window.MapCoreError) {\r\n                alert(\"MapCore Error #\" + ex.name + \": \" + ex.message);\r\n            }\r\n            else {\r\n                throw ex;\r\n            }\r\n        }\r\n\r\n        // ask the browser to render once\r\n        requestAnimationFrame(this.renderMapContinuously);\r\n    }\r\n\r\n    createMapLayersAndViewports() {\r\n        // if this terrain has not been created yet\r\n        if (this.mapTerrains.get(this.state.lastTerrainConfiguration) == undefined) {\r\n            this.aLastTerrainLayers = [];\r\n            let group = this.state.mapLayerGroups.get(this.state.lastTerrainConfiguration);\r\n            // create coordinate system by running a code string prepared during parsing configuration files (JSON configuration file and capabilities XML of MapCoreLayerServer)\r\n            // e.g. MapCore.IMcGridCoordSystemGeographic.Create(MapCore.IMcGridCoordinateSystem.EDatumType.EDT_WGS84)\r\n            this.lastCoordSys = eval(group.coordSystemString);\r\n\r\n            for (let i = 0; i < group.aLayerCreateStrings.length; ++i) {\r\n                // create map layer by running code string prepared during parsing configuration files (JSON configuration file and capabilities XML of MapCoreLayerServer)\r\n                // e.g. MapCore.IMcNativeRasterMapLayer.Create('http:Maps/Raster/SwissOrtho-GW') or CreateWMTSRasterLayer(...) or CreateWMSRasterLayer(...)\r\n                const layer = eval(group.aLayerCreateStrings[i]);\r\n                this.aLastTerrainLayers.push(layer);\r\n                if (layer instanceof window.MapCore.IMc3DModelMapLayer) {\r\n                    layer.SetDisplayingItemsAttachedToTerrain(true);\r\n                    layer.SetDisplayingDtmVisualization(true);\r\n                }\r\n            }\r\n            this.lastCoordSys.AddRef();\r\n        }\r\n\r\n        this.initializeViewports();\r\n    }\r\n\r\n    // async callGetCapabilitiesApi() {\r\n    //     try {\r\n    //         const response = await axios.get(config.urls.getCapabilities);\r\n    //         const capabilitiesXMLDoc =  new DOMParser().parseFromString(response.data, \"text/xml\");\r\n    //         this.parseCapabilitiesXML(capabilitiesXMLDoc, config.urls.getCapabilities);\r\n    //         this.openMap(this.context.mapToPreview.title);\r\n\r\n    //     } catch (e) {\r\n    //         \r\n    //     }\r\n    // }\r\n\r\n    async openMap(title, is3d) {\r\n        const serverUrl = externalConfig.getConfiguration().MAPCORE_LAYER_SERVER_URL;\r\n        if (serverUrl) {\r\n            try {\r\n                const response = await axios.get(serverUrl + config.urls.getCapabilities);\r\n                const capabilitiesXMLDoc = new DOMParser().parseFromString(response.data, \"text/xml\");\r\n                this.parseCapabilitiesXML(capabilitiesXMLDoc, config.urls.getCapabilities);\r\n            } catch (e) {\r\n            }\r\n        } else {\r\n            this.parseLayersConfiguration([this.props.mapToShow])\r\n        }\r\n\r\n\r\n        this.state.mapLayerGroups.forEach((value, key) => {\r\n            if (key === title) {\r\n\r\n                this.setState({\r\n                    lastTerrainConfiguration: key,\r\n                    lastViewportConfiguration: is3d ? \"3D\" : \"2D\"\r\n                }, () => {\r\n                    if (this.device === null) {\r\n                        // create map device (MapCore initialization)\r\n                        let init = new window.MapCore.IMcMapDevice.SInitParams();\r\n                        init.uNumTerrainTileRenderTargets = 100;\r\n\r\n                        const device = window.MapCore.IMcMapDevice.Create(init);\r\n                        device.AddRef();\r\n                        this.device = device;\r\n\r\n                        // create callback classes\r\n                        this.createCallbackClasses();\r\n                    }\r\n                    this.createMapLayersAndViewports();\r\n                });\r\n            }\r\n        })\r\n    }\r\n\r\n    doDtmVisualization() {\r\n        if (!this.viewport.GetDtmVisualization()) {\r\n            let result = this.calcMinMaxHeights();\r\n            let DtmVisualization = new window.MapCore.IMcMapViewport.SDtmVisualizationParams();\r\n            window.MapCore.IMcMapViewport.SDtmVisualizationParams.SetDefaultHeightColors(DtmVisualization, result.minHeight, result.maxHeight);\r\n            DtmVisualization.bDtmVisualizationAboveRaster = true;\r\n            DtmVisualization.uHeightColorsTransparency = 120;\r\n            DtmVisualization.uShadingTransparency = 255;\r\n            this.viewport.SetDtmVisualization(true, DtmVisualization);\r\n        }\r\n        else {\r\n            this.viewport.SetDtmVisualization(false);\r\n        }\r\n    }\r\n\r\n    // function closing active viewport\r\n    closeMap() {\r\n        if (this.activeViewport < 0) {\r\n            return;\r\n        }\r\n        // delete Edit Mode\r\n        this.editMode.Destroy();\r\n        // delete viewport\r\n        this.viewport.Release();\r\n        if (!this.bSameCanvas || this.aViewports.length == 1) {\r\n            // delete canvas\r\n            let currCanvas = this.aViewports[this.activeViewport].canvas;\r\n            currCanvas.removeEventListener(\"wheel\", this.mouseWheelHandler, false);\r\n            currCanvas.removeEventListener(\"mousemove\", this.mouseMoveHandler, false);\r\n            currCanvas.removeEventListener(\"mousedown\", this.mouseDownHandler, false);\r\n            currCanvas.removeEventListener(\"mouseup\", this.mouseUpHandler, false);\r\n            currCanvas.removeEventListener(\"dblclick\", this.mouseDblClickHandler, false);\r\n            currCanvas.removeEventListener(\"touchstart\", this.touchStartHandler, false);\r\n            currCanvas.removeEventListener(\"touchend\", this.touchEndHandler, false);\r\n            currCanvas.removeEventListener(\"touchmove\", this.touchMoveHandler, false);\r\n            currCanvas.removeEventListener(\"touchcancel\", this.touchCancelHandler, false);\r\n\r\n            let canvasParent = document.getElementById('canvasesContainer');\r\n            canvasParent.removeChild(this.aViewports[this.activeViewport].canvas);\r\n        }\r\n        // remove viewport from viewport data array\r\n        //this.activeViewport.viewport = this.activeViewport.viewport ? null :;\r\n        this.aViewports.splice(this.activeViewport, 1);\r\n        if (this.aViewports.length == 0) {\r\n            // no more viewports\r\n            this.viewport = null;\r\n            this.editMode = null;\r\n            this.activeViewport = -1;\r\n            // delete terrain\r\n            this.mapTerrains.forEach(terrain => { terrain.Release(); });\r\n            this.mapTerrains.clear();\r\n            // delete overlay manager\r\n            this.overlayManager.Release();\r\n            this.overlayManager = null;\r\n\r\n        }\r\n        else {\r\n            // there are viewports: update active viewport\r\n            if (this.activeViewport >= this.aViewports.length) {\r\n                this.activeViewport = this.aViewports.length - 1;\r\n            }\r\n            this.updateActiveViewport();\r\n            this.resizeCanvases();\r\n        }\r\n\r\n\r\n        this.setState({\r\n            mapLayerGroups: new Map(),\r\n            lastTerrainConfiguration: null,\r\n            lastViewportConfiguration: null /*  2D/3D, 3D/2D, 2D, 3D */,\r\n            bSameCanvas: true\r\n        });\r\n\r\n        this.mapTerrains = new Map;\r\n        this.device = null\r\n        this.viewportData = null;\r\n        this.aLastTerrainLayers = [];\r\n        this.lastCoordSys = null;\r\n        this.overlayManager = null;\r\n        this.activeViewport = -1;\r\n        this.aViewports = [];\r\n        this.lastRenderTime = (new Date).getTime();\r\n        this.lastMemUsageLogTime = (new Date).getTime();\r\n        this.uMemUsageLoggingFrequency = 0;\r\n        this.nMousePrevX = 0;\r\n        this.nMousePrevY = 0;\r\n        this.mouseDownButtons = 0;\r\n        this.bEdit = false;\r\n\r\n    }\r\n\r\n    renderLoadingMessage() {\r\n        return (\r\n            <div className={cn.LoadingMessage}>\r\n                Map core SDK is Loading...\r\n            </div>\r\n        )\r\n    }\r\n\r\n    renderRow(label, value) {\r\n        return (\r\n            <div className={cn.DescRow}>\r\n                <span className={cn.DescLabel}>{label}:</span>\r\n                <span className={cn.DescValue}>{value}</span>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    onSelectOtherMapClicked = () => {\r\n        this.setState({ isSwitchMapFormOpen: true });\r\n    }\r\n\r\n    showHideDtmActionClicked = () => {\r\n        this.setState({ isDTMClicked: !this.state.isDTMClicked }, this.doDtmVisualization)\r\n    }\r\n\r\n    showHide3DActionClicked = () => {\r\n        this.setState(\r\n            {\r\n                is3DClicked: !this.state.is3DClicked\r\n            }, () => this.openMap(this.props.mapToShow.groupName, this.state.is3DClicked))\r\n    }\r\n    setTempAngle = (value) => {\r\n        this.TempOriginAngle = value;\r\n    }\r\n\r\n    setOriginAngle = () => {\r\n        const popupDetails = {\r\n            title: 'Set Origin Angle',\r\n            modalChild: 'SingleInputForm',\r\n            modalChildProps: {\r\n                size: 'small',\r\n                label: 'Set Angle(degrees ,North = 0):',\r\n                defaultValue: 0,\r\n                onValueChange: this.setTempAngle\r\n            },\r\n            onCloseButtonClick: () => {\r\n            },\r\n            primayButton: {\r\n                title: 'Set Origin',\r\n                callback: this.SetWorkingOrigin()\r\n            },\r\n            secondaryButton: {\r\n                title: 'Cancel',\r\n                callback: () => this.setTempAngle(0)\r\n            }\r\n        };\r\n        this.props.showPopup(popupDetails);\r\n    }\r\n\r\n    onMoreActionsClick = (e) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n\r\n        const selectOtherMapAction = {\r\n            name: \"Select Other Map\",\r\n            func: this.onSelectOtherMapClicked,\r\n            iconCss: \"Map\"\r\n        };\r\n\r\n        const menuItemsList = [];\r\n\r\n        const dtmLayer = this.props.mapToShow.layers.find(layer => layer.type.toLowerCase().includes('dtm'));\r\n\r\n        if (true) {\r\n            const showHideDtmAction = {\r\n                name: (this.state.isDTMClicked ? 'Hide' : 'Show') + \" DTM visualization\",\r\n                func: () => this.showHideDtmActionClicked(),\r\n                iconCss: \"DTM\"\r\n            }\r\n            const selectOrigin = {\r\n                name: \"Select Origin\",\r\n                func: () => this.setOriginAngle(),\r\n                iconCss: \"AddMapLocation\"\r\n            }\r\n            const showHide3DAction = {\r\n                name: 'Switch To ' + (this.state.is3DClicked ? '2D' : '3D'),\r\n                func: this.showHide3DActionClicked,\r\n                iconCss: \"ThreeD\"\r\n            }\r\n\r\n            menuItemsList.push(showHideDtmAction);\r\n            menuItemsList.push(showHide3DAction);\r\n            menuItemsList.push(selectOrigin);\r\n            menuItemsList.push(selectOtherMapAction);\r\n        }\r\n\r\n        this.props.showContextMenu(e.nativeEvent.x, e.nativeEvent.y, menuItemsList);\r\n    }\r\n\r\n    renderMapToolbox() {\r\n        return (\r\n            <div className={`${cn.MapToolbox}`}>\r\n                <div className={cn.Description}>\r\n                    {this.props.mapToShow.groupName}\r\n                </div>\r\n                <span className={cn.MoreActionsBtn} onClick={this.onMoreActionsClick}></span>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    renderSwitchMapForm() {\r\n        const isOpenClass = this.state.isSwitchMapFormOpen ? cn.Open : '';\r\n        return (\r\n            <div className={`${cn.SwitchMapForm} ${isOpenClass}`}>\r\n                {isOpenClass ? <SwitchMapForm onCancel={() => this.setState({ isSwitchMapFormOpen: false })} /> : null}\r\n            </div>\r\n        )\r\n    }\r\n\r\n    getCanvas() {\r\n        let zIndex = this.props.isPointSelectionMode ? { zIndex: 100, width: \"100%\" } : {};\r\n\r\n        return (\r\n            <div className={cn.MapWrapper} style={zIndex}>\r\n                <div className={cn.CanvasContainer} id='canvasesContainer'></div>\r\n                {this.renderMapToolbox()}\r\n                {this.renderSwitchMapForm()}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className={cn.Wrapper}>\r\n                {this.props.isMapCoreSDKLoaded ? this.getCanvas() : this.renderLoadingMessage()}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        isMapCoreSDKLoaded: state.map.isMapCoreSDKLoaded,\r\n        mapToShow: state.map.mapToShow,\r\n        dronePositionOffset: state.map.dronePositionOffset,\r\n        workingOrigin: state.map.workingOrigin,\r\n        isPointSelectionMode: state.layout.isPointSelectionMode,\r\n        enemyPositionOffset: state.map.enemyPositionOffset,\r\n    };\r\n};\r\n\r\nconst mapDispachToProps = (dispatch) => {\r\n    return {\r\n        showContextMenu: (x, y, items) => dispatch({ type: actionTypes.SHOW_CONTEXT_MENU, payload: { x, y, items } }),\r\n        closeContextMenu: () => dispatch({ type: actionTypes.CLOSE_CONTEXT_MENU }),\r\n        subscribeToDroneData: () => dispatch(actions.subscribeToDroneData()),\r\n        showPopup: details => dispatch({ type: actionTypes.SHOW_POPUP, payload: details }),\r\n        saveOriginCoordinate: (coordinate, angle) => dispatch({ type: actionTypes.SAVE_ORIGIN_COORDINATE, payload: { coordinate, angle } }),\r\n        saveDroneLastCoordinate: (lastPosition) => dispatch({ type: actionTypes.SAVE_DRONE_LAST_POSITION, payload: { lastPosition } }),\r\n        togglePointSelectionMode: () => dispatch({ type: actionTypes.TOGGLE_POINT_SELECTION_MODE }),\r\n        selectPointFromMap: (pointFromMap) => dispatch({ type: actionTypes.SELECT_POINT_FROM_MAP, payload: { pointFromMap } }),\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispachToProps)(MapContainer);","import React, {Component} from 'react';\r\nimport cn from './RadioGroup.module.css';\r\n\r\nexport default class RadioGroup extends Component {\r\n\r\n    render() {\r\n        return (            \r\n            <div className={cn.Wrapper}>\r\n                {this.props.label ? <legend className={cn.Label}>{this.props.label}</legend> : null}\r\n                <div className={cn.RadioGroupValuesWrapper}>\r\n                    {\r\n                        this.props.children.map((child, i) => \r\n                            React.cloneElement(child, {\r\n                                key: i,\r\n                                onClick: () => child.props.onClick(i),\r\n                                isChecked: child.props.isChecked,\r\n                                radioIndex: i\r\n                            })\r\n                        )\r\n                    }\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import React, { Component } from 'react'\nimport cn from './Radio.module.css';\n\nexport default class Radio extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n          isChecked: this.props.isChecked\n        };\n\n        this.onRadioClick = this.onRadioClick.bind(this); \n    }\n\n    componentWillReceiveProps(newProps) {\n        this.setState({isChecked: newProps.isChecked});\n    }\n\n    onRadioClick(e) {\n        if (e) {\n            e.preventDefault();\n        }\n        this.setState({isChecked: !this.state.isChecked});        \n        if (this.props.onClick) {\n            this.props.onClick(this.props.radioIndex);\n        }\n    }    \n\n    render() {\n        return (\n            <label htmlFor={this.props.id} className={cn.radio} onClick={this.onRadioClick}>\n                <input className={cn.radio__input} type=\"radio\" id={this.props.id} checked={this.props.isChecked} readOnly/>\n                <div className={cn.radio__radio}></div>\n                <span className={cn.Label} title={this.props.label}>{this.props.label}</span>\n            </label>\n        )\n    }\n}","import React, { Component } from 'react'\r\nimport cn from './SwitchMapForm.module.css';\r\nimport actionTypes from '../../store/actions/actionTypes';\r\nimport { connect } from 'react-redux';\r\nimport externalConfig from '../../ExternalConfigurationHandler';\r\nimport RadioGroup from '../controls/RadioGroup/RadioGroup';\r\nimport Radio from '../controls/Radio/Radio';\r\n\r\nclass SwitchMapForm extends Component {\r\n    state = {\r\n        isShown: false,\r\n        selectedGroup: this.props.currentShownMap\r\n    }\r\n\r\n    renderHeader() {\r\n        return (\r\n            <div className={cn.Header}>\r\n                Select Map to Show:\r\n            </div>\r\n        )\r\n    }\r\n\r\n    componentDidMount() {\r\n        setTimeout(() => this.setState({isShown: true}), 300)\r\n    }\r\n\r\n    selectMapRadioButton(selectedGroup) {\r\n        this.setState({\r\n            selectedGroup\r\n            })\r\n    }\r\n\r\n    renderBody() {\r\n        const layers = externalConfig.getConfiguration().streamingLayers;        \r\n\r\n        return (\r\n            <div className={cn.Body}>\r\n                <RadioGroup>\r\n                    {layers.map((item, i) => {\r\n                        return (\r\n                            <Radio\r\n                                key={i}\r\n                                id={item.groupName}\r\n                                isChecked={item.groupName === this.state.selectedGroup.groupName}\r\n                                label={item.groupName}\r\n                                onClick={() => this.selectMapRadioButton(item)} />\r\n                        )\r\n                    })}\r\n                </RadioGroup>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    onMapSelection = () => {\r\n        if (this.state.selectedGroup.groupName !== this.props.currentShownMap.groupName) {\r\n\r\n            this.props.setMapToShow(this.state.selectedGroup);            \r\n        }\r\n        this.props.onCancel()\r\n    }\r\n\r\n    renderFooter() {\r\n        return (\r\n            <div className={cn.Footer}>\r\n                <button className={`${cn.Button} ${cn.Apply}`} onClick={this.onMapSelection}>Select</button>\r\n                <button className={`${cn.Button}`} onClick={this.props.onCancel}>Cancel</button>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    render() {\r\n        const isShownClass = this.state.isShown ? cn.Shown : '';\r\n        return (\r\n            <div className={`${cn.Wrapper} ${isShownClass}`}>\r\n                {this.renderHeader()}\r\n                {this.renderBody()}\r\n                {this.renderFooter()}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {      \r\n      currentShownMap: state.map.mapToShow,\r\n    }\r\n  };\r\n\r\nconst mapDispachToProps = (dispatch) => {\r\n    return {        \r\n        setMapToShow: groupNode => dispatch({type: actionTypes.SET_MAP_TO_SHOW, payload: groupNode})\r\n    };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispachToProps)(SwitchMapForm);"],"sourceRoot":""}