(this.webpackJsonpwasp=this.webpackJsonpwasp||[]).push([[0],[,,function(e,t,a){"use strict";t.a={PAUSE_VIDEO:"PAUSE_VIDEO",RESUME_VIDEO:"RESUME_VIDEO",LOACTE_START:"LOACTE_START",LOACTE_SUCCESS:"LOACTE_SUCCESS",LOACTE_FAILED:"LOACTE_FAILED",RESET_START:"RESET_START",RESET_SUCCESS:"RESET_SUCCESS",RESET_FAILED:"RESET_FAILED",TAKE_OFF_START:"TAKE_OFF_START",TAKE_OFF_SUCCESS:"TAKE_OFF_SUCCESS",TAKE_OFF_FAILED:"TAKE_OFF_FAILED",GO_TO_LOCATION_START:"GO_TO_LOCATION_START",GO_TO_LOCATION_SUCCESS:"GO_TO_LOCATION_SUCCESS",GO_TO_LOCATION_FAILED:"GO_TO_LOCATION_FAILED",POINT_ON_VIDEO_IMAGE_START:"POINT_ON_VIDEO_IMAGE_START",POINT_ON_VIDEO_IMAGE_SUCCESS:"POINT_ON_VIDEO_IMAGE_SUCCESS",POINT_ON_VIDEO_IMAGE_FAILED:"POINT_ON_VIDEO_IMAGE_FAILED",ROSS_WEBSOCKET_CONNECTION_SUCCESS:"ROSS_WEBSOCKET_CONNECTION_SUCCESS",ROSS_WEBSOCKET_CONNECTION_FAILED:"ROSS_WEBSOCKET_CONNECTION_FAILED",ROSS_WEBSOCKET_CONNECTION_CLOSED:"ROSS_WEBSOCKET_CONNECTION_CLOSED",ROSS_WEBSOCKET_CONNECTION_START:"ROSS_WEBSOCKET_CONNECTION_START",SHOW_GLOBAL_MESSAGE:"SHOW_GLOBAL_MESSAGE",REMOVE_GLOBAL_MESSAGE:"REMOVE_GLOBAL_MESSAGE",SHOW_CONTEXT_MENU:"SHOW_CONTEXT_MENU",CLOSE_CONTEXT_MENU:"CLOSE_CONTEXT_MENU",SHOW_POPUP:"SHOW_POPUP",HIDE_POPUP:"HIDE_POPUP",IMAGE_SENT_TO_DRONE:"IMAGE_SENT_TO_DRONE",SET_MAPCORE_SDK_LOADED_FLAG:"SET_MAPCORE_SDK_LOADED_FLAG",SET_MAP_TO_SHOW:"SET_MAP_TO_SHOW"}},,,,,,function(e,t,a){e.exports={App:"App_App__2MYUV",AppHeader:"App_AppHeader__1xvWo",ActionsBar:"App_ActionsBar__1-3sb",ActionButtons:"App_ActionButtons__2XLp0",HeaderElementWrapper:"App_HeaderElementWrapper__3Ln3v",ExportBtn:"App_ExportBtn__1_50o",Disabled:"App_Disabled__167iO",MainContentWrapper:"App_MainContentWrapper__iWHEE",Split:"App_Split__2AQzf",Left:"App_Left__11yLJ",Right:"App_Right__3odZu",FileInput:"App_FileInput__yXj1g",RightHeader:"App_RightHeader__lBHCr",RightPaneWrapper:"App_RightPaneWrapper__GdZ8C",RightPaneWrapperItem:"App_RightPaneWrapperItem__3hpNT",HeaderLeftWrapper:"App_HeaderLeftWrapper__2DRfD",HeaderItem:"App_HeaderItem__2k6ih",Icon:"App_Icon__1ISa_",GpsIcon:"App_GpsIcon__344rr",PositionIcon:"App_PositionIcon__3uphK",WifiIcon:"App_WifiIcon__1vv25",BatteryIcon:"App_BatteryIcon__3IUe3",BatteryValue:"App_BatteryValue__OgmLs",LongLatWrapper:"App_LongLatWrapper__DPdKR",lonLatLabel:"App_lonLatLabel__3OOut",lonLatValue:"App_lonLatValue__1QMuS"}},function(e,t,a){"use strict";a.d(t,"b",(function(){return n}));var n={success:"success",info:"info",warn:"warn",error:"error"};t.a={urls:{getCapabilities:"/map/opr?service=wmts&request=GetCapabilities",configuration:"configuration.json",stream:"/stream?topic=/d415/color/image_raw",snapshot:"/snapshot?topic=/d415/color/image_raw"}}},,function(e,t,a){e.exports={Wrapper:"ActionButtons_Wrapper__1mPEv",Hidden:"ActionButtons_Hidden__1l-WC",Button:"ActionButtons_Button__2CLMN",ButtonLabel:"ActionButtons_ButtonLabel__Q5BU4",Icon:"ActionButtons_Icon__1I2FB",LocateIcon:"ActionButtons_LocateIcon__3VFcz",PauseIcon:"ActionButtons_PauseIcon__f4FlW",ResetIcon:"ActionButtons_ResetIcon__pS4kF",TakeoffIcon:"ActionButtons_TakeoffIcon__3l9wl",SetLocationIcon:"ActionButtons_SetLocationIcon__2DguE",PlayIcon:"ActionButtons_PlayIcon__1HkND"}},function(e,t,a){e.exports={Wrapper:"Video_Wrapper__3_xdH",FullHeight:"Video_FullHeight__2AqGh",VideoImage:"Video_VideoImage___DQkT",ErrorIcon:"Video_ErrorIcon__1NO6w",ErrorMessage:"Video_ErrorMessage__27FPM",VideoHeader:"Video_VideoHeader__2tu2v",Description:"Video_Description__1KJN3",MoreActionsBtn:"Video_MoreActionsBtn__3mUWP",VideoFooter:"Video_VideoFooter__orMJZ",ControlBtn:"Video_ControlBtn__3Zwp3",Play:"Video_Play__DQHdm",Pause:"Video_Pause__4ESNC",FullScreen:"Video_FullScreen__1xHB8",ExitFullScreen:"Video_ExitFullScreen__SfbP2",StreamingIconWrapper:"Video_StreamingIconWrapper__3cVbX",StreamingIcon:"Video_StreamingIcon__1HmJq",Footer:"Video_Footer__K-0xF",TargetIcon:"Video_TargetIcon__1tkze",TargetLarge:"Video_TargetLarge__3R4SP"}},function(e,t,a){e.exports={h2:"Popup_h2__sBm9G",Overlay:"Popup_Overlay__Lz1tD",Popup:"Popup_Popup__1O31A",PopupHeaderWrapper:"Popup_PopupHeaderWrapper__2-ikc",PopupBody:"Popup_PopupBody__1kaHU",NoBodyOverFlow:"Popup_NoBodyOverFlow__stG_q",PopupFooter:"Popup_PopupFooter__2ofpz",closeBtn:"Popup_closeBtn__30DBN",FormButton:"Popup_FormButton__32S7X",Apply:"Popup_Apply__1uDlX",small:"Popup_small__3mJFK",medium:"Popup_medium__3X6Sz"}},,,function(e,t,a){e.exports={Wrapper:"MapContainer_Wrapper__27nRY",LoadingMessage:"MapContainer_LoadingMessage__1xCqh",CanvasContainer:"MapContainer_CanvasContainer__20Pvi",MapWrapper:"MapContainer_MapWrapper__3N3n0",MapToolbox:"MapContainer_MapToolbox__3Rx7F",Active:"MapContainer_Active__2ss1F",DescRow:"MapContainer_DescRow__27Z_D",DescValue:"MapContainer_DescValue__3qrq3",DescLabel:"MapContainer_DescLabel__1TYDX",Description:"MapContainer_Description__1R00O",MoreActionsBtn:"MapContainer_MoreActionsBtn__1Cfu0",SwitchMapForm:"MapContainer_SwitchMapForm__n0MuY",Open:"MapContainer_Open__3Z8xb"}},function(e,t,a){"use strict";var n=a(4),o=a(5),r=function(){function e(){Object(n.a)(this,e),this.externalConfigurationHandler=null}return Object(o.a)(e,[{key:"setConfiguration",value:function(e){this.externalConfigurationHandler=e}},{key:"getConfiguration",value:function(){return this.externalConfigurationHandler}}]),e}();t.a=new r},function(e,t,a){e.exports={Row:"Input_Row__1NNGu",Label:"Input_Label__1KIpZ",Mandatory:"Input_Mandatory__Csafp",InputWrapper:"Input_InputWrapper__3rekC",InnerInputWrapper:"Input_InnerInputWrapper__2jecR",Input:"Input_Input__1fSUH",ShowError:"Input_ShowError__2VsCB",ValidationMessage:"Input_ValidationMessage__1uZKf",ValidationImg:"Input_ValidationImg__39nK6",readOnly:"Input_readOnly__AIrNX",InfoImage:"Input_InfoImage__3foYR"}},,,function(e,t,a){e.exports={Overlay:"LoaderAlt_Overlay__LWfL-",loader:"LoaderAlt_loader__KVfO9",circle:"LoaderAlt_circle__UO9vV",orbit:"LoaderAlt_orbit__3_lP3"}},function(e,t,a){e.exports={Wrapper:"SwitchMapForm_Wrapper__3fcmS",Shown:"SwitchMapForm_Shown__2trJI",Header:"SwitchMapForm_Header__1_mVj",Button:"SwitchMapForm_Button__3hFUc",Body:"SwitchMapForm_Body__vXUfe",Apply:"SwitchMapForm_Apply__eGSYf"}},,,function(e,t,a){e.exports={Wrapper:"OutputTabs_Wrapper__3h3zv",NoOutput:"OutputTabs_NoOutput__18v6J",ErrorIcon:"OutputTabs_ErrorIcon__1TffL",ErrorMessage:"OutputTabs_ErrorMessage__2FCCV",Tabs:"OutputTabs_Tabs__1CsMR",OutputImage:"OutputTabs_OutputImage__bD7e6",Point:"OutputTabs_Point__1oY6q"}},function(e,t,a){e.exports={contextMenu:"ContextMenu_contextMenu__MMd4N",contextMenuUL:"ContextMenu_contextMenuUL__3Yh4L",Close:"ContextMenu_Close__1BtwG",menuItem:"ContextMenu_menuItem__3HJ_U",ContextMenuIcon:"ContextMenu_ContextMenuIcon__3-yE-",Map:"ContextMenu_Map__2Avr5",DTM:"ContextMenu_DTM__1xP1w",ThreeD:"ContextMenu_ThreeD__lnfDB"}},function(e,t,a){e.exports={Wrapper:"FlightTelemetry_Wrapper__1YU2B",TelemetryWrapper:"FlightTelemetry_TelemetryWrapper__3YYPy",Units:"FlightTelemetry_Units__1X8hg"}},,function(e,t,a){e.exports={radio:"Radio_radio__136cS",radio__input:"Radio_radio__input__2tbGY",radio__radio:"Radio_radio__radio__2qGca",Label:"Radio_Label__1vODM"}},,,function(e,t,a){e.exports={Wrapper:"RadioGroup_Wrapper__2Pegb",Label:"RadioGroup_Label__2BNfU",RadioGroupValuesWrapper:"RadioGroup_RadioGroupValuesWrapper__f04fD"}},function(e,t,a){e.exports={Wrapper:"GlobalMessage_Wrapper__3NoLn",Icon:"GlobalMessage_Icon__3y1Zz",Text:"GlobalMessage_Text__idHn3"}},,,function(e,t,a){e.exports={DateTime:"Clock_DateTime__12uDK",Hour:"Clock_Hour__2Hud3"}},,,,,,,,,,,function(e,t,a){},,function(e,t,a){e.exports={Wrapper:"Error_Wrapper__3jA9K"}},function(module,__webpack_exports__,__webpack_require__){"use strict";var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__),C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(14),C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__),C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(24),C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(19),C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5),C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(7),C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(6),C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(4),react__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_8__),_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(16),_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9__),axios__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(20),axios__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_10__),_config__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(9),react_redux__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(10),_ExternalConfigurationHandler__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(17),_store_actions_actionTypes__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(2),_SwitchMapForm_SwitchMapForm__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(53),SLayerGroup=function e(t,a,n,o){Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_7__.a)(this,e),this.aLayerCreateStrings=[],this.coordSystemString=t,this.bShowGeoInMetricProportion=a,this.bSetTerrainBoxByStaticLayerOnly=n,this.InitialScale2D=o},SViewportData=function e(t,a){Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_7__.a)(this,e),this.viewport=t,this.editMode=a,this.canvas=t.GetWindowHandle();var n=t.GetTerrains();this.aLayers=null!=n&&n.length>0?n[0].GetLayers():null,this.terrainBox=null,this.terrainCenter=null,this.rotationCenter=null,this.bCameraPositionSet=!1,this.bSetTerrainBoxByStaticLayerOnly=!1},MapContainer=function(_PureComponent){Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_5__.a)(MapContainer,_PureComponent);var _super=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_6__.a)(MapContainer);function MapContainer(){var e;Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_7__.a)(this,MapContainer);for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return(e=_super.call.apply(_super,[this].concat(a))).state={mapLayerGroups:new Map,lastTerrainConfiguration:null,lastViewportConfiguration:null,bSameCanvas:!0,isDTMClicked:!1,is3DClicked:!1,isSwitchMapFormOpen:!1},e.mapTerrains=new Map,e.device=null,e.viewportData=null,e.uCameraUpdateCounter=0,e.aLastTerrainLayers=[],e.lastCoordSys=null,e.overlayManager=null,e.activeViewport=-1,e.aViewports=[],e.lastRenderTime=(new Date).getTime(),e.lastMemUsageLogTime=(new Date).getTime(),e.uMemUsageLoggingFrequency=0,e.nMousePrevX=0,e.nMousePrevY=0,e.mouseDownButtons=0,e.bEdit=!1,e.layerCallback=null,e.requestAnimationFrameId=-1,e.renderMapContinuously=function(){if(e.requestAnimationFrameId){e.trySetTerainBox();var t=(new Date).getTime();if(e.state.bSameCanvas?null!=e.viewport&&e.viewport.Render():window.MapCore.IMcMapViewport.RenderAll(),e.doMoveObjects(),e.lastRenderTime=t,0!=e.uMemUsageLoggingFrequency&&t>=e.lastMemUsageLogTime+1e3*e.uMemUsageLoggingFrequency){window.MapCore.IMcMapDevice.GetMaxMemoryUsage();console.log("Max mem = "+window.MapCore.IMcMapDevice.GetMaxMemoryUsage().toLocaleString()+", heap = "+window.MapCore.IMcMapDevice.GetHeapSize().toLocaleString()+" B"),e.lastMemUsageLogTime=t}e.requestAnimationFrameId=requestAnimationFrame(e.renderMapContinuously)}},e.trySetTerainBox=function(){for(var t=0;t<e.aViewports.length;t++){if(null==e.aViewports[t].terrainBox){var a=e.aViewports[t].aLayers;if(0!=a.length){e.aViewports[t].terrainBox=new window.MapCore.SMcBox(-window.MapCore.DBL_MAX,-window.MapCore.DBL_MAX,0,window.MapCore.DBL_MAX,window.MapCore.DBL_MAX,0);for(var n=0;n<a.length;++n)if(!e.aViewports[t].bSetTerrainBoxByStaticLayerOnly||a[n].GetLayerType()==window.MapCore.IMcNativeStaticObjectsMapLayer.LAYER_TYPE){if(!a[n].IsInitialized())return void(e.aViewports[t].terrainBox=null);var o=a[n].GetBoundingBox();o.MinVertex.x>e.aViewports[t].terrainBox.MinVertex.x&&(e.aViewports[t].terrainBox.MinVertex.x=o.MinVertex.x),o.MaxVertex.x<e.aViewports[t].terrainBox.MaxVertex.x&&(e.aViewports[t].terrainBox.MaxVertex.x=o.MaxVertex.x),o.MinVertex.y>e.aViewports[t].terrainBox.MinVertex.y&&(e.aViewports[t].terrainBox.MinVertex.y=o.MinVertex.y),o.MaxVertex.y<e.aViewports[t].terrainBox.MaxVertex.y&&(e.aViewports[t].terrainBox.MaxVertex.y=o.MaxVertex.y)}}else e.aViewports[t].terrainBox=new window.MapCore.SMcBox(0,0,0,0,0,0);e.aViewports[t].terrainCenter=window.MapCore.SMcVector3D((e.aViewports[t].terrainBox.MinVertex.x+e.aViewports[t].terrainBox.MaxVertex.x)/2,(e.aViewports[t].terrainBox.MinVertex.y+e.aViewports[t].terrainBox.MaxVertex.y)/2,0),e.aViewports[t].terrainCenter.z=1e4}if(!e.aViewports[t].bCameraPositionSet)if(e.aViewports[t].viewport.GetMapType()==window.MapCore.IMcMapCamera.EMapType.EMT_2D)e.aViewports[t].viewport.SetCameraPosition(e.aViewports[t].terrainCenter),e.aViewports[t].bCameraPositionSet=!0;else{e.aViewports[t].terrainCenter.z=100,e.aViewports[t].viewport.SetCameraPosition(e.aViewports[t].terrainCenter);var r=new window.MapCore.IMcSpatialQueries.SQueryParams;r.eTerrainPrecision=window.MapCore.IMcSpatialQueries.EQueryPrecision.EQP_HIGH,e.aViewports[t].bCameraPositionSet=!0,r.pAsyncQueryCallback=new e.CAsyncQueryCallback(e.aViewports[t]),e.aViewports[t].viewport.GetTerrainHeight(e.aViewports[t].terrainCenter,{},null,r)}}},e.resizeCanvases=function(){if(0!=e.aViewports.length){var t;e.state.bSameCanvas?(t=1,1):(t=Math.ceil(Math.sqrt(e.aViewports.length)),Math.ceil(e.aViewports.length/t));for(var a=document.getElementById("canvasesContainer").getBoundingClientRect().width,n=document.getElementById("canvasesContainer").getBoundingClientRect().height,o=0;o<e.aViewports.length;o++)e.aViewports[o].canvas.width=a,e.aViewports[o].canvas.height=n,e.aViewports[o].viewport.ViewportResized()}},e.doDtmVisualization=function(){if(e.viewport.GetDtmVisualization())e.viewport.SetDtmVisualization(!1);else{var t=e.calcMinMaxHeights(),a=new window.MapCore.IMcMapViewport.SDtmVisualizationParams;window.MapCore.IMcMapViewport.SDtmVisualizationParams.SetDefaultHeightColors(a,t.minHeight,t.maxHeight),a.bDtmVisualizationAboveRaster=!0,a.uHeightColorsTransparency=120,a.uShadingTransparency=255,e.viewport.SetDtmVisualization(!0,a)}},e.mouseWheelHandler=function(t){var a={},n=-t.deltaY;if(e.editMode.OnMouseEvent(window.MapCore.IMcEditMode.EMouseEvent.EME_MOUSE_WHEEL,window.MapCore.SMcPoint(0,0),t.ctrlKey,n,a,{}),!a.Value){var o=t.shiftKey?10:1;if(e.viewport.GetMapType()==window.MapCore.IMcMapCamera.EMapType.EMT_3D)e.viewport.MoveCameraRelativeToOrientation(window.MapCore.SMcVector3D(0,0,n/8*o),!0);else{var r=e.viewport.GetCameraScale();n>0?e.viewport.SetCameraScale(r/1.25):e.viewport.SetCameraScale(1.25*r),e.viewport.GetDtmVisualization()&&(e.doDtmVisualization(),e.doDtmVisualization())}t.preventDefault(),t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()}},e.mouseMoveHandler=function(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.viewport.GetWindowHandle()==t.target){var n=null;if(a){var o=t.target.getBoundingClientRect(),r=t.targetTouches[0].pageX-o.left,i=t.targetTouches[0].pageY-o.top;n=window.MapCore.SMcPoint(r,i)}else n=window.MapCore.SMcPoint(t.offsetX,t.offsetY);if(t.buttons<=1){var s={},c={};if(e.editMode.OnMouseEvent(1==t.buttons||a?window.MapCore.IMcEditMode.EMouseEvent.EME_MOUSE_MOVED_BUTTON_DOWN:window.MapCore.IMcEditMode.EMouseEvent.EME_MOUSE_MOVED_BUTTON_UP,n,t.ctrlKey,0,s,c),s.Value)return t.preventDefault(),t.cancelBubble=!0,void(t.stopPropagation&&t.stopPropagation())}if((1==t.buttons||a)&&0!=e.nMousePrevX){var p=t.shiftKey?10:1;e.viewport.GetMapType()==window.MapCore.IMcMapCamera.EMapType.EMT_3D?t.ctrlKey?e.viewport.MoveCameraRelativeToOrientation(window.MapCore.SMcVector3D((e.nMousePrevX-n.x)/2*p,-(e.nMousePrevY-n.y)/2*p,0),!1):e.viewport.RotateCameraRelativeToOrientation((e.nMousePrevX-n.x)/2,-(e.nMousePrevY-n.y)/2,0):t.ctrlKey?e.viewport.SetCameraOrientation((e.nMousePrevX-n.x)/2,window.MapCore.FLT_MAX,window.MapCore.FLT_MAX,!0):e.viewport.ScrollCamera((e.nMousePrevX-n.x)*p,(e.nMousePrevY-n.y)*p),t.preventDefault(),t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()}e.nMousePrevX=n.x,e.nMousePrevY=n.y}},e.mouseDownHandler=function(t){if(e.editMode.IsEditingActive()){if(e.viewport.GetWindowHandle()!=t.target)return}else if(!e.state.bSameCanvas)for(var a=0;a<e.aViewports.length;a++)if(t.target==e.aViewports[a].viewport.GetWindowHandle()){e.activeViewport=a,e.updateActiveViewport();break}var n=window.MapCore.SMcPoint(t.offsetX,t.offsetY);if(e.mouseDownButtons=t.buttons,1==t.buttons){var o={};if(e.editMode.OnMouseEvent(window.MapCore.IMcEditMode.EMouseEvent.EME_BUTTON_PRESSED,n,t.ctrlKey,0,o,{}),o.Value)return t.preventDefault(),t.cancelBubble=!0,void(t.stopPropagation&&t.stopPropagation());e.nMousePrevX=n.x,e.nMousePrevY=n.y}t.preventDefault(),t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()},e.mouseUpHandler=function(t){if(e.props.closeContextMenu(),e.viewport.GetWindowHandle()==t.target){var a=window.MapCore.SMcPoint(t.offsetX,t.offsetY);if(1==(e.mouseDownButtons&~t.buttons)){var n={};if(e.editMode.OnMouseEvent(window.MapCore.IMcEditMode.EMouseEvent.EME_BUTTON_RELEASED,a,t.ctrlKey,0,n,{}),n.Value)return t.preventDefault(),t.cancelBubble=!0,void(t.stopPropagation&&t.stopPropagation())}}},e.mouseDblClickHandler=function(t){if(e.viewport.GetWindowHandle()==t.target){var a=window.MapCore.SMcPoint(t.offsetX,t.offsetY),n=e.mouseDownButtons&~t.buttons;if(e.bEdit){for(var o=e.viewport.ScanInGeometry(new window.MapCore.SMcScanPointGeometry(window.MapCore.EMcPointCoordSystem.EPCS_SCREEN,window.MapCore.SMcVector3D(a.x,a.y,0),20),!1),r=0;r<o.length;++r)if(o[r].eTargetType==window.MapCore.IMcSpatialQueries.EIntersectionTargetType.EITT_OVERLAY_MANAGER_OBJECT){e.bEdit&&e.editMode.StartEditObject(o[r].ObjectItemData.pObject,o[r].ObjectItemData.pItem);break}return e.bEdit=!1,t.preventDefault(),t.cancelBubble=!0,void(t.stopPropagation&&t.stopPropagation())}if(1==n){var i={};if(e.editMode.OnMouseEvent(window.MapCore.IMcEditMode.EMouseEvent.EME_BUTTON_DOUBLE_CLICK,a,t.ctrlKey,0,i,{}),i.Value)return t.preventDefault(),t.cancelBubble=!0,void(t.stopPropagation&&t.stopPropagation())}}},e.stopEvent=function(e){e.preventDefault(),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()},e.touchStartHandler=function(t){var a=t.target.getBoundingClientRect();e.nMousePrevX=e._onMouseDownX=t.targetTouches[0].pageX-a.left,e.nMousePrevY=e._onMouseDownY=t.targetTouches[0].pageY-a.top},e.screenToWorld=function(t,a,n){var o=new window.MapCore.SMcVector3D(t,a,0),r={};e.viewport.ScreenToWorldOnTerrain(o,r)||e.viewport.ScreenToWorldOnPlane(o,r);var i=r;return!n||n.withoutConvert,i},e.worldToScreen=function(t,a){var n=t;!a||a.native;var o=e.viewport.WorldToScreen(n),r=!0;return(o.x<0||o.x>e._canvas.width||o.y<0||o.y>e._canvas.height)&&(r=!1),{x:o.x,y:o.y,inScreen:r}},e.moveCameraRelativeToOrientation=function(t,a){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=1;if(o){var i=e.viewport.GetCameraPosition(),s={},c=Math.abs(i.z);e.viewport.GetTerrainHeight(i,s)&&(c=i.z-s.Value),"mouse"===o?(r=600,c<10?r=1:c<30?r=3:c<100?r=6:c<200?r=12:c<300?r=20:c<500?r=35:c<1e3?r=100:c<2e3?r=200:c<5e3&&(r=400)):"touch"===o?(r=600,c<10?r=2:c<30?r=6:c<100?r=9:c<200?r=12:c<300?r=20:c<500?r=35:c<1e3?r=100:c<2e3?r=200:c<5e3&&(r=400),r*=2):(r=150,c<10?r=1:c<30?r=4:c<100?r=8:c<200?r=12:c<300?r=30:c<500?r=50:c<1e3&&(r=100))}e.viewport.MoveCameraRelativeToOrientation(window.MapCore.SMcVector3D(t*r,a*r,0),n)},e.getCameraOrientation=function(){var t={azimuth:0,pitch:0},a={},n={};return e.viewport.GetCameraOrientation(a,n,null),a&&(t.azimuth=a.Value),n&&(t.pitch=n.Value),t},e.setCameraOrientation=function(t,a){var n={},o={},r={};e.viewport.GetCameraOrientation(n,o,r);var i=void 0!==t?t:n.Value,s=void 0!==a?a:o.Value;e.viewport.SetCameraOrientation(i,s,0)},e.isGeoCoordValid=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=1e5,n=!0,o=t?a:1;return(e.x<-180*o||e.y<-89.5*o||0===e.y||e.x>180*o||e.y>89.5*o||e.z>Number.MAX_VALUE)&&(n=!1),n},e.rotateCameraAroundWorldPoint=function(t,a,n,o){var r,i={},s={},c={};if(o&&(e.viewport.GetCameraOrientation(i,s,c),r=e.viewport.GetCameraPosition()),e.viewport.RotateCameraAroundWorldPoint(t,a,n),o){var p={};e.viewport.GetCameraOrientation({},{},p),180===Math.abs(p.Value)&&(e.viewport.SetCameraOrientation(i.Value,s.Value,c.Value,!1),e.viewport.SetCameraPosition(r))}},e.rotateCameraRelativeToOrientation=function(t,a,n){e.viewport.RotateCameraRelativeToOrientation(t*n,a*n,0);e.viewport.GetCameraOrientation({},null,null)},e.getCameraScale=function(){var t,a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e.state.is3DClicked?t=e.viewport.GetCameraPosition().z:(t=e.viewport.GetCameraScale(),a&&(t=(10*(t/=e.viewport.GetPixelPhysicalHeight())).toFixed(2),t=parseInt(t))),t},e.setCameraScale=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(e.state.is3DClicked){var n=e.viewport.GetCameraPosition(),o=1;t>n.z&&(o=-1);var r=a*n.z/100;e.viewport.MoveCameraRelativeToOrientation(window.MapCore.SMcVector3D(0,o*r,0),!1)}else{var i=e.mapScaleTopLimit||2e5;e.cameraScaleChanged=!0;var s=e.viewport.GetPixelPhysicalHeight(),c=t/s;c<25?t=25*s:c>i&&(t=s*i),e.viewport.SetCameraScale(t)}},e.updatePositionText=function(t,a,n){var o,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];try{var i={},s=Math.abs(t)>1e5?t:1e5*t,c=Math.abs(a)>1e5?a:1e5*a,p=new window.MapCore.SMcVector3D(s,c,0);e.viewport.GetTerrainHeight(p,i)&&(o=i.Value)}catch(l){}r&&(e.lastUpdatedHeight=o,console.log("mapheightchanged",o))},e.zoomIn=function(t,a){var n=e.getCameraScale();e.setCameraScale(n/(t||1.5)),e.lastClickPos&&e.updatePositionText(e.lastClickPos.x,e.lastClickPos.y,e.lastClickPos.z)},e.zoomOut=function(t,a){var n=e.getCameraScale();e.setCameraScale(n*(t||1.5)),e.lastClickPos&&e.updatePositionText(e.lastClickPos.x,e.lastClickPos.y,e.lastClickPos.z)},e.handleZoomOrRotate=function(t){var a=t.touches[0].screenX-t.touches[1].screenX,n=t.touches[0].screenY-t.touches[1].screenY,o=Math.abs(a*a+n*n);if(e.lastTouchDistance){var r,i,s=o-e.lastTouchDistance>0,c=Math.abs(o-e.lastTouchDistance),p=t.target.getBoundingClientRect(),l=t.targetTouches[0].pageX-p.left,_=t.targetTouches[0].pageY-p.top,u=t.targetTouches[1].pageX-p.left,d=t.targetTouches[1].pageY-p.top,h=(l+u)/2,m=(_+d)/2,C=e.screenToWorld(h,m,{withoutConvert:!0});if(e.pinchStatus?(r=e.pinchStatus.averageX,i=e.pinchStatus.averageY,e.pinchStatus.averageX=h,e.pinchStatus.averageY=m):e.pinchStatus={averageX:h,averageY:m,averageWorldPosition:C},e.state.is3DClicked){if(!e.pinchStatus.coordToRotateAround3D)if(c>1e3){var O=c/5e3;s?e.moveCameraRelativeToOrientation(0,O,!1,!0):e.moveCameraRelativeToOrientation(0,-O,!1,!0),e.lastTouchDistance=o,r=void 0,i=void 0,e.pinchStatus.zooming3D=!0}else e.pinchStatus.zooming3D=!1}else c>1e4&&(s?e.zoomIn(1.05):e.zoomOut(1.05),e.lastTouchDistance=o);if(e.state.is3DClicked){if(r||i){var M=180*Math.atan2(_-d,l-u)/Math.PI,v=0;if(void 0===e.lastTouchRotation)e.lastTouchRotation=M;else{if(v=Math.abs(M-e.lastTouchRotation),!e.pinchStatus.zooming3D&&(v>2.5||e.pinchStatus.coordToRotateAround3D)){e.pinchStatus.coordToRotateAround3D=e.pinchStatus.coordToRotateAround3D||C.Value;var b=e.pinchStatus.coordToRotateAround3D;if(e.isGeoCoordValid(b)){var E=Math.sign(e.lastTouchRotation-M);e.rotateCameraAroundWorldPoint(b,2*E,0,!0)}}else{e.cameraMoved=!0;var f=r-e.pinchStatus.averageX,w=e.pinchStatus.averageY-i;e.rotateCameraRelativeToOrientation(f,w,.1)}e.lastTouchRotation=M}}}else{var g=180*Math.atan2(_-d,l-u)/Math.PI;if(void 0===e.lastTouchRotation)e.lastTouchRotation=g;else if(Math.abs(g-e.lastTouchRotation)>.5){var S=e.getCameraOrientation().azimuth;e.setCameraOrientation(S+e.lastTouchRotation-g),e.lastTouchRotation=g}if(e.pinchStatus){var y=e.worldToScreen(e.pinchStatus.averageWorldPosition.Value,{native:!0}),T=y.x-e.pinchStatus.averageX,D=y.y-e.pinchStatus.averageY;try{e.viewport.ScrollCamera(T,D)}catch(I){}}}}else e.lastTouchDistance=o},e.touchMoveHandler=function(t){1===t.touches.length?e.mouseMoveHandler(t,!0):e.handleZoomOrRotate(t),t.preventDefault()},e.touchEndHandler=function(t){e.isTouch=!1,e.pinchStatus=void 0,t.touches&&t.touches.length&&(e.disableMoveAfterMultiTouches=!0,setTimeout((function(){e.disableMoveAfterMultiTouches=!1}),200)),t.touches.length||(e.isMouseDown=!1,e.lastTouchDistance=0,e.lastTouchRotation=void 0,e.dbclickHandled=!0),t.preventDefault(),t.target.focus()},e.touchCancelHandler=function(e){},e.onSelectOtherMapClicked=function(){e.setState({isSwitchMapFormOpen:!0})},e.showHideDtmActionClicked=function(){e.setState({isDTMClicked:!e.state.isDTMClicked},e.doDtmVisualization)},e.showHide3DActionClicked=function(){e.setState({is3DClicked:!e.state.is3DClicked},(function(){return e.openMap(e.props.mapToShow.groupName,e.state.is3DClicked)}))},e.onMoreActionsClick=function(t){t.preventDefault(),t.stopPropagation();var a={name:"Select Other Map",func:e.onSelectOtherMapClicked,iconCss:"Map"},n=[],o=(e.props.mapToShow.layers.find((function(e){return e.type.toLowerCase().includes("dtm")})),{name:(e.state.isDTMClicked?"Hide":"Show")+" DTM visualization",func:e.showHideDtmActionClicked,iconCss:"DTM"}),r={name:"Switch To "+(e.state.is3DClicked?"2D":"3D"),func:e.showHide3DActionClicked,iconCss:"ThreeD"};n.push(o),n.push(r),n.push(a),e.props.showContextMenu(t.nativeEvent.x,t.nativeEvent.y,n)},e}return Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__.a)(MapContainer,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.resizeCanvases)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resizeCanvases),cancelAnimationFrame(this.requestAnimationFrameId),this.requestAnimationFrameId=null}},{key:"componentDidUpdate",value:function(e){(!e.isMapCoreSDKLoaded&&this.props.isMapCoreSDKLoaded||this.props.isMapCoreSDKLoaded&&e.mapToShow!==this.props.mapToShow)&&(this.openMap(this.props.mapToShow.groupName,!1),console.log("mapCore version: ",window.MapCore.IMcMapDevice.GetVersion()))}},{key:"parseLayersConfiguration",value:function(e){try{var t,a=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_3__.a)(e);try{for(a.s();!(t=a.n()).done;){var n=t.value,o="MapCore."+n.coordSystemType+".Create("+n.coordSystemParams+")",r=new SLayerGroup(o,n.showGeoInMetricProportion,n.centerByStaticObjectsLayerOnly,n.InitialScale2D);if(n.layers){var i,s=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_3__.a)(n.layers);try{for(s.s();!(i=s.n()).done;){var c=i.value,p=null,l=window.location.protocol;switch(c.type){case"WMSRaster":p="Create"+c.type+"Layer('"+c.path+"'"+(c.params?", "+c.params:"")+")";break;case"IMcNativeRasterMapLayer":p="MapCore.IMcNativeRasterMapLayer.Create('"+l+c.path+"', "+(c.params?c.params:"MapCore.UINT_MAX, false, 0, false")+", this.layerCallback)";break;case"IMcNativeDtmMapLayer":p="MapCore.IMcNativeDtmMapLayer.Create('"+l+c.path+"', "+(c.params?c.params:"0")+", this.layerCallback)";break;case"IMcNativeVectorMapLayer":p="MapCore.IMcNativeVectorMapLayer.Create('"+l+c.path+"', "+(c.params?c.params:"")+"this.layerCallback)";break;case"IMcNative3DModelMapLayer":p="MapCore.IMcNative3DModelMapLayer.Create('"+l+c.path+"', "+(c.params?c.params:"0")+", this.layerCallback)";break;case"IMcNativeVector3DExtrusionMapLayer":p="MapCore.IMcNativeVector3DExtrusionMapLayer.Create('"+l+c.path+"', "+(c.params?c.params:"0, 10")+", this.layerCallback)";break;default:return void alert("Invalid type of server layer")}r.aLayerCreateStrings.push(p)}}catch(_){s.e(_)}finally{s.f()}}void 0!=n.groupName?this.setState({mapLayerGroups:new Map(this.state.mapLayerGroups.set(n.groupName,r))}):n.wmtsServerURL}}catch(_){a.e(_)}finally{a.f()}}catch(u){alert("Invalid configuration JSON file")}}},{key:"parseCapabilitiesXML",value:function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3?arguments[3]:void 0,o=function(){function e(t){Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_7__.a)(this,e),this.node=t}return Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_4__.a)(e,[{key:"GetFirstChild",value:function(t){var a,n=this.node.getElementsByTagName(t),o=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_3__.a)(n);try{for(o.s();!(a=o.n()).done;){var r=a.value;if(r.parentNode==this.node)return new e(r)}}catch(i){o.e(i)}finally{o.f()}return null}},{key:"GetFirstChildText",value:function(e){var t,a=this.node.getElementsByTagName(e),n=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_3__.a)(a);try{for(n.s();!(t=n.n()).done;){var o=t.value;if(o.parentNode==this.node)return o.textContent}}catch(r){n.e(r)}finally{n.f()}return null}},{key:"GetFirstChildAttribute",value:function(e,t){var a,n=this.node.getElementsByTagName(e),o=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_3__.a)(n);try{for(o.s();!(a=o.n()).done;){var r=a.value;if(r.parentNode==this.node)return r.attributes.getNamedItem(t).value}}catch(i){o.e(i)}finally{o.f()}return null}},{key:"GetChildren",value:function(t){var a,n=this.node.getElementsByTagName(t),o=[],r=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_3__.a)(n);try{for(r.s();!(a=r.n()).done;){var i=a.value;i.parentNode==this.node&&o.push(new e(i))}}catch(s){r.e(s)}finally{r.f()}return o}},{key:"GetChildrenTexts",value:function(e){var t,a=this.node.getElementsByTagName(e),n=[],o=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_3__.a)(a);try{for(o.s();!(t=o.n()).done;){var r=t.value;r.parentNode==this.node&&n.push(r.textContent)}}catch(i){o.e(i)}finally{o.f()}return n}}]),e}();if(null!=e)try{var r=new o(e).GetFirstChild("Capabilities"),i=r.GetFirstChildAttribute("ServiceMetadataURL","xlink:href");null!=i&&""!=i||(i=t);var s=i.lastIndexOf("?");if(s<0&&(s=i.lastIndexOf("/")),s<0)return void alert("Invalid Capabilities file");var c,p=i.substring(0,s),l=r.GetFirstChild("Contents"),_=l.GetChildren("TileMatrixSet"),u=new Map,d=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_3__.a)(_);try{for(d.s();!(c=d.n()).done;){var h=c.value,m=h.GetFirstChildText("ows:Identifier"),C=h.GetFirstChildText("ows:SupportedCRS");null!=m&&null!=C&&u.set(h.GetFirstChildText("ows:Identifier"),{coordSystem:C,tileMatrixSet:m})}}catch(F){d.e(F)}finally{d.f()}var O,M=l.GetChildren("Layer"),v=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_3__.a)(M);try{for(v.s();!(O=v.n()).done;){var b=O.value,E=b.GetFirstChildText("ows:Identifier");if(this.context.mapToPreview.type!==_config__WEBPACK_IMPORTED_MODULE_11__.a.nodesLevel.layer||this.context.mapToPreview.data.LayerId===E||this.context.mapToPreview.dtmLayerId===E){var f=b.GetChildrenTexts("Format"),w=b.GetChildren("TileMatrixSetLink");0==w.length&&w.push(null);var g,S=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_3__.a)(w);try{for(S.s();!(g=S.n()).done;){var y=g.value,T=null,D=null;if(null!=y){var I=u.get(y.GetFirstChildText("TileMatrixSet"));if(T=I.coordSystem,D=I.tileMatrixSet,n&&n.tileMatrixSetFilter&&D!=n.tileMatrixSetFilter)continue}if(null==T){var j=b.GetFirstChild("ows:BoundingBox");j&&(T=j.GetFirstChildText("ows:crs"))}var P="urn:ogc:def:crs:";if(0==T.indexOf(P)){T=T.substring(P.length).replace("::",":");var L=[];if(a){L=b.GetFirstChildText("Group").split(",");for(var x=0;x<L.length;++x)L[x]=L[x]+" (server "+T+")"}else{var R=b.GetFirstChildText("ows:Title");null==R&&(R=E);for(var A=0;A<f.length;++A)f[A]=f[A].replace("image/",""),L[A]=R+" (WMTS "+f[A]+" "+D+")"}for(var k=0;k<L.length;++k){var B=L[k],V="MapCore.IMcGridGeneric.Create('"+T+"')",N=this.state.mapLayerGroups.get(B);if(void 0==N)N=new SLayerGroup(V,!0),this.setState({mapLayerGroups:new Map(this.state.mapLayerGroups.set(B,N))});else if(V!=N.coordSystemString)return void alert("Layers' coordinate systems do not match");var W=void 0;a?(W=f[0].replace("MapCore","MapCore.IMcNative").replace("DTM","Dtm")+"MapLayer.Create('"+p+"/"+E+"')",N.aLayerCreateStrings.push(W)):(W="CreateWMTSRasterLayer('"+t+"', '"+E+"', '"+D+"', '"+f[k]+"')",N.aLayerCreateStrings.push(W),n&&(N.aLayerCreateStrings=N.aLayerCreateStrings.concat(n.aLayerCreateStrings),N.bSetTerrainBoxByStaticLayerOnly=n.bSetTerrainBoxByStaticLayerOnly,N.bShowGeoInMetricProportion=n.bShowGeoInMetricProportion,N.InitialScale2D=n.InitialScale2D))}}}}catch(F){S.e(F)}finally{S.f()}}}}catch(F){v.e(F)}finally{v.f()}}catch(U){alert("Invalid Capabilities file")}}},{key:"createCallbackClasses",value:function(){this.CLayerReadCallback=window.MapCore.IMcMapLayer.IReadCallback.extend("IMcMapLayer.IReadCallback",{OnInitialized:function(e,t,a){t==window.MapCore.IMcErrors.ECode.SUCCESS||t!=window.MapCore.IMcErrors.ECode.NATIVE_SERVER_LAYER_NOT_VALID&&alert("Layer initialization: "+window.MapCore.IMcErrors.ErrorCodeToString(t)+" ("+a+")")},OnReadError:function(e,t,a){alert("Layer read error: "+window.MapCore.IMcErrors.ErrorCodeToString(t)+" ("+a+")")},OnNativeServerLayerNotValid:function(e,t){},OnRemoved:function(e,t,a){alert("Map layer has been removed")},OnReplaced:function(e,t,a,n){alert("Map layer has been replaced")},Release:function(){this.delete()}}),this.CCameraUpdateCallback=window.MapCore.IMcMapViewport.ICameraUpdateCallback.extend("IMcMapViewport.ICameraUpdateCallback",{OnActiveCameraUpdated:function(e){++this.uCameraUpdateCounter},Release:function(){this.delete()}}),this.CAsyncQueryCallback=window.MapCore.IMcSpatialQueries.IAsyncQueryCallback.extend("IMcSpatialQueries.IAsyncQueryCallback",{__construct:function(e){this.__parent.__construct.call(this),this.viewportData=e},OnTerrainHeightResults:function(e,t,a){null!=this.viewportData.viewport&&(this.viewportData.terrainCenter.z=t+20,this.viewportData.viewport.GetMapType()==window.MapCore.IMcMapCamera.EMapType.EMT_3D&&this.viewportData.viewport.SetCameraPosition(this.viewportData.terrainCenter)),this.delete()},OnTerrainHeightMatrixResults:function(e,t,a){},OnTerrainHeightsAlongLineResults:function(e,t,a){},OnExtremeHeightPointsInPolygonResults:function(e,t,a){},OnTerrainAnglesResults:function(e,t){},OnLineOfSightResults:function(e,t,a){},OnPointVisibilityResults:function(e,t,a){},OnAreaOfSightResults:function(e,t,a,n,o){},OnLocationFromTwoDistancesAndAzimuthResults:function(e){},OnError:function(e){alert("error "+e),this.delete()}});var e=window.MapCore.IMcUserData.extend("IMcUserData",{__construct:function(e){this.__parent.__construct.call(this),this.bToBeDeleted=e},__destruct:function(){this.__parent.__destruct.call(this)},Release:function(){this.bToBeDeleted&&this.delete()},Clone:function(){return this.bToBeDeleted?new e(this.bToBeDeleted):this}});this.layerCallback=new this.CLayerReadCallback}},{key:"doMoveObjects",value:function(){}},{key:"calcMinMaxHeights",value:function(){var e=0,t=700,a=this.viewport.GetCameraFootprint();if(a.bUpperLeftFound&&a.bUpperRightFound&&a.bLowerRightFound&&a.bLowerLeftFound){var n={},o={};this.viewport.GetExtremeHeightPointsInPolygon([a.UpperLeft,a.UpperRight,a.LowerRight,a.LowerLeft],o,n)&&(e=n.Value.z,t=o.Value.z)}return{minHeight:e,maxHeight:t}}},{key:"createViewport",value:function(e,t){var a;this.state.bSameCanvas&&0!=this.aViewports.length?a=this.aViewports[0].canvas:((a=document.createElement("canvas")).addEventListener("wheel",this.mouseWheelHandler,!1),a.addEventListener("mousemove",this.mouseMoveHandler,!1),a.addEventListener("mousedown",this.mouseDownHandler,!1),a.addEventListener("mouseup",this.mouseUpHandler,!1),a.addEventListener("dblclick",this.mouseDblClickHandler,!1),a.addEventListener("touchstart",this.touchStartHandler,!1),a.addEventListener("touchend",this.touchEndHandler,!1),a.addEventListener("touchmove",this.touchMoveHandler,!1),a.addEventListener("touchcancel",this.touchCancelHandler,!1));var n=this.state.mapLayerGroups.get(this.state.lastTerrainConfiguration),o=new window.MapCore.IMcMapViewport.SCreateData(t);o.pDevice=this.device,o.pCoordinateSystem=null!=e?e.GetCoordinateSystem():this.overlayManager.GetCoordinateSystemDefinition(),o.pOverlayManager=this.overlayManager,o.hWnd=a,n.bShowGeoInMetricProportion&&(o.bShowGeoInMetricProportion=!0),this.viewport=window.MapCore.IMcMapViewport.Create(null,o,null!=e?[e]:null),this.editMode=window.MapCore.IMcEditMode.Create(this.viewport);var r=new this.CCameraUpdateCallback;this.viewport.AddCameraUpdateCallback(r),this.viewport.GetMapType()==window.MapCore.IMcMapCamera.EMapType.EMT_3D?(this.viewport.SetScreenSizeTerrainObjectsFactor(1.5),this.viewport.SetCameraRelativeHeightLimits(3,1e4,!0)):(this.viewport.SetStaticObjectsVisibilityMaxScale(50),n.InitialScale2D&&this.viewport.SetCameraScale(n.InitialScale2D)),this.viewport.SetBackgroundColor(window.MapCore.SMcBColor(70,70,70,255)),this.viewport.SetObjectsDelay(window.MapCore.IMcMapViewport.EObjectDelayType.EODT_VIEWPORT_CHANGE_OBJECT_UPDATE,!0,50),this.viewport.SetObjectsDelay(window.MapCore.IMcMapViewport.EObjectDelayType.EODT_VIEWPORT_CHANGE_OBJECT_CONDITION,!0,50),this.viewport.SetObjectsDelay(window.MapCore.IMcMapViewport.EObjectDelayType.EODT_VIEWPORT_CHANGE_OBJECT_SIZE,!0,5),this.viewport.SetObjectsDelay(window.MapCore.IMcMapViewport.EObjectDelayType.EODT_VIEWPORT_CHANGE_OBJECT_HEIGHT,!0,50),this.viewport.SetObjectsMovementThreshold(1),null!=e&&(this.viewport.SetTerrainNumCacheTiles(e,!1,300),this.viewport.SetTerrainNumCacheTiles(e,!0,300));var i=new SViewportData(this.viewport,this.editMode);i.terrain=e,n.bSetTerrainBoxByStaticLayerOnly&&(i.bSetTerrainBoxByStaticLayerOnly=!0),this.aViewports.push(i),document.getElementById("canvasesContainer").appendChild(a),this.activeViewport=this.aViewports.length-1,this.updateActiveViewport(),this.resizeCanvases(),this.trySetTerainBox()}},{key:"updateActiveViewport",value:function(){if(this.activeViewport>=0)for(var e=0;e<this.aViewports.length;++e)e==this.activeViewport&&(this.viewport=this.aViewports[e].viewport,this.editMode=this.aViewports[e].editMode,this.state.bSameCanvas)}},{key:"doPrevViewport",value:function(){this.aViewports.length>1&&(this.activeViewport=(this.activeViewport+this.aViewports.length-1)%this.aViewports.length,this.updateActiveViewport())}},{key:"doNextViewport",value:function(){this.aViewports.length>1&&(this.activeViewport=(this.activeViewport+1)%this.aViewports.length,this.updateActiveViewport())}},{key:"initializeViewports",value:function(){var e=this.mapTerrains.get(this.state.lastTerrainConfiguration);switch(void 0==e&&(this.aLastTerrainLayers.length>0?(e=window.MapCore.IMcMapTerrain.Create(this.lastCoordSys,this.aLastTerrainLayers)).AddRef():e=null,this.mapTerrains.set(this.state.lastTerrainConfiguration,e)),null==this.overlayManager&&(null==this.lastCoordSys&&(this.lastCoordSys=window.MapCore.IMcGridUTM.Create(36,window.MapCore.IMcGridCoordinateSystem.EDatumType.EDT_ED50_ISRAEL),this.lastCoordSys.AddRef()),this.overlayManager=window.MapCore.IMcOverlayManager.Create(this.lastCoordSys),this.overlayManager.AddRef(),this.overlay=window.MapCore.IMcOverlay.Create(this.overlayManager)),this.state.lastViewportConfiguration){case"2D/3D":this.createViewport(e,window.MapCore.IMcMapCamera.EMapType.EMT_2D),this.createViewport(e,window.MapCore.IMcMapCamera.EMapType.EMT_3D),this.DoPrevViewport();break;case"3D/2D":this.state.bSameCanvas?(this.createViewport(e,window.MapCore.IMcMapCamera.EMapType.EMT_2D),this.createViewport(e,window.MapCore.IMcMapCamera.EMapType.EMT_3D)):(this.createViewport(e,window.MapCore.IMcMapCamera.EMapType.EMT_3D),this.createViewport(e,window.MapCore.IMcMapCamera.EMapType.EMT_2D),this.doPrevViewport());break;case"2D":this.createViewport(e,window.MapCore.IMcMapCamera.EMapType.EMT_2D);break;case"3D":this.createViewport(e,window.MapCore.IMcMapCamera.EMapType.EMT_3D)}requestAnimationFrame(this.renderMapContinuously)}},{key:"createMapLayersAndViewports",value:function createMapLayersAndViewports(){if(void 0==this.mapTerrains.get(this.state.lastTerrainConfiguration)){this.aLastTerrainLayers=[];var group=this.state.mapLayerGroups.get(this.state.lastTerrainConfiguration);this.lastCoordSys=eval(group.coordSystemString);for(var i=0;i<group.aLayerCreateStrings.length;++i){var layer=eval(group.aLayerCreateStrings[i]);this.aLastTerrainLayers.push(layer),layer instanceof window.MapCore.IMc3DModelMapLayer&&(layer.SetDisplayingItemsAttachedToTerrain(!0),layer.SetDisplayingDtmVisualization(!0))}this.lastCoordSys.AddRef()}this.initializeViewports()}},{key:"openMap",value:function(){var e=Object(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__.a)(C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark((function e(t,a){var n,o,r,i=this;return C_mapCoreDrones_wasp_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=_ExternalConfigurationHandler__WEBPACK_IMPORTED_MODULE_13__.a.getConfiguration().MAPCORE_LAYER_SERVER_URL)){e.next=14;break}return e.prev=2,e.next=5,axios__WEBPACK_IMPORTED_MODULE_10___default.a.get(n+_config__WEBPACK_IMPORTED_MODULE_11__.a.urls.getCapabilities);case 5:o=e.sent,r=(new DOMParser).parseFromString(o.data,"text/xml"),this.parseCapabilitiesXML(r,_config__WEBPACK_IMPORTED_MODULE_11__.a.urls.getCapabilities),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(2);case 12:e.next=15;break;case 14:this.parseLayersConfiguration([this.props.mapToShow]);case 15:this.state.mapLayerGroups.forEach((function(e,n){n===t&&i.setState({lastTerrainConfiguration:n,lastViewportConfiguration:a?"3D":"2D"},(function(){if(null===i.device){var e=new window.MapCore.IMcMapDevice.SInitParams;e.uNumTerrainTileRenderTargets=100;var t=window.MapCore.IMcMapDevice.Create(e);t.AddRef(),i.device=t,i.createCallbackClasses()}i.createMapLayersAndViewports()}))}));case 16:case"end":return e.stop()}}),e,this,[[2,10]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"doDtmVisualization",value:function(){if(this.viewport.GetDtmVisualization())this.viewport.SetDtmVisualization(!1);else{var e=this.calcMinMaxHeights(),t=new window.MapCore.IMcMapViewport.SDtmVisualizationParams;window.MapCore.IMcMapViewport.SDtmVisualizationParams.SetDefaultHeightColors(t,e.minHeight,e.maxHeight),t.bDtmVisualizationAboveRaster=!0,t.uHeightColorsTransparency=120,t.uShadingTransparency=255,this.viewport.SetDtmVisualization(!0,t)}}},{key:"closeMap",value:function(){if(!(this.activeViewport<0)){if(this.editMode.Destroy(),this.viewport.Release(),!this.bSameCanvas||1==this.aViewports.length){var e=this.aViewports[this.activeViewport].canvas;e.removeEventListener("wheel",this.mouseWheelHandler,!1),e.removeEventListener("mousemove",this.mouseMoveHandler,!1),e.removeEventListener("mousedown",this.mouseDownHandler,!1),e.removeEventListener("mouseup",this.mouseUpHandler,!1),e.removeEventListener("dblclick",this.mouseDblClickHandler,!1),e.removeEventListener("touchstart",this.touchStartHandler,!1),e.removeEventListener("touchend",this.touchEndHandler,!1),e.removeEventListener("touchmove",this.touchMoveHandler,!1),e.removeEventListener("touchcancel",this.touchCancelHandler,!1),document.getElementById("canvasesContainer").removeChild(this.aViewports[this.activeViewport].canvas)}this.aViewports.splice(this.activeViewport,1),0==this.aViewports.length?(this.viewport=null,this.editMode=null,this.activeViewport=-1,this.mapTerrains.forEach((function(e){e.Release()})),this.mapTerrains.clear(),this.overlayManager.Release(),this.overlayManager=null):(this.activeViewport>=this.aViewports.length&&(this.activeViewport=this.aViewports.length-1),this.updateActiveViewport(),this.resizeCanvases()),this.setState({mapLayerGroups:new Map,lastTerrainConfiguration:null,lastViewportConfiguration:null,bSameCanvas:!0}),this.mapTerrains=new Map,this.device=null,this.viewportData=null,this.aLastTerrainLayers=[],this.lastCoordSys=null,this.overlayManager=null,this.activeViewport=-1,this.aViewports=[],this.lastRenderTime=(new Date).getTime(),this.lastMemUsageLogTime=(new Date).getTime(),this.uMemUsageLoggingFrequency=0,this.nMousePrevX=0,this.nMousePrevY=0,this.mouseDownButtons=0,this.bEdit=!1}}},{key:"renderLoadingMessage",value:function(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.LoadingMessage,children:"Map core SDK is Loading..."})}},{key:"renderRow",value:function(e,t){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.DescRow,children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("span",{className:_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.DescLabel,children:[e,":"]}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.DescValue,children:t})]})}},{key:"renderMapToolbox",value:function(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"".concat(_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.MapToolbox),children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.Description,children:this.props.mapToShow.groupName}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.MoreActionsBtn,onClick:this.onMoreActionsClick})]})}},{key:"renderSwitchMapForm",value:function(){var e=this,t=this.state.isSwitchMapFormOpen?_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.Open:"";return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"".concat(_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.SwitchMapForm," ").concat(t),children:t?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_SwitchMapForm_SwitchMapForm__WEBPACK_IMPORTED_MODULE_15__.a,{onCancel:function(){return e.setState({isSwitchMapFormOpen:!1})}}):null})}},{key:"getCanvas",value:function(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.MapWrapper,children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.CanvasContainer,id:"canvasesContainer"}),this.renderMapToolbox(),this.renderSwitchMapForm()]})}},{key:"render",value:function(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:_MapContainer_module_css__WEBPACK_IMPORTED_MODULE_9___default.a.Wrapper,children:this.props.isMapCoreSDKLoaded?this.getCanvas():this.renderLoadingMessage()})}}]),MapContainer}(react__WEBPACK_IMPORTED_MODULE_8__.PureComponent),mapStateToProps=function(e){return{isMapCoreSDKLoaded:e.map.isMapCoreSDKLoaded,mapToShow:e.map.mapToShow}},mapDispachToProps=function(e){return{showContextMenu:function(t,a,n){return e({type:_store_actions_actionTypes__WEBPACK_IMPORTED_MODULE_14__.a.SHOW_CONTEXT_MENU,payload:{x:t,y:a,items:n}})},closeContextMenu:function(){return e({type:_store_actions_actionTypes__WEBPACK_IMPORTED_MODULE_14__.a.CLOSE_CONTEXT_MENU})}}};__webpack_exports__.a=Object(react_redux__WEBPACK_IMPORTED_MODULE_12__.b)(mapStateToProps,mapDispachToProps)(MapContainer)},,,function(e,t,a){"use strict";var n=a(0),o=a(4),r=a(5),i=a(7),s=a(6),c=a(1),p=a.n(c),l=a(22),_=a.n(l),u=a(2),d=a(10),h=a(17),m=a(32),C=a.n(m),O=function(e){Object(i.a)(a,e);var t=Object(s.a)(a);function a(e){return Object(o.a)(this,a),t.call(this,e)}return Object(r.a)(a,[{key:"render",value:function(){return Object(n.jsxs)("div",{className:C.a.Wrapper,children:[this.props.label?Object(n.jsx)("legend",{className:C.a.Label,children:this.props.label}):null,Object(n.jsx)("div",{className:C.a.RadioGroupValuesWrapper,children:this.props.children.map((function(e,t){return p.a.cloneElement(e,{key:t,onClick:function(){return e.props.onClick(t)},isChecked:e.props.isChecked,radioIndex:t})}))})]})}}]),a}(c.Component),M=a(30),v=a(29),b=a.n(v),E=function(e){Object(i.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={isChecked:n.props.isChecked},n.onRadioClick=n.onRadioClick.bind(Object(M.a)(n)),n}return Object(r.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState({isChecked:e.isChecked})}},{key:"onRadioClick",value:function(e){e&&e.preventDefault(),this.setState({isChecked:!this.state.isChecked}),this.props.onClick&&this.props.onClick(this.props.radioIndex)}},{key:"render",value:function(){return Object(n.jsxs)("label",{htmlFor:this.props.id,className:b.a.radio,onClick:this.onRadioClick,children:[Object(n.jsx)("input",{className:b.a.radio__input,type:"radio",id:this.props.id,checked:this.props.isChecked,readOnly:!0}),Object(n.jsx)("div",{className:b.a.radio__radio}),Object(n.jsx)("span",{className:b.a.Label,title:this.props.label,children:this.props.label})]})}}]),a}(c.Component),f=function(e){Object(i.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={isShown:!1,selectedGroup:e.props.currentShownMap},e.onMapSelection=function(){e.state.selectedGroup.groupName!==e.props.currentShownMap.groupName&&e.props.setMapToShow(e.state.selectedGroup),e.props.onCancel()},e}return Object(r.a)(a,[{key:"renderHeader",value:function(){return Object(n.jsx)("div",{className:_.a.Header,children:"Select Map to Show:"})}},{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){return e.setState({isShown:!0})}),300)}},{key:"selectMapRadioButton",value:function(e){this.setState({selectedGroup:e})}},{key:"renderBody",value:function(){var e=this,t=h.a.getConfiguration().streamingLayers;t.map((function(e){return Object(n.jsx)("div",{children:e.groupName})}));return Object(n.jsx)("div",{className:_.a.Body,children:Object(n.jsx)(O,{children:t.map((function(t,a){return Object(n.jsx)(E,{id:t.groupName,isChecked:t.groupName===e.state.selectedGroup.groupName,label:t.groupName,onClick:function(){return e.selectMapRadioButton(t)}},a)}))})})}},{key:"renderFooter",value:function(){return Object(n.jsxs)("div",{className:_.a.Footer,children:[Object(n.jsx)("button",{className:"".concat(_.a.Button," ").concat(_.a.Apply),onClick:this.onMapSelection,children:"Select"}),Object(n.jsx)("button",{className:"".concat(_.a.Button),onClick:this.props.onCancel,children:"Cancel"})]})}},{key:"render",value:function(){var e=this.state.isShown?_.a.Shown:"";return Object(n.jsxs)("div",{className:"".concat(_.a.Wrapper," ").concat(e),children:[this.renderHeader(),this.renderBody(),this.renderFooter()]})}}]),a}(c.Component);t.a=Object(d.b)((function(e){return{currentShownMap:e.map.mapToShow}}),(function(e){return{setMapToShow:function(t){return e({type:u.a.SET_MAP_TO_SHOW,payload:t})}}}))(f)},,,,,,function(e,t,a){},,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.r(t),a.d(t,"store",(function(){return qe}));var n={};a.r(n);var o={};a.r(o);var r={};a.r(r),a.d(r,"showGlobalMessage",(function(){return se}));var i={};a.r(i),a.d(i,"locate",(function(){return ce})),a.d(i,"pointVideoImage",(function(){return pe})),a.d(i,"reset",(function(){return le})),a.d(i,"takeoff",(function(){return _e})),a.d(i,"goToLocation",(function(){return ue}));var s=a(0),c=a(1),p=a.n(c),l=a(28),_=a.n(l),u=(a(59),a(4)),d=a(5),h=a(7),m=a(6),C=a.p+"static/media/newLogo.990b2210.svg",O=a(8),M=a.n(O),v=a(21),b=a.n(v),E=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"renderOverlay",value:function(){return this.props.withOverlay?Object(s.jsx)("div",{className:b.a.Overlay}):null}},{key:"render",value:function(){return Object(s.jsxs)(s.Fragment,{children:[this.renderOverlay(),Object(s.jsxs)("div",{className:b.a.loader,"data-message":this.props.loadingMessage,children:[Object(s.jsx)("div",{className:b.a.bg}),Object(s.jsx)("div",{className:b.a.circle}),Object(s.jsx)("div",{className:b.a.circle}),Object(s.jsx)("div",{className:b.a.circle}),Object(s.jsx)("div",{className:b.a.circle}),Object(s.jsx)("div",{className:b.a.circle})]})]})}}]),a}(c.PureComponent),f=a(36),w=a.n(f),g=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={date:new Date},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;setInterval((function(){return e.setState({date:new Date})}),1e3)}},{key:"getFormatedData",value:function(){var e=this.state.date,t=e.getFullYear(),a=e.toLocaleString("en",{month:"short"}),n=e.getDate();return n=n<10?"0".concat(n):n,"".concat(a,". ").concat(n," ").concat(t,",")}},{key:"render",value:function(){return Object(s.jsx)("span",{className:w.a.DateTime,children:Object(s.jsx)("span",{className:w.a.Hour,children:this.state.date.toLocaleTimeString(navigator.language,{hour12:!1})})})}}]),a}(c.PureComponent),S=a(3),y=a(13),T=a.n(y),D=a.p+"static/media/close.cafa525b.svg",I=a(47),j=a.n(I),P=a(10),L=a(18),x=a.n(L),R=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={isShowInfoTooltip:!1},e.showInfoTooltip=function(t){e.setState({isShowInfoTooltip:!0,clientX:t.target.getBoundingClientRect().left,clientY:t.target.getBoundingClientRect().top})},e.hideTooltip=function(){return e.setState({isShowInfoTooltip:!1,clientX:null,clientY:null})},e}return Object(d.a)(a,[{key:"renderInfo",value:function(){if(this.props.info)return Object(s.jsx)("span",{className:x.a.InfoImage,onMouseEnter:this.showInfoTooltip,onMouseLeave:this.hideTooltip})}},{key:"render",value:function(){var e=this.props.mandatory?" ".concat(x.a.Mandatory):"",t=this.props.error?" ".concat(x.a.ShowError):"",a=this.props.readOnly?" ".concat(x.a.readOnly):"";return Object(s.jsxs)("div",{className:x.a.Row,children:[Object(s.jsxs)("span",{className:"".concat(x.a.Label).concat(e),children:[this.props.label,this.renderInfo()]}),Object(s.jsxs)("div",{className:x.a.InputWrapper,children:[Object(s.jsx)("div",{className:x.a.InnerInputWrapper,children:Object(s.jsx)("input",{ref:this.props.parentRef||null,value:this.props.value,name:this.props.name,className:"".concat(x.a.Input).concat(t).concat(a),maxLength:this.props.maxLength||null,type:this.props.type||"text",onFocus:this.props.onFocus,onChange:this.props.onChange,readOnly:this.props.readOnly})}),Object(s.jsx)("div",{className:"".concat(x.a.ValidationMessage).concat(t),children:this.props.error||""})]})]})}}]),a}(c.Component),A=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).inputRef=p.a.createRef(),e.state={value:""},e.onValueChange=function(t){var a=t.target.value;e.setState({value:a},(function(){return e.props.onValueChange(a)}))},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.inputRef&&this.inputRef.current&&this.inputRef.current.focus()}},{key:"render",value:function(){return Object(s.jsx)("div",{className:j.a.Wrapper,children:Object(s.jsx)(R,{parentRef:this.inputRef,value:this.state.value,onChange:this.onValueChange,label:"Location To Go:"})})}}]),a}(c.Component),k={GoToLocationForm:Object(P.b)((function(e,t){return{}}),(function(e){return{}}))(A)},B=a(2),V=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).EscKey=27,e.EnterKey=13,e.handleKeyDown=function(t){t.keyCode===e.EscKey?e.closePopup():t.keyCode===e.EnterKey&&e.props.popupDetails.primayButton&&e.props.popupDetails.primayButton.callback&&(e.props.popupDetails.primayButton.callback(),e.closePopup())},e.closePopup=function(){e.props.popupDetails&&e.props.popupDetails.onCloseButtonClick&&e.props.popupDetails.onCloseButtonClick(),e.props.hidePopup()},e.onCloseBtnClick=function(t){t.preventDefault(),e.closePopup()},e.onPrimaryBtnClick=function(t){t.preventDefault(),e.props.popupDetails.primayButton&&e.props.popupDetails.primayButton.callback&&e.props.popupDetails.primayButton.callback(),e.closePopup()},e.onSecondaryBtnClick=function(t){t.preventDefault(),e.props.popupDetails.secondaryButton&&e.props.popupDetails.secondaryButton.callback&&e.props.popupDetails.secondaryButton.callback(),e.closePopup()},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"getXBtn",value:function(){return this.props.hideXButton?null:Object(s.jsx)("a",{className:T.a.Close,href:"#",onClick:this.onCloseBtnClick,children:Object(s.jsx)("img",{className:T.a.closeBtn,src:D})})}},{key:"closePopup",value:function(){this.props.popupDetails&&this.props.popupDetails.onCloseButtonClick&&this.props.popupDetails.onCloseButtonClick(),this.props.hidePopup()}},{key:"renderButtons",value:function(){var e=Object(s.jsx)("button",{type:"button",className:"".concat(T.a.Btn," ").concat(T.a.BtnPrimary),onClick:this.onPrimaryBtnClick,children:"Close"}),t=null;return this.props.popupDetails.primayButton&&(e=Object(s.jsx)("button",{type:"button",className:"".concat(T.a.FormButton," ").concat(T.a.Apply),onClick:this.onPrimaryBtnClick,children:this.props.popupDetails.primayButton.title})),this.props.popupDetails.secondaryButton&&(t=Object(s.jsx)("button",{type:"button",className:"".concat(T.a.FormButton),onClick:this.onSecondaryBtnClick,children:this.props.popupDetails.secondaryButton.title})),Object(s.jsxs)(s.Fragment,{children:[t,e]})}},{key:"getFooter",value:function(){return Object(s.jsx)("div",{className:T.a.PopupFooter,children:Object(s.jsx)("div",{children:this.renderButtons()})})}},{key:"getHeader",value:function(){return Object(s.jsx)("div",{className:T.a.PopupHeader,children:Object(s.jsxs)("div",{className:T.a.PopupHeaderWrapper,children:[Object(s.jsx)("h2",{className:T.a.h2,children:this.props.popupDetails.title}),this.getXBtn()]})})}},{key:"renderChild",value:function(){var e=k[this.props.popupDetails.modalChild];return Object(s.jsx)(e,Object(S.a)({},this.props.popupDetails.modalChildProps))}},{key:"getBody",value:function(){var e=this.props.noBodyOverflow?T.a.NoBodyOverFlow:"";return Object(s.jsx)("div",{className:"".concat(T.a.PopupBody," ").concat(e),children:this.props.popupDetails.modalChild?this.renderChild():null})}},{key:"render",value:function(){if(!this.props.popupDetails)return null;var e=this.props.popupDetails.size?T.a[this.props.popupDetails.size]:"";return Object(s.jsx)("div",{className:T.a.Overlay,children:Object(s.jsxs)("div",{className:"".concat(T.a.Popup," ").concat(e),children:[this.getHeader(),this.getBody(),this.getFooter()]})})}}]),a}(c.PureComponent),N=Object(P.b)((function(e){return{}}),(function(e){return{hidePopup:function(){return e({type:B.a.HIDE_POPUP})}}}))(V),W=a(27),F=a.n(W),U=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){return Object(s.jsxs)("div",{className:F.a.Wrapper,children:[Object(s.jsxs)("span",{className:F.a.TelemetryWrapper,children:[Object(s.jsx)("span",{children:"Altitude:"}),Object(s.jsxs)("span",{children:["4.5",Object(s.jsx)("span",{className:F.a.Units,children:"m"})]})]}),Object(s.jsxs)("span",{className:F.a.TelemetryWrapper,children:[Object(s.jsx)("span",{children:"Speed:"}),Object(s.jsxs)("span",{children:["21",Object(s.jsx)("span",{className:F.a.Units,children:"km/h"})]})]})]})}}]),a}(c.Component);a(49);var G=a(50),H=a(25),K=a.n(H),z=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={pointPosition:null},e.onImageLoaded=function(t){var a=document.getElementById("tabs-wrapper"),n=t.target,o=n.naturalWidth/a.getBoundingClientRect().width,r=n.naturalHeight/a.getBoundingClientRect().height,i=e.props.imageSentToDroneData.point,s=i.roundedX,c=i.roundedY;e.setState({pointPosition:{top:c/r,left:s/o}})},e}return Object(d.a)(a,[{key:"getCorrectPosition",value:function(){}},{key:"componentDidUpdate",value:function(e){if(e.imageSentToDroneData!==this.props.imageSentToDroneData){var t=document.createElement("img");t.onload=this.onImageLoaded,t.src=this.props.imageSentToDroneData.image}}},{key:"renderTabs",value:function(){var e=null,t=null,a=this.props.imageSentToDroneData&&this.props.imageSentToDroneData.image,n=this.props.imageSentToDroneData&&this.props.imageSentToDroneData.point;return a&&n&&(e=Object(s.jsx)("img",{className:K.a.OutputImage,src:a}),t=Object(s.jsx)("div",{className:K.a.Point,style:this.state.pointPosition})),Object(s.jsxs)("div",{className:K.a.Tabs,id:"tabs-wrapper",children:[e,t]})}},{key:"renderNoOutputReceived",value:function(){return Object(s.jsxs)("div",{className:K.a.ErrorMessage,children:[Object(s.jsx)("span",{className:K.a.ErrorIcon})," No output has been received yet"]})}},{key:"render",value:function(){return Object(s.jsx)("div",{className:K.a.Wrapper,children:this.props.imageSentToDroneData?this.renderTabs():this.renderNoOutputReceived()})}}]),a}(c.Component),X=Object(P.b)((function(e){return{tabs:e.video.tabs,imageSentToDroneData:e.layout.imageSentToDroneData}}),(function(e){return{}}))(z),q=a(12),Y=a.n(q),Q=a(20),J=a.n(Q),Z=a(9),$=a(52),ee=a(14),te=a.n(ee),ae=a(24);function ne(e){var t=null;if(e.naturalWidth&&e.naturalHeight){var a=document.createElement("canvas");a.width=e.naturalWidth,a.height=e.naturalHeight,a.getContext("2d").drawImage(e,0,0),t=a.toDataURL("image/jpeg")}else alert("error: captured image height or width size is 0");return t}var oe=a(17),re=new(function(){function e(){Object(u.a)(this,e),this.rosWebSocket=null}return Object(d.a)(e,[{key:"register",value:function(){try{var e=oe.a.getConfiguration(),t=e.ROS_BE_PROTOCOL,a=e.BE_IP,n=e.ROS_BE_PORT,o="".concat(t,"://").concat(a,":").concat(n);qe.dispatch({type:B.a.SHOW_GLOBAL_MESSAGE,payload:{text:"Trying to connect ros websocket on: ".concat(o),type:Z.b.info}}),qe.dispatch(de.showGlobalMessage({text:"Trying to connect ros websocket on: ".concat(o),type:Z.b.info})),this.rosWebSocket=new window.ROSLIB.Ros({url:o}),this.rosWebSocket.on("connection",(function(){qe.dispatch(de.showGlobalMessage({text:"Connected successfuly to ros websocket",type:Z.b.success,isRemoved:!0})),qe.dispatch({type:B.a.ROSS_WEBSOCKET_CONNECTION_SUCCESS})})),this.rosWebSocket.on("error",(function(e){qe.dispatch(de.showGlobalMessage({text:"Failed to connect ros websocket on: ".concat(o),type:Z.b.error})),qe.dispatch({type:B.a.ROSS_WEBSOCKET_CONNECTION_FAILED}),console.log(e)})),this.rosWebSocket.on("close",(function(){qe.dispatch(de.showGlobalMessage({text:"Connection to ros websocket on: ".concat(o," closed"),type:Z.b.error})),qe.dispatch({type:B.a.ROSS_WEBSOCKET_CONNECTION_CLOSED})}))}catch(r){console.log(r)}}},{key:"getRosWebsocketObject",value:function(){return null==this.rosWebSocket&&this.register(),this.rosWebSocket}}]),e}());function ie(e){return{pointingFingerEncode:new window.ROSLIB.Service({ros:re.getRosWebsocketObject(),name:"EncodeCompressed",serviceType:"pointingfinger/EncodeCompressed"}),pointingFingerLocate:new window.ROSLIB.Service({ros:re.getRosWebsocketObject(),name:"LocateCompressed",serviceType:"pointingfinger/LocateCompressed"}),pointingFingerReset:new window.ROSLIB.Service({ros:re.getRosWebsocketObject(),name:"Reset",serviceType:"pointingfinger/Reset"}),seekerReset:new window.ROSLIB.Service({ros:re.getRosWebsocketObject(),name:"seeker/Reset",serviceType:"seeker/Reset"}),seekerTakeoff:new window.ROSLIB.Service({ros:re.getRosWebsocketObject(),name:"seeker/Takeoff",serviceType:"seeker/Takeoff"}),flyToTopic:new window.ROSLIB.Topic({ros:re.getRosWebsocketObject(),name:"/seeker/TranslatePosition",messageType:"geometry_msgs/Vector3"})}[e]}var se=function(e){var t=e.text,a=e.type,n=e.isRemoved;return function(e){var o={text:t,type:a};e({type:B.a.SHOW_GLOBAL_MESSAGE,payload:o}),n&&setTimeout((function(){return e({type:B.a.REMOVE_GLOBAL_MESSAGE})}),3e3)}},ce=function(){return function(){var e=Object(ae.a)(te.a.mark((function e(t){var a,n,o,r,i;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t({type:B.a.LOACTE_START}),!(a=document.getElementById("droneImage"))){e.next=14;break}if(n=ne(a),t({type:B.a.IMAGE_SENT_TO_DRONE,payload:{image:n}}),o=n&&n.replace("data:image/jpeg;base64,","")){e.next=9;break}return t({type:B.a.LOACTE_FAILED}),e.abrupt("return");case 9:r=new window.ROSLIB.Message({data:o,format:"jpeg"}),i=new window.ROSLIB.ServiceRequest({image:r}),ie("pointingFingerLocate").callService(i,(function(e){e.isSuccess?t({type:B.a.LOACTE_SUCCESS}):t({type:B.a.LOACTE_FAILED}),console.log(ie("pointingFingerLocate").name,e)})),e.next=15;break;case 14:t({type:B.a.LOACTE_FAILED});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},pe=function(e){return function(){var t=Object(ae.a)(te.a.mark((function t(a){var n,o,r,i,s,c,p,l,_,u,d;return te.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a({type:B.a.POINT_ON_VIDEO_IMAGE_START}),n=document.getElementById("droneImage"),o=(e.pageX-n.getBoundingClientRect().x)/n.width*n.naturalWidth,r=(e.pageY-n.getBoundingClientRect().y)/n.height*n.naturalHeight,console.log(o,r),i=Math.round(o),s=Math.round(r),a(se({text:"selected pixel: (".concat(i,", ").concat(s,")"),type:Z.b.info,isRemoved:!0})),!n){t.next=23;break}if(c=ne(n),a({type:B.a.IMAGE_SENT_TO_DRONE,payload:{image:c,point:{roundedX:i,roundedY:s}}}),p=c&&c.replace("data:image/jpeg;base64,","")){t.next=15;break}return a({type:B.a.POINT_ON_VIDEO_IMAGE_FAILED}),t.abrupt("return");case 15:l=new window.ROSLIB.Message({data:p,format:"jpeg"}),_=new window.ROSLIB.Message({x:i,y:s,z:0}),u=new window.ROSLIB.ServiceRequest({image:l,point:_}),ie("pointingFingerEncode").callService(u,(function(e){console.log(ie("pointingFingerEncode").name,e)})),d=new window.ROSLIB.ServiceRequest({image:l}),ie("pointingFingerLocate").callService(d,(function(e){e.isSuccess&&a({type:B.a.POINT_ON_VIDEO_IMAGE_SUCCESS}),console.log(ie("pointingFingerLocate").name,e)})),t.next=24;break;case 23:a({type:B.a.POINT_ON_VIDEO_IMAGE_FAILED});case 24:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},le=function(){return function(){var e=Object(ae.a)(te.a.mark((function e(t){var a;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:B.a.RESET_START}),a=new window.ROSLIB.ServiceRequest({}),ie("pointingFingerReset").callService(a,(function(e){e.isSuccess?t({type:B.a.RESET_SUCCESS}):t({type:B.a.RESET_FAILED}),console.log(ie("pointingFingerReset").name,e)})),ie("seekerReset").callService(a,(function(e){console.log("Result for service call on "+ie("seekerReset").name+": "+e.isSuccess),console.log(ie("seekerReset").name,e)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},_e=function(){return function(){var e=Object(ae.a)(te.a.mark((function e(t){var a;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:B.a.TAKE_OFF_START}),t({type:B.a.SHOW_GLOBAL_MESSAGE,payload:{text:"Taking off...",type:Z.b.info}}),a=new window.ROSLIB.ServiceRequest({}),ie("seekerTakeoff").callService(a,(function(e){e.isSuccess?t({type:B.a.TAKE_OFF_SUCCESS}):(t({type:B.a.TAKE_OFF_FAILED}),t({type:B.a.SHOW_GLOBAL_MESSAGE,payload:{text:"Taking off failed...",type:Z.b.error}})),console.log(e)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},ue=function(e){return function(){var t=Object(ae.a)(te.a.mark((function t(a){var n,o,r,i,s,c;return te.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:B.a.GO_TO_LOCATION_START}),a(se({text:"Go To Location ".concat(e),type:Z.b.info,isRemoved:!0})),n=e.split(","),o=Object($.a)(n,3),r=o[0],i=o[1],s=o[2],c=new window.ROSLIB.Message({x:parseFloat(r),y:parseFloat(i),z:parseFloat(s)}),ie("flyToTopic").publish(c);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},de=Object(S.a)(Object(S.a)(Object(S.a)(Object(S.a)({},n),o),i),r),he=a.p+"static/media/target.66f71b44.svg",me=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={isImageLoadingError:!1,isImageLoading:!0,isFullScreen:!1,targetPosition:null},e.onVideoError=function(t){console.log("error when trying to load camera video",t),e.setState({isImageLoadingError:!0})},e.setTargetPosition=function(){var t=document.getElementById("droneImage");if(t){var a=t.getBoundingClientRect();a&&e.setState({targetPosition:{top:a.top+a.height/2,left:a.left+a.width/2}})}},e.onVideoLoaded=function(t){e.setState({isImageLoading:!1})},e.onPauseOrPlayClick=function(t){t.stopPropagation(),e.props.isPaused?e.props.resume():e.props.pause()},e.onFullScreenClick=function(){var t=document.querySelector("#videoWrapper");t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),e.setState({isFullScreen:!0})},e.onExitFullScreenClick=function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),e.setState({isFullScreen:!1})},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){}},{key:"getVideoSrc",value:function(){var e=oe.a.getConfiguration(),t=e.BE_PORT,a=e.BE_IP,n="//".concat(a,":").concat(t).concat(Z.a.urls.snapshot),o="//".concat(a,":").concat(t).concat(Z.a.urls.stream);return this.props.isPaused?n:o}},{key:"getPlayOrPauseButton",value:function(){return this.props.isPaused?Y.a.Play:Y.a.Pause}},{key:"getPlayOrPauseTitle",value:function(){return this.props.isPaused?"Play":"Pause"}},{key:"renderVideoHeader",value:function(){return Object(s.jsxs)("div",{className:"".concat(Y.a.VideoHeader),children:[Object(s.jsx)("div",{className:Y.a.Description,children:this.props.isPaused?"Video paused":Object(s.jsxs)("span",{className:Y.a.StreamingIconWrapper,children:["Video Feed",Object(s.jsx)("span",{className:Y.a.StreamingIcon})]})}),Object(s.jsx)("span",{className:Y.a.MoreActionsBtn,onClick:this.onMoreActionsClick})]})}},{key:"renderVideoFooter",value:function(){return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("button",{onClick:this.onPauseOrPlayClick,title:this.getPlayOrPauseTitle(),className:"".concat(Y.a.ControlBtn," ").concat(this.getPlayOrPauseButton())}),Object(s.jsx)("button",{onClick:this.state.isFullScreen?this.onExitFullScreenClick:this.onFullScreenClick,title:this.state.isFullScreen?"Exit Full Screen":"Full Screen",className:"".concat(Y.a.ControlBtn," ").concat(this.state.isFullScreen?Y.a.ExitFullScreen:Y.a.FullScreen)})]})}},{key:"renderImgElement",value:function(){if(this.state.isImageLoadingError)return Object(s.jsxs)("div",{className:Y.a.ErrorMessage,children:[Object(s.jsx)("span",{className:Y.a.ErrorIcon})," Error loading video stream"]});var e=this.state.isFullScreen?" ".concat(Y.a.TargetLarge):"";return Object(s.jsxs)(s.Fragment,{children:[this.renderVideoHeader(),Object(s.jsx)("img",{className:"".concat(Y.a.TargetIcon).concat(e),style:this.state.targetPosition,src:he}),Object(s.jsx)("img",{crossOrigin:"anonymous",onLoad:this.onVideoLoaded,onError:this.onVideoError,className:Y.a.VideoImage,src:this.getVideoSrc(),id:"droneImage",onClick:this.props.pointVideoImage}),this.renderVideoFooter()]})}},{key:"render",value:function(){var e=this.state.isImageLoadingError||this.state.isImageLoading?Y.a.FullHeight:"";return Object(s.jsx)("div",{className:"".concat(Y.a.Wrapper," ").concat(e),id:"videoWrapper",children:this.renderImgElement()})}}]),a}(c.Component),Ce=Object(P.b)((function(e){return{isPaused:e.video.isPaused}}),(function(e){return{pointVideoImage:function(t){return e(de.pointVideoImage(t))},pause:function(){return e({type:B.a.PAUSE_VIDEO})},resume:function(){return e({type:B.a.RESUME_VIDEO})}}}))(me),Oe=a(11),Me=a.n(Oe),ve=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).goToLocation=function(){var t={title:"Go To Location",modalChild:"GoToLocationForm",modalChildProps:{size:"small",onValueChange:function(t){return e.tempLocationValue=t}},onCloseButtonClick:function(){e.tempLocationValue=null},primayButton:{title:"Go",callback:e.onGoToLocationPopupOkBtnClick},secondaryButton:{title:"Cancel",callback:function(){e.tempLocationValue=null}}};e.props.showPopup(t)},e.onGoToLocationPopupOkBtnClick=function(){e.tempLocationValue?e.props.goToLocation(e.tempLocationValue):e.tempLocationValue=null},e}return Object(d.a)(a,[{key:"getPauseIcon",value:function(){return this.props.isPaused?Me.a.PlayIcon:Me.a.PauseIcon}},{key:"render",value:function(){var e=this.props.isRosWebsocketConncted?"":Me.a.Hidden;return Object(s.jsxs)("div",{className:"".concat(Me.a.Wrapper," ").concat(e),children:[Object(s.jsxs)("button",{className:Me.a.Button,onClick:this.props.takeoff,children:[Object(s.jsx)("span",{className:"".concat(Me.a.Icon," ").concat(Me.a.TakeoffIcon)}),Object(s.jsx)("span",{className:Me.a.ButtonLabel,children:"Takeoff"})]}),Object(s.jsxs)("button",{className:Me.a.Button,onClick:this.props.locate,children:[Object(s.jsx)("span",{className:"".concat(Me.a.Icon," ").concat(Me.a.LocateIcon)}),Object(s.jsx)("span",{className:Me.a.ButtonLabel,children:"Locate"})]}),Object(s.jsxs)("button",{className:Me.a.Button,onClick:this.goToLocation,children:[Object(s.jsx)("span",{className:"".concat(Me.a.Icon," ").concat(Me.a.SetLocationIcon)}),Object(s.jsx)("span",{className:Me.a.ButtonLabel,children:"Go To"})]}),Object(s.jsxs)("button",{className:Me.a.Button,onClick:this.props.reset,children:[Object(s.jsx)("span",{className:"".concat(Me.a.Icon," ").concat(Me.a.ResetIcon)}),Object(s.jsx)("span",{className:Me.a.ButtonLabel,children:"Reset"})]})]})}}]),a}(c.Component),be=Object(P.b)((function(e){return{isPaused:e.video.isPaused,isRosWebsocketConncted:e.layout.isRosWebsocketConncted}}),(function(e){return{takeoff:function(){return e(de.takeoff())},locate:function(){return e(de.locate())},restart:function(){return e(de.restart())},showPopup:function(t){return e({type:B.a.SHOW_POPUP,payload:t})},goToLocation:function(t){return e(de.goToLocation(t))}}}))(ve),Ee=a(33),fe=a.n(Ee),we=a.p+"static/media/infoFull.77fd10dd.svg",ge=a.p+"static/media/success.617ddc92.svg",Se=a.p+"static/media/errorIcon.8ac257c2.svg",ye=a.p+"static/media/warnIcon.a363b201.svg",Te=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"renderIcon",value:function(){var e;switch(this.props.appGlobalMessage.type){case Z.b.info:e=we;break;case Z.b.success:e=ge;break;case Z.b.warn:e=ye;break;case Z.b.error:e=Se;break;default:e=we}return Object(s.jsx)("img",{className:fe.a.Icon,src:e})}},{key:"renderText",value:function(e){return Object(s.jsx)("div",{className:fe.a.Text,children:e})}},{key:"renderNotification",value:function(e){return Object(s.jsxs)("div",{className:fe.a.Wrapper,children:[this.renderIcon(),this.renderText(e.text)]})}},{key:"render",value:function(){var e=this.props.appGlobalMessage;return e&&e.text?this.renderNotification(e):null}}]),a}(c.PureComponent),De=Object(P.b)((function(e){return{appGlobalMessage:e.layout.appGlobalMessage}}),(function(e){return{}}))(Te),Ie=a(26),je=a.n(Ie),Pe=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).CONTEXT_MENU_WIDTH=150,e.contextRef=p.a.createRef(),e.state={top:0,left:0,menuItems:[]},e.closeContextMenu=function(t){e.contextRef&&e.contextRef.current&&!e.contextRef.current.contains(t.target)&&e.props.closeContextMenu()},e.onItemClick=function(t){t.func(t.task),e.props.closeContextMenu()},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.closeContextMenu),this.updatePosition(this.props.contextMenu.x,this.props.contextMenu.y,this.props.contextMenu.items)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.closeContextMenu)}},{key:"getNewTop",value:function(e){var t=35*this.props.contextMenu.items.length;return e+t/2>document.body.offsetHeight?e-t:e}},{key:"updatePosition",value:function(e,t,a){this.setState({top:this.getNewTop(t),left:e>document.body.offsetWidth-this.CONTEXT_MENU_WIDTH?e-this.CONTEXT_MENU_WIDTH:e,menuItems:a})}},{key:"render",value:function(){var e=this,t=null!=this.state.menuItems&&this.state.menuItems.length>0?"":je.a.Close,a="";return this.state.menuItems&&this.state.menuItems.length>0&&(a=this.state.menuItems.map((function(t,a){return Object(s.jsxs)("li",{title:t.title,className:je.a.menuItem,onClick:function(){return e.onItemClick(t)},children:[Object(s.jsx)("span",{className:"".concat(je.a.ContextMenuIcon," ").concat(je.a[t.iconCss])}),Object(s.jsx)("div",{children:t.name})]},a)}))),Object(s.jsx)("div",{style:{top:this.state.top,left:this.state.left},className:"".concat(je.a.contextMenu," ").concat(t),ref:this.contextRef,children:Object(s.jsx)("ul",{className:"".concat(je.a.contextMenuUL," ").concat(t),children:a})})}}]),a}(c.Component),Le=Object(P.b)((function(e){return{}}),(function(e){return{closeContextMenu:function(){return e({type:B.a.CLOSE_CONTEXT_MENU})}}}))(Pe),xe=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).disableZoomInTouchScreen=function(e){e.touches.length>1&&e.preventDefault()},e.closeErrorPopup=function(){e.setState({generalErrorMessage:!1})},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){window.MapCore.SetStartCallbackFunction(this.props.setMapCoreSDKLoadedFlag);var e=oe.a.getConfiguration().streamingLayers[0];this.props.setMapToShow(e),window.addEventListener("touchstart",this.disableZoomInTouchScreen,{passive:!1})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("touchstart",this.disableZoomInTouchScreen)}},{key:"getGeneralErrorPopup",value:function(){return null}},{key:"getClock",value:function(){return Object(s.jsx)(g,{})}},{key:"getMainHeader",value:function(){return Object(s.jsxs)("header",{className:M.a.AppHeader,children:[Object(s.jsx)("img",{src:C,alt:"logo"}),Object(s.jsxs)("div",{className:M.a.HeaderLeftWrapper,children:[Object(s.jsxs)("span",{className:M.a.HeaderItem,children:[Object(s.jsx)("span",{className:"".concat(M.a.Icon," ").concat(M.a.PositionIcon)}),Object(s.jsxs)("span",{className:M.a.LongLatWrapper,children:[Object(s.jsxs)("span",{children:[Object(s.jsx)("span",{className:M.a.lonLatLabel,children:"lat:"}),Object(s.jsx)("span",{className:M.a.lonLatValue,children:"32.35249"})]}),Object(s.jsxs)("span",{children:[Object(s.jsx)("span",{className:M.a.lonLatLabel,children:"long:"}),Object(s.jsx)("span",{className:M.a.lonLatValue,children:"34.87586"})]})]})]}),Object(s.jsx)("span",{className:M.a.HeaderItem,children:Object(s.jsx)("span",{className:"".concat(M.a.Icon," ").concat(M.a.WifiIcon)})}),Object(s.jsxs)("span",{className:M.a.HeaderItem,children:[Object(s.jsx)("span",{className:"".concat(M.a.Icon," ").concat(M.a.BatteryIcon)}),Object(s.jsx)("span",{className:M.a.BatteryValue,children:"59%"})]}),Object(s.jsx)("div",{className:M.a.RightHeader,children:this.getClock()})]})]})}},{key:"getMainLeftPane",value:function(){return Object(s.jsx)(G.a,{})}},{key:"getMainRightPane",value:function(){return Object(s.jsxs)("div",{className:M.a.RightPaneWrapper,children:[Object(s.jsx)("div",{className:M.a.RightPaneWrapperItem,children:Object(s.jsx)(Ce,{})}),Object(s.jsx)("div",{className:M.a.RightPaneWrapperItem,children:Object(s.jsx)(X,{})})]})}},{key:"getMainContent",value:function(){return Object(s.jsxs)("div",{className:M.a.MainContentWrapper,children:[Object(s.jsx)("div",{className:"".concat(M.a.Split," ").concat(M.a.Left),children:this.getMainLeftPane()}),Object(s.jsx)("div",{className:"".concat(M.a.Split," ").concat(M.a.Right),children:this.getMainRightPane()})]})}},{key:"getActionButtons",value:function(){return Object(s.jsx)(be,{})}},{key:"render",value:function(){return this.props.isLoading?Object(s.jsx)(E,{loadingMessage:"initializing..."}):Object(s.jsxs)("div",{className:M.a.App,children:[Object(s.jsx)(De,{}),this.props.popupDetails?Object(s.jsx)(N,{popupDetails:this.props.popupDetails}):null,Object(s.jsx)(U,{}),this.props.contextMenu?Object(s.jsx)(Le,{contextMenu:this.props.contextMenu}):null,this.getActionButtons(),this.getGeneralErrorPopup(),this.getMainHeader(),this.getMainContent()]})}}]),a}(c.Component),Re=Object(P.b)((function(e){return{contextMenu:e.layout.contextMenu,popupDetails:e.layout.popupDetails}}),(function(e){return{setMapCoreSDKLoadedFlag:function(){return e({type:B.a.SET_MAPCORE_SDK_LOADED_FLAG})},setMapToShow:function(t){return e({type:B.a.SET_MAP_TO_SHOW,payload:t})}}}))(xe),Ae=(a(85),a(23)),ke=a(51),Be={isMapCoreSDKLoaded:!1,mapToShow:null},Ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Be,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case B.a.SET_MAPCORE_SDK_LOADED_FLAG:return Object(S.a)(Object(S.a)({},e),{},{isMapCoreSDKLoaded:!0});case B.a.SET_MAP_TO_SHOW:return Object(S.a)(Object(S.a)({},e),{},{mapToShow:t.payload});default:return e}},Ne={isPaused:!1},We=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ne,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case B.a.PAUSE_VIDEO:return Object(S.a)(Object(S.a)({},e),{},{isPaused:!0});case B.a.RESUME_VIDEO:return Object(S.a)(Object(S.a)({},e),{},{isPaused:!1});default:return e}},Fe={},Ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case B.a.TOGGLE_SIDE_BAR:return Object(S.a)(Object(S.a)({},e),{},{toasts:e.toasts.filter((function(e){return!e.alwaysOnTop}))});default:return e}},Ge={appGlobalMessage:null,isRosWebsocketConncted:!1,contextMenu:null,popupDetails:null,imageSentToDroneData:null},He=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case B.a.SHOW_GLOBAL_MESSAGE:return Object(S.a)(Object(S.a)({},e),{},{appGlobalMessage:{text:t.payload.text,type:t.payload.type}});case B.a.REMOVE_GLOBAL_MESSAGE:return Object(S.a)(Object(S.a)({},e),{},{appGlobalMessage:null});case B.a.ROSS_WEBSOCKET_CONNECTION_SUCCESS:return Object(S.a)(Object(S.a)({},e),{},{isRosWebsocketConncted:!0});case B.a.ROSS_WEBSOCKET_CONNECTION_FAILED:case B.a.ROSS_WEBSOCKET_CONNECTION_CLOSED:return Object(S.a)(Object(S.a)({},e),{},{isRosWebsocketConncted:!1});case B.a.SHOW_CONTEXT_MENU:var a={x:t.payload.x,y:t.payload.y,items:t.payload.items};return Object(S.a)(Object(S.a)({},e),{},{contextMenu:a});case B.a.CLOSE_CONTEXT_MENU:return Object(S.a)(Object(S.a)({},e),{},{contextMenu:null});case B.a.SHOW_POPUP:return Object(S.a)(Object(S.a)({},e),{},{popupDetails:Object(S.a)({},t.payload)});case B.a.HIDE_POPUP:return Object(S.a)(Object(S.a)({},e),{},{popupDetails:null});case B.a.IMAGE_SENT_TO_DRONE:return Object(S.a)(Object(S.a)({},e),{},{imageSentToDroneData:t.payload});default:return e}},Ke=Object(Ae.c)({map:Ve,output:Ue,video:We,layout:He}),ze=function(e){J.a.interceptors.response.use((function(e){return e}),(function(e){if(J.a.isCancel(e))return Promise.reject(e);var t=e.response&&e.response.data&&e.response.data.errMsg||"Unknown Error";return console.error(t),Promise.reject(e)}))},Xe=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Ae.d,qe=Object(Ae.e)(Ke,Xe(Object(Ae.a)(ke.a)));_.a.render(Object(s.jsx)(p.a.StrictMode,{children:Object(s.jsx)(E,{loadingMessage:"initializing..."})}),document.getElementById("root")),J.a.get(Z.a.urls.configuration).then((function(e){oe.a.setConfiguration(e.data),ze(qe),re.register(qe),_.a.render(Object(s.jsx)(p.a.StrictMode,{children:Object(s.jsx)(P.a,{store:qe,children:Object(s.jsx)(Re,{})})}),document.getElementById("root"))})).catch((function(e){console.error("error when trying to retreive configuration.json",e)}))}],[[86,1,2]]]);
//# sourceMappingURL=main.0b54fa37.chunk.js.map